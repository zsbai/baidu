define("detail:widget/abTest/abTest.conf.js",function(t,i){var E={23498:{id:23498,name:"太阳的后裔",types:[{type:"穿帮",data:[{title:"《太阳的后裔》十大穿帮镜头",link:"http://my.tv.sohu.com/pl/6935925/83301337.shtml?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E3%80%8A%E5%A4%AA%E9%98%B3%E7%9A%84%E5%90%8E%E8%A3%94%E3%80%8B%E5%8D%81%E5%A4%A7%E7%A9%BF%E5%B8%AE%E9%95%9C%E5%A4%B4.jpg",actor:""},{title:"太阳的后裔吐槽 细说太阳的后裔六大穿帮镜头",link:"http://www.iqiyi.com/w_19rsx8pzg5.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E5%A4%AA%E9%98%B3%E7%9A%84%E5%90%8E%E8%A3%94%E5%90%90%E6%A7%BD%E7%BB%86%E8%AF%B4%E5%A4%AA%E9%98%B3%E7%9A%84%E5%90%8E%E8%A3%94%E5%85%AD%E5%A4%A7%E7%A9%BF%E5%B8%AE%E9%95%9C%E5%A4%B4.jpg",actor:""},{title:"《太阳的后裔》官方版男神穿帮MV 何仙姑夫",link:"http://my.tv.sohu.com/pl/7045334/83308097.shtml?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E3%80%8A%E5%A4%AA%E9%98%B3%E7%9A%84%E5%90%8E%E8%A3%94%E5%AE%98%E6%96%B9%E7%89%88%E7%94%B7%E7%A5%9E%E7%A9%BF%E5%B8%AEMV%E4%BD%95%E4%BB%99%E5%A7%91%E5%A4%AB.jpg",actor:""}]},{type:"剧情",data:[{title:"简笔笑画第八季07《太阳的后裔》",link:"http://my.tv.sohu.com/us/211261352/83274289.shtml?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E7%AE%80%E7%AC%94%E7%94%BB.jpg",actor:""},{title:"太阳的后裔中毒太深 无药可救",link:"http://www.iqiyi.com/w_19rsxh2vm5.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E5%B9%BF%E5%BC%8F.jpg",actor:""},{title:"太阳的后裔韩式撩妹岂可修，金刚狼花式撩蛋望推广30",link:"http://my.tv.sohu.com/pl/9104041/83235815.shtml?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E6%9A%B4%E8%B5%B0.jpg",actor:""}]},{type:"盘点总结",data:[{title:"《太阳的后裔》PK《来自星星的你》",link:"http://my.tv.sohu.com/us/202939688/83182927.shtml?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/DS1.jpg",actor:""},{title:"宋仲基《太阳的后裔》金宇彬《任意依恋》朴",link:"http://www.iqiyi.com/w_19rsx60fp9.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E5%AE%8B%E4%BB%B2%E5%9F%BA%E3%80%8A%E5%A4%AA%E9%98%B3%E7%9A%84%E5%90%8E%E8%A3%94%E3%80%8B%E9%87%91%E5%AE%87%E5%BD%AC%E3%80%8A%E4%BB%BB%E6%84%8F%E4%BE%9D%E6%81%8B%E3%80%8B%E6%9C%B4.jpg",actor:""},{title:"《太阳的后裔》大火！李敏镐金秀贤 盘点娱乐",link:"http://www.iqiyi.com/w_19rsy47n55.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E3%80%8A%E5%A4%AA%E9%98%B3%E7%9A%84%E5%90%8E%E8%A3%94%E3%80%8B%E5%A4%A7%E7%81%AB%E6%9D%8E%E6%95%8F%E9%95%90%E9%87%91%E7%A7%80%E8%B4%A4%E7%9B%98%E7%82%B9%E5%A8%B1%E4%B9%90.jpg",actor:""}]},{type:"明星花边",data:[{title:"宋仲基首度谈与宋慧乔绯闻：我还蛮享受的",link:"http://my.tv.sohu.com/us/277748655/83371682.shtml",video_type:"10",image_link:"http://list.video.baidu.com/%E5%AE%8B%E4%BB%B2%E5%9F%BA%E9%A6%96%E5%BA%A6%E8%B0%88%E4%B8%8E%E5%AE%8B%E6%85%A7%E4%B9%94%E7%BB%AF%E9%97%BB.jpg",actor:""},{title:"宋仲基伤后回归《太阳的后裔》拍摄现场 粉丝们不禁为宋仲基的身",link:"http://my.tv.sohu.com/us/277748655/83371682.shtml",video_type:"10",image_link:"http://list.video.baidu.com/4%E5%AE%8B%E4%BB%B2%E5%9F%BA%E4%BC%A4%E5%90%8E%E5%9B%9E%E5%BD%92%E3%80%8A%E5%A4%AA%E9%98%B3%E7%9A%84%E5%90%8E%E8%A3%94%E3%80%8B%E6%8B%8D%E6%91%84%E7%8E%B0%E5%9C%BA%E7%B2%89%E4%B8%9D%E4%BB%AC%E4%B8%8D%E7%A6%81%E4%B8%BA%E5%AE%8B%E4%BB%B2%E5%9F%BA%E7%9A%84%E8%BA%AB.jpg",actor:""},{title:"宋仲基首录制新闻节目电视台员工疯狂了",link:"http://my.tv.sohu.com/us/282505863/83366424.shtml?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E5%AE%8B%E4%BB%B2%E5%9F%BA%E9%A6%96%E5%BD%95%E5%88%B6%E6%96%B0%E9%97%BB%E8%8A%82%E7%9B%AE%E7%94%B5%E8%A7%86%E5%8F%B0%E5%91%98%E5%B7%A5%E7%96%AF%E7%8B%82%E4%BA%86.jpg",actor:""}]},{type:"配音",data:[{title:"太阳的后裔雅安话版",link:"http://my.tv.sohu.com/us/63443895/83230122.shtml?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E5%A4%AA%E9%98%B3%E7%9A%84%E5%90%8E%E8%A3%94%E9%9B%85%E5%AE%89%E8%AF%9D%E7%89%88.jpg",actor:""},{title:"实力告别直男癌:撩妹的正确姿势！",link:"http://my.tv.sohu.com/us/18238496/83307623.shtml?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E5%AE%9E%E5%8A%9B%E5%91%8A%E5%88%AB%E7%9B%B4%E7%94%B7%E7%99%8C%E6%92%A9%E5%A6%B9%E7%9A%84%E6%AD%A3%E7%A1%AE%E5%A7%BF%E5%8A%BF%EF%BC%81.jpg",actor:""},{title:"太阳的后裔-配音版",link:"http://www.iqiyi.com/v_19rrkwny8o.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E5%A4%AA%E9%98%B3%E7%9A%84%E5%90%8E%E8%A3%94-%E9%85%8D%E9%9F%B3%E7%89%88.jpg",actor:""}]},{type:"探班花絮",data:[{title:"《太阳的后裔》幕后花絮",link:"http://baidu.boosj.com/watch/01789341173141420668.html?page=videoMultiNeed?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/muhouhuaxu1.jpg",actor:""},{title:"太阳的后裔》花絮之这个男人好帅好暖视频HOT",link:"http://www.iqiyi.com/w_19rsxyvr49.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/muhohuaxu2.jpg",actor:""},{title:"《太阳的后裔》花絮之 这个男人好帅好暖",link:"http://www.iqiyi.com/w_19rsx633gt.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/muhouhuaxu3.jpg",actor:""}]}]},123002:{id:123002,name:"荒野猎人",types:[{type:"剧情",data:[{title:"荒野猎人》一场小李子的荒野求生真人秀 - 荒野猎人小李子荒野求生真人秀",link:"http://www.iqiyi.com/w_19rsy44ikp.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E8%8D%92%E9%87%8E%E7%8C%8E%E4%BA%BA.jpg",actor:""},{title:"小李子救下正在啪啪的妞！奥狂吐槽：荒野猎人",link:"http://my.tv.sohu.com/pl/9093688/83328004.shtml?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E5%A5%A5%E5%A5%A5%E7%AC%91%E5%93%A5.jpg",actor:""},{title:"【这不是剧透】大湿兄撕逼荒野猎人",link:"http://www.iqiyi.com/w_19rsxkatk9.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E8%BF%99%E4%B8%8D%E6%98%AF%E5%89%A7%E9%80%8F.jpg",actor:""}]},{type:"盘点总结",data:[{title:"《荒野猎人》什么叫真正",link:"http://www.iqiyi.com/w_19rsxx3ut1.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E8%A7%82%E5%BD%B1%E5%9B%A2.jpg",actor:""},{title:"不可错过 《荒野猎人》观影前的必修课",link:"http://www.iqiyi.com/v_19rrktfxmc.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E7%9F%A5%E4%BA%86%E8%AF%BB%E4%B9%A6.jpg",actor:""},{title:"电影Pa 第四话《荒野猎人》",link:"http://www.iqiyi.com/w_19rt01o7ax.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E7%94%B5%E5%BD%B1Pa.jpg",actor:""}]},{type:"明星花边",data:[{title:"《荒野猎人》预测莱昂纳多依然拿不到奥斯卡最佳男演奖",link:"http://my.tv.sohu.com/pl/6417564/83060681.shtml?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/aaa%E9%99%88%E6%99%BA%E9%BE%8D.jpg",actor:""},{title:"小李子来华实力圈粉 罗志祥为演唱会疯狂瘦身",link:"http://www.iqiyi.com/w_19rsx5t6p5.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E5%A8%B1%E4%B9%90%E4%B9%90%E7%BF%BB%E5%A4%A9.jpg",actor:""},{title:"最新休休秀 爆笑奇葩翻译 小李子奥斯卡 获奖感言视频",link:"http://www.iqiyi.com/w_19rt0lkwql.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E7%BD%97%E4%BC%91%E4%BC%91.jpg",actor:""}]},{type:"配音",data:[{title:"2分钟看完小李子的《荒野猎人》",link:"http://www.iqiyi.com/w_19rtc3jl5p.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E8%8A%B1%E6%A4%92%E7%94%B5%E5%BD%B1.jpg",actor:""},{title:"奥斯卡颁奖搞笑配音：小李子夺最佳辛苦帝",link:"http://www.iqiyi.com/w_19rsx4dzax.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E7%89%99%E7%89%99%E5%85%B3%E6%B3%A8.jpg",actor:""},{title:"小李子夺奥斯卡影帝 影迷献唱励志神曲_高清",link:"http://www.iqiyi.com/w_19rt1hip3t.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E5%92%9A%E5%93%A5%E5%94%B1%E8%B0%88.jpg",actor:""}]},{type:"探班花絮",data:[{title:"电影口碑关爱组007：《荒野猎人》",link:"http://my.tv.sohu.com/pl/9112206/83237760.shtml?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E7%94%B5%E5%BD%B1%E5%8F%A3%E7%A2%91%E5%85%B3%E7%88%B1%E7%BB%84.jpg",actor:""},{title:"获奖感言清晰",link:"http://www.iqiyi.com/w_19rszyfpzx.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E8%9B%99%E8%B6%A3%E8%A7%86%E9%A2%91.jpg",actor:""},{title:"奥斯卡影帝小李子代表作《泰坦尼克号》经典片段+获奖感言+影迷狂欢",link:"http://my.tv.sohu.com/pl/7058534/83069728.shtml?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E5%8D%95%E4%B8%9D%E6%98%A0%E7%94%BB.jpg",actor:""}]}]},23586:{id:23586,name:"山海经",types:[{type:"穿帮",data:[{title:"山海经之赤影传说穿帮镜头",link:"http://www.iqiyi.com/v_19rrl00sxg.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E9%BA%A6%E5%85%9C%E6%89%BE%E7%A9%BF%E5%B8%AE.jpg",actor:""},{title:"张翰娜扎《山海经》穿帮定情_高清",link:"http://www.iqiyi.com/w_19rsxbjy3h.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E4%BD%95%E4%BB%99%E5%A7%91%E5%A4%AB.jpg",actor:""},{title:"《山海经之赤影传说》1-4集剧组演员大穿帮",link:"http://www.iqiyi.com/w_19rsxiii5x.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E7%A9%BF%E5%B8%AE%E5%98%9A%E5%90%A7%E5%98%9A.jpg",actor:""}]},{type:"剧情",data:[{title:"山海经之赤影传说富二代秒变穷屌丝",link:"http://www.iqiyi.com/w_19rsy2etlh.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E5%B9%BF%E5%BC%8F%E5%A6%B9%E7%BA%B8%E5%90%90%E6%A7%BD.jpg",actor:""},{title:"吐槽《山海经之赤影传说》娜扎暧昧三角恋",link:"http://my.tv.sohu.com/us/232849649/83346271.shtml?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E8%8D%A3%E4%BB%94%E5%B7%A5%E4%BD%9C.jpg",actor:""},{title:"吐槽《山海经之赤影传说》怪叔叔营救小鱼人,呆萌耍宝凑时长",link:"http://my.tv.sohu.com/us/272476163/83343606.shtml?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E4%B9%8C%E6%89%98%E9%82%A6%E7%AB%99.jpg",actor:""}]},{type:"盘点总结",data:[{title:"【吐槽】三角恋爱初现雏形",link:"http://www.iqiyi.com/w_19rsxcg8c9.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E9%9B%AA%E8%8E%89%E8%A7%86%E9%A2%91%E5%A8%B1%E4%B9%90.jpg",actor:""},{title:"神吐槽《古剑奇谭》笑点，槽点大集合",link:"http://www.iqiyi.com/w_19rshgt1e5.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E6%98%8E%E6%98%9F%E7%A5%9E%E5%90%90%E6%A7%BD.jpg",actor:""},{title:"广式妹纸341期《山海经之赤影传说》富二代秒变穷屌丝",link:"http://my.tv.sohu.com/pl/8989651/83294679.shtml?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E8%A2%81%E8%B6%85%E5%B7%A5%E4%BD%9C%E5%AE%A4.jpg",actor:""}]},{type:"明星花边",data:[{title:"每日一扯：《山海经》张翰总裁上身只爱娜扎",link:"http://my.tv.sohu.com/pl/9113041/83298592.shtml?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/ISS%E5%AE%8C%E7%BE%8E%E5%A5%B3%E7%A5%9E.jpg",actor:""},{title:"芙儿向赤羽表白 赤羽苏茉芙儿陷入三角恋 山海经之赤影传说07超长片花 张翰古力娜扎关智斌蓝盈莹",link:"http://my.tv.sohu.com/us/288143481/83357685.shtml?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E4%B9%9D%E9%9B%B6%E5%A8%B1%E4%B9%90.jpg",actor:""},{title:"《山海经之赤影传说》张翰古力娜扎吻戏吸眼",link:"http://my.tv.sohu.com/us/271114647/83344946.shtml?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E5%B0%8F%E6%9D%A8%E5%B7%A5%E4%BD%9C%E5%AE%A488.jpg",actor:""}]},{type:"探班花絮",data:[{title:"恶搞娜扎《青丘狐》穿越《山海经》相遇暖男到霸道男",link:"http://www.iqiyi.com/w_19rsy1nnpp.html#curid=447945800_43690adf4df26fb248da05e0ca8cc1f5?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E7%88%B1%E5%A5%87%E8%89%BA%E5%A8%B1%E4%B9%90.jpg",actor:""},{title:"《云之凡》横店探班： 张翰探班古力娜扎",link:"http://www.iqiyi.com/w_19rtkyq78h.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E8%9B%99%E8%B6%A3%E8%A7%86%E9%A2%911.jpg",actor:""},{title:"《云之凡》探班 娜扎曝男友张翰夸自己可爱",link:"http://www.iqiyi.com/w_19rtkvrd49.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E3%80%8A%E4%BA%91%E4%B9%8B%E5%87%A1%E3%80%8B%E6%8E%A2%E7%8F%AD.jpg",actor:""}]}]},122611:{id:122611,name:"火锅英雄",types:[{type:"剧情吐槽",data:[{title:"《火锅英雄》草蜢献唱 陈坤被白百何吐槽装嫩：靠吃火锅变年轻",link:"http://www.iqiyi.com/w_19rt0pikdl.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E9%9B%AA%E8%8E%89%E8%A7%86%E9%A2%91%E5%A8%B1.jpg",actor:""},{title:"白百何短裙出镜 《火锅英雄》首映苏菲玛索压阵",link:"http://www.iqiyi.com/v_19rrl11q00.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E8%80%81%E9%A9%AC%E8%A7%82%E5%BD%B1%E6%8C%87%E5%8D%97.jpg",actor:""},{title:"《这不是剧透》50期：坤哥毁容之作，太震撼",link:"http://baidu.56.com/watch/763706990016854965.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E8%BF%99%E4%B8%8D%E6%98%AF%E5%89%A7%E9%80%8F1.jpg",actor:""}]},{type:"明星花边",data:[{title:"白百何短裙出镜 《火锅英雄》首映苏菲玛索压阵",link:"http://www.iqiyi.com/v_19rrl1tdoo.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E6%98%8E%E6%98%9F%E5%91%A8%E8%BE%B9.jpg",actor:""},{title:"陈坤《火锅英雄》辣嗨香港电影节 女影迷飙泪",link:"http://www.iqiyi.com/w_19rsxdvzqx.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E6%B0%B4%E7%85%AE%E5%A8%B1%E4%B9%90%E4%BC%A0%E5%AA%92.jpg",actor:""},{title:"《火锅英雄》拍片伊能静查岗[超清版]",link:"http://www.iqiyi.com/w_19rtac0x29.html?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E5%A4%A7%E7%A5%9E%E5%B0%8F%E8%AE%B0.jpg",actor:""}]},{type:"预告",data:[{title:'电影<火锅英雄> "不负兄弟"版预告片',link:"http://baidu.yinyuetai.com/watch/04211167386051128852.html?page=videoMultiNeed?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E9%9F%B3%E6%82%A6%E5%8F%B0.jpg",actor:""},{title:"电影《火锅英雄》预告片",link:"http://baidu.hz.letv.com/watch/04430303469251248300.html?page=videoMultiNeed?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E4%B9%90%E8%A7%86.jpg",actor:""},{title:"《火锅英雄》终极预告",link:"http://baidu.ku6.com/watch/05213831573411293344.html?page=videoMultiNeed?fvt=ugc",video_type:"10",image_link:"http://list.video.baidu.com/%E9%85%B7%E5%85%AD.jpg",actor:""}]}]}};i.conf=E});
;define("detail:widget/abTest/abTest.js",function(require,exports,module){function abTest(t){this.type=t.type,this.id=t.id}var $=require("common:static/vendor/jquery/jquery.js"),abTestTmpl=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="";var episode,len=Math.min(data.length,5);__p+='\n<div class="episode-focus-wrap clearfix">\n    ';for(var i=0;len>i;i++)__p+="\n    ",episode=data[i],__p+='\n    <div class="new-item',i==len-1&&(__p+=" new-item-last"),__p+="",i>0&&i==len-2&&(__p+=" new-item-last-two"),__p+=" new-item-"+(null==(__t=i+1)?"":__t)+" ",1===+episode.video_type&&(__p+="new-item-out"),__p+='">\n        <a static="bl=vepisodes&stp=video" target="_blank" class="view-box" href="'+(null==(__t=episode.link)?"":__t)+'&bl=jp_video" title="'+(null==(__t=episode.title)?"":_.escape(__t))+'">\n            <span class="view">\n                <img class="item-img" src="'+(null==(__t=episode.image_link)?"":__t)+'"/>\n                <span class="info-bg"></span>\n                <span class="info">'+(null==(__t=episode.actor)?"":__t)+'</span>\n                <span class="s-play"></span>\n                <span class="s-new">',1===+episode.video_type&&(__p+="OUT"),__p+='</span>\n            </span>\n           <span class="title">'+(null==(__t=$.string.widthstr(episode.title,28))?"":__t)+"</span>\n        </a>\n    </div>\n    ";__p+="\n</div>"}return __p},abTestLayoutTmpl=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+="",__p+="\n<div class='abTest-tmpl' static='pt=ugc&ty=click&ugcid="+(null==(__t=id)?"":__t)+"&ugcty="+(null==(__t=type)?"":_.escape(__t))+"'>\n    <h6>"+(null==(__t=type)?"":__t)+"</h6>\n    "+(null==(__t=abTestTmpl(obj))?"":__t)+"\n</div> \n";return __p},_=require("common:static/vendor/underscore/underscore.js"),ABTest=require("common:static/ui/ABTest/ABTest.js"),config=require("detail:widget/abTest/abTest.conf.js");abTest.prototype={constructor:abTest,random:function(t,e){for(var i=ABTest.create(),s=0;t>s;s++)i.split(100/t,function(){e(s)})},render:function(){var t=config.conf[this.id].types,e=$("#prodAbTest"),i=this.id;this.random(t.length,function(s){t[s].key=s,t[s].id=i,e.html(abTestLayoutTmpl(t[s])),$.log("http://pc.videoclick.baidu.com/v.gif?pid=104&pt=ugc&ty=show&ugcid="+i+"&type="+t[s].type)})}},module.exports=exports.abTest=abTest});
;define("detail:widget/comment/comment_tieba.js",function(require,exports,module){function stripTags(e){return(e||"").replace(/<[^>]+>/g,"")}function CommentArea(e){this.initialize(e)}function TiebaComments(e){this.initialize(e),this.render()}function setupPager(e){function t(e,t){if(null!==e&&null!==t){var n=new Function("obj","var _=[];with(obj){_.push('"+e.replace(/[\r\t\n]/g," ").replace(/'(?=[^#]*#>)/g,"	").split("'").join("\\'").split("	").join("'").replace(/<#=(.+?)#>/g,"',$1,'").split("<#").join("');").split("#>").join("_.push('")+'\');}return _.join("");');return n(t)}}function n(e){var t=e.match(/#([^&]*&)*page=([^&]+)/i),n=t?parseInt(t[2],10):0/0;return n}function i(r){r=isNaN(r)||r>a?1:r,o.innerHTML=t(s,{page:r,total:a});var l=o.getElementsByTagName("a");T.each(l,function(t,a){$(a).on("click",function(t){t.preventDefault(),i(n(this.href)),e.onChange&&e.onChange(n(this.href))})})}var a=e.total,o=e.wrap;if(1>=a)return void(o.style.visibility="hidden");o.style.visibility="visible",o.innerHTML="";var r='<#if(page==1){#><span class="pages_flip">上一页</span><#}else{#><a href="#page=<#=page-1#>"class="pages_flip">&lt;上一页</a><#}var before=true,behind=true;for(var i=1,len=total;i<=len;i++){if((i-page<=2&&i-page>=-2)||(page<=5&&i<=7)||(page>=len-4&&i>=len-6)||i==1||i==len){if(page==i){#><span><#=i#></span><#}else{#><a href="#page=<#=i#>"><#=i#></a><#}}else{if(before&&i<page){#><em>…</em><#before=false}if(behind&&i>page){#><em>…</em><#behind=false}}}if(page==total){#><span class="pages_flip">下一页</span><#}else{#><a href="#page=<#=page+1#>"class="pages_flip">下一页&gt;</a><#}#>',s=r.replace(/(?:^\s*<!--)|(?:-->\s*$)/g,"");return i(),o}var USER_ACCESS_TOKEN,T=$,ec=require("common:static/ui/eventcenter/eventcenter.js"),_=require("common:static/vendor/underscore/underscore.js"),OpenOauth=require("common:static/ui/openoauth/openoauth.js"),bdPassPop=require("common:static/ui/bdPassPop/bdPassPop.js"),core=require("common:static/ui/core/core.js"),vApp=core.vApp,config=core.config,auth=new OpenOauth;config.baseUrl="/",CommentArea.prototype={initialize:function(e){var t=this;t.videoId=e.videoId,t.worksType=e.worksType,t.isSubmitting=!1,t.vString=null,t.setup(),ec.attach(OpenOauth.Event.Login,function(){t.updateStatus(auth.user)}),ec.attach(OpenOauth.Event.AccessToken,function(e){e&&e.at&&(USER_ACCESS_TOKEN=e.at)})},bindEl:function(){var e=this;e.wrapperEl=$(".comment-text-wrapper",e.el)[0],e.textEl=$("#commentText")[0],e.infoEl=$(".comment-text-info",e.el)[0],e.coverEl=$(".comment-text-cover",e.el)[0],e.verifyEl=$(".comment-verify",e.el)[0],e.verifyImgEl=$(".comment-verify-img",e.el)[0],e.vCodeEl=$("#vCode")[0],e.changeVCodeEl=$("#changeVCode")[0],e.btnAddEl=$("#addComment")[0]},bindEvents:function(){var e=this,t=function(){auth.isLogin&&($(e.textEl).off("focus",t),e.verifyEl.style.display="block",e.changeVCode())};$(e.textEl).on("focus",t),$(e.vCodeEl).on("keypress",function(t){13===t.keyCode&&e.vCodeEl.value&&4===e.vCodeEl.value.length&&e.addComment()}),$(e.changeVCodeEl).on("click",function(){e.changeVCode()}),$(e.btnAddEl).on("click",function(){auth.isLogin?e.addComment():bdPassPop.show()})},render:function(){},setup:function(){this.bindEl(),this.bindEvents()},show:function(){$(this.wrapperEl).show()},hide:function(){$(this.wrapperEl).hide()},changeVCode:function(){var e=this;$(e.verifyImgEl).empty();var t=config.baseUrl+"video_topic/?",n=["type=captcha","t="+(new Date).getTime()],i=function(t){t.str&&(e.vCodeEl.value="",e.vString=t.str,e.verifyImgEl.innerHTML=T.stringFormat('<img src="#{0}#{1}" title="请输入验证码" alt="加载中..."/>',[config.captchaPrefix,t.str]))};t+=n.join("&"),T.get(t,function(e){if(e)try{i(e)}catch(t){vApp.debug(t),vApp.debug(e)}})},updateStatus:function(){var e=this;_.defer(function(){$(e.textEl).attr("placeholder","说说自己的感想吧！"),e.textEl.readOnly=!1,e.textEl.title="发表评论",e.textEl.innerHTML="",e.btnAddEl.innerHTML="发表评论",$(e.btnAddEl).attr("static","stp=addComment")})},beforeAddComment:function(){var e=this;if(e.isSubmitting)return!1;if(!e.videoId)return e.showTip("参数不全..."),!1;if(!USER_ACCESS_TOKEN)return e.showTip("您的登录状态有问题啊！？"),!1;var t=stripTags(T.trim(e.textEl.value));if(e.hideTip(),t.length<15||t.length>140)e.showTip("评论内容应在15~140字之间~"),e.textEl.focus();else if(e.vString){if(e.vCodeEl.value&&4===e.vCodeEl.value.length)return!0;e.showTip("请输入验证码~"),e.vCodeEl.focus()}else e.showTip("您的验证码状态有问题啊！？"),e.changeVCode(),e.verifyEl.style.display="block";return!1},addComment:function(){function e(e,t){if("object"==typeof e){var n=[];for(var i in e)n.push(i+"="+e[i]);n.push("t="+(new Date).getTime()),T.ajax({type:"post",url:config.baseUrl+"video_topic/?type=comment",data:n.join("&"),success:function(e){e&&t&&t(e)}})}}var t=this;if(t.beforeAddComment()){t.updateSubmitStatus(!0);var n={};n.content=encodeURIComponent(stripTags(T.trim(t.textEl.value))),n.id=t.videoId,n.wtype=t.worksType||0,n.acc=USER_ACCESS_TOKEN,n.vCode=t.vCodeEl.value,n.vString=t.vString,e(n,function(e){t.updateSubmitStatus(!1),t.changeVCode(),e===!1?t.showTip("呃，评论失败了。。。稍后再试一下吧~"):e.comment_id?(t.showTip("评论成功！审核通过后就可以与大家分享啦~"),t.textEl.value=""):"captcha"===e.error?(t.showTip("您输入的验证码不正确哦！"),t.vCodeEl.focus()):"spam"===e.error?(t.showTip("“百搜视频”很萌哒，请不要发垃圾信息来黑她，谢谢！"),t.textEl.value=""):(t.showTip("呃，评论失败了。。。稍后再试一下吧~"),vApp.debug(e)),_.delay(function(){t.hideTip()},4e3)})}},showTip:function(e){this.infoEl.innerHTML=e||""},hideTip:function(){$(this.infoEl).empty()},updateSubmitStatus:function(e){this.isSubmitting=e,$(this.coverEl).css({display:e?"block":"none"})}},TiebaComments.prototype={initialize:function(e){this.videoId=null,this.worksType=0,this.pageSize=e.pageSize||30,window._isDebug_&&(this.pageSize=5),this.pageNo=1,this.isClear=!0,T.extend(this,e);var t=this;t.$commentArea=new CommentArea({el:t.el.parentNode,videoId:t.videoId,worksType:t.worksType})},createContainer:function(){var e=this;e.el.innerHTML=_.template('<div class="tieba" static="bl=tiebaComment"></div><div class="tang-pager" static="bl=tiebaCommentPager"></div>',{pageTn:e.pageTn}),e.dataEl=$(".tieba",e.el)[0],e.pagerEl=$(".tang-pager",e.el)[0],e.isClear=!1},clear:function(){var e=this;e.$commentArea.hide(),e.$pager&&e.$pager.dispose(),e.$pager=null,$(e.el).empty(),e.isClear=!0},bindEl:function(){var e=this;!e.$pager&&e.data.total_num>e.pageSize&&(e.$pager=setupPager({wrap:e.pagerEl,total:Math.ceil(e.data.total_num/e.pageSize),onChange:function(t){$(e.dataEl).empty(),e.pageNo=t,e.render()}}))},load:function(e,t){var n=this;n.pageNo=e||n.pageNo;var i=["type=topicComments","id="+n.videoId,"wtype="+n.worksType,"ps="+n.pageSize,"pn="+n.pageNo],a=config.baseUrl+"video_topic/?",o=function(e){try{e&&e.comment_infos&&e.comment_infos.length>0?(n.data=e,e.start_no+e.comment_infos.length<e.total_num&&$(".load-more-btn").css("display","block"),t&&t()):e.error&&vApp.debug(e)}catch(i){vApp.debug(i)}};i.push("t="+(new Date).getTime()),T.get(a+i.join("&"),function(e){if(e)try{o(e)}catch(t){vApp.debug(t),vApp.debug(e)}})},timeFormat:function(e){return T.dateFormat(new Date(1e3*e),"yy-MM-dd HH:mm")},stripContent:function(e){return e.replace(/([^\S]on)/gi," ").replace(/script/gi," ")},render:function(){var e=this;e.$commentArea.show(),e.isClear&&e.createContainer(),e.load(e.pageNo,function(){e.insertHTML(),e.bindEl()})},insertHTML:function(){var me=this;this.dataEl.innerHTML=vApp.stripHTML(function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<ul class="comment-list comment-tieba-list"  static="bl=comment&stp=tieba">\n    ',_.each(data,function(e,t){__p+='\n        <li>\n            <span class="comment-index ',t+(page-1)*pagesize>2&&(__p+="comment-index-gray"),__p+='">'+(null==(__t=t+1+(page-1)*pagesize)?"":__t)+'</span>\n            <div class="comment-meta">\n                <dl>\n                <dt title="'+(null==(__t=e.user_name)?"":__t)+'"><a target="_blank" href="http://tieba.baidu.com/p/'+(null==(__t=thread_id)?"":__t)+"?pid="+(null==(__t=e.comment_id)?"":__t)+"#"+(null==(__t=e.comment_id)?"":__t)+'" static="ext=nickname">'+(null==(__t=e.user_name)?"":__t)+'</a></dt>\n                <dd class="comment-createtime">'+(null==(__t=$.dateFormat(new Date(1e3*e.create_time),"yy-MM-dd HH:mm"))?"":__t)+'</dd>\n                <!--<span class="comment-site"></span>-->\n                </dl>\n            </div>\n            <div class="comment-primary">\n                <!--<h3 class="comment-title"></h3>-->\n                <p class="comment-content">'+(null==(__t=e.content.replace(/([^\S]on)/gi," ").replace(/script/gi," "))?"":__t)+"</p>\n            </div>\n        </li>\n    "}),__p+="\n</ul>\n";return __p}({data:this.data.comment_infos,thread_id:this.data.thread_id,page:me.pageNo,pagesize:me.pageSize}))}},module.exports=TiebaComments});
;define("detail:widget/loadHao123/loadHao123.js",function(o,a,d){d.exports=function(){}});
;define("detail:widget/comment/comment.js",function(require,exports,module){var $=require("common:static/vendor/jquery/jquery.js"),_=require("common:static/vendor/underscore/underscore.js"),TiebaComment=require("detail:widget/comment/comment_tieba.js");require("common:static/vendor/bootstrap/js/tab.js");var Comment=function(t,e){return this.element=$(t),this.options=_.extend({},this.defaultOptions,e),this.initialize(),this};Comment.VERSION="0.0.1",_.extend(Comment.prototype,{initialize:function(){this.options.templates.weibo=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<ul class="comment-list comment-weibo-list" static="bl=comment&stp=weibo">\n    ',_.each(data,function(t,e){__p+='\n        <li class="hide">\n            <span class="comment-index ',e>2&&(__p+="comment-index-gray"),__p+='">'+(null==(__t=e+1)?"":__t)+'</span>\n            <div class="comment-meta">\n                <dl>\n                <dt title="'+(null==(__t=t.screen_name)?"":__t)+'"><a target="_blank" href="http://weibo.com/u/'+(null==(__t=t.uid)?"":__t)+'" static="ext=nickname">'+(null==(__t=t.screen_name)?"":__t)+'</a></dt>\n                <dd class="comment-createtime">'+(null==(__t=t.created_at)?"":__t)+'</dd>\n                <!--<span class="comment-site"></span>-->\n                </dl>\n            </div>\n            <div class="comment-primary">\n                <!--<h3 class="comment-title"></h3>-->\n                <p class="comment-content">'+(null==(__t=t.text)?"":__t)+"</p>\n            </div>\n        </li>\n    "}),__p+="\n</ul>\n",data.length&&(__p+='\n    <a class="load-more-btn" href="javascript:;" static="ext=more&stp=weibo">查看更多</a>\n    <div class="statement-tip">以上信息均来自互联网</div>\n'),__p+="";return __p},this.options.templates.douban=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<ul class="comment-list comment-douban-list" static="bl=comment&stp=douban">\n    ',_.each(data,function(t,e){__p+='\n        <li class="hide">\n        <span class="comment-index ',e>2&&(__p+="comment-index-gray"),__p+='">'+(null==(__t=e+1)?"":__t)+'</span>\n        <div class="comment-primary">\n            <h3 class="comment-title"><a static="ext=title" target="_blank" href="'+(null==(__t=t.url)?"":__t)+'">'+(null==(__t=t.title)?"":__t)+'</a><span class="star-bg"><span class="star" style="width:'+(null==(__t=11*Math.round(5*t.rating/50))?"":__t)+'px"></span></span><span class="comment-createtime">'+(null==(__t=t.update)?"":__t)+'</span></h3>\n            <p class="comment-content">'+(null==(__t=t.intro)?"":__t)+'<a static="ext=more" class="comment-more" target="_blank" href="'+(null==(__t=t.url)?"":__t)+'">更多</a></p>\n        </div>\n       </li>\n    '}),__p+="\n</ul>\n",data.length&&(__p+="\n    ",doubanUrl&&(__p+='<p class="douban-link"><a href="'+(null==(__t=doubanUrl)?"":__t)+'" target="_blank" static="stp=allComments">查看全部豆瓣影评&gt;&gt;</a></p>'),__p+='\n    <a class="load-more-btn" href="javascript:;" static="stp=douban&ext=more">查看更多</a>\n    <div class="statement-tip">以上信息均来自互联网</div>\n'),__p+="";return __p},this.options.templates.tieba=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<ul class="comment-list comment-tieba-list"  static="bl=comment&stp=tieba">\n    ',_.each(data,function(t,e){__p+='\n        <li>\n            <span class="comment-index ',e+(page-1)*pagesize>2&&(__p+="comment-index-gray"),__p+='">'+(null==(__t=e+1+(page-1)*pagesize)?"":__t)+'</span>\n            <div class="comment-meta">\n                <dl>\n                <dt title="'+(null==(__t=t.user_name)?"":__t)+'"><a target="_blank" href="http://tieba.baidu.com/p/'+(null==(__t=thread_id)?"":__t)+"?pid="+(null==(__t=t.comment_id)?"":__t)+"#"+(null==(__t=t.comment_id)?"":__t)+'" static="ext=nickname">'+(null==(__t=t.user_name)?"":__t)+'</a></dt>\n                <dd class="comment-createtime">'+(null==(__t=$.dateFormat(new Date(1e3*t.create_time),"yy-MM-dd HH:mm"))?"":__t)+'</dd>\n                <!--<span class="comment-site"></span>-->\n                </dl>\n            </div>\n            <div class="comment-primary">\n                <!--<h3 class="comment-title"></h3>-->\n                <p class="comment-content">'+(null==(__t=t.content.replace(/([^\S]on)/gi," ").replace(/script/gi," "))?"":__t)+"</p>\n            </div>\n        </li>\n    "}),__p+="\n</ul>\n";return __p},this.options.templates.comment=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+="",data.navs.length>0&&(__p+='\n<h3 class="block-title" id="detailComment">网友评论</h3>\n'),__p+='\n<ul class="nav nav-tabs" role="tablist">\n    ',_.each(data.navs,function(t){__p+='\n        <li><a class="nav-tab" href="#content-'+(null==(__t=t.type)?"":__t)+'" data-type="'+(null==(__t=t.type)?"":__t)+'" static="stp='+(null==(__t=t.type)?"":__t)+'&ext=tab" role="tab" title="'+(null==(__t=t.title)?"":__t)+'">'+(null==(__t=t.title)?"":__t)+"</a></li>\n    "}),__p+='\n</ul>\n<div class="tab-content">\n    <div class="comment-text-wrapper" style="display: none">\n        <div class="comment-text">\n            <textarea id="commentText" title="请您先登录，再进行评论~" placeholder="请您先登录，再进行评论~~" readonly="readonly">请您先登录，再进行评论~</textarea>\n        </div>\n        <div class="comment-text-op">\n            <a id="addComment" class="btn-comment" href="javascript:;" static="stp=login" title="请先登录">请先登录</a>\n            <div class="comment-verify">\n                <input type="text" id="vCode" title="请输入验证码" maxlength="4" required="required"/>\n                <span class="comment-verify-img"></span>\n                <a id="changeVCode" href="javascript:;" static="stp=changeVCode" title="换一张">换一张</a>\n            </div>\n            <div class="comment-text-info"></div>\n        </div>\n        <div class="comment-text-cover"><span class="cover-label">提交中，请稍后...</span></div>\n    </div>\n    ',_.each(data.navs,function(t){__p+='\n        <div class="tab-pane" id="content-'+(null==(__t=t.type)?"":__t)+'">'+(null==(__t=t.title)?"":__t)+"</div>\n    "}),__p+="\n</div>\n";return __p},this.renderSection.cache={},this.bindEvents(),this.load()},defaultOptions:{templates:{},EVENTS:{BEFORE_LOAD:"comment.load.before",AFTER_LOAD:"comment.load.after"},helpers:{weibo:{getComments:function(t){return{data:t||[]}}},douban:{getComments:function(t){var e;return e=t&&t.comments&&t.comments.length?{data:t.comments,doubanUrl:this.options.doubanUrl||""}:{}}},tieba:{getComments:function(t){return{data:t||[]}}}},baseUrl:"http://v.baidu.com",apis:{common:"/movie_intro/?callback=?&dtype=commentCombine&service=json&id="}},getApiUrl:function(){var t=this.options;return t.baseUrl+t.apis.common+t.videoID},load:function(){var t=this;$(t).trigger(t.options.EVENTS.BEFORE_LOAD),$.getJSON(this.getApiUrl(),function(e){t.data||(t.data={}),_.extend(t.data,e),$(t).trigger(t.options.EVENTS.AFTER_LOAD,e)})},bindEvents:function(){var t=this;$(t).on(t.options.EVENTS.AFTER_LOAD,function(e,n){t.navs=[],n.weibo&&n.weibo.length&&t.navs.push({type:"weibo",title:"新浪微博"}),n.douban&&n.douban.comments&&n.douban.comments.length&&t.navs.push({type:"douban",title:"豆瓣"}),"hao123"!==t.options.frSite,t.render(),1===t.navs.length&&require("detail:widget/loadHao123/loadHao123.js")("movie")}),t.element.on("show.bs.tab",".nav-tab",function(e){var n=$(e.target).data("type");t.renderSection.cache[n]||t.renderSection(n),"tieba"!==n?$(".comment-text-wrapper").hide():$(".comment-text-wrapper").show()}).on("click",".nav-tab",function(t){t.preventDefault(),$(t.currentTarget).tab("show")})},render:function(){var t=this.options.templates,e=this,n=t.comment({data:{navs:this.navs}});e.element.html(n).show(200),e.element.find(".nav-tab:first").tab("show")},renderSection:function(type){var options=this.options,template=options.templates[type],helper=options.helpers[type],element=$("#content-"+type),contentHtml=template(helper.getComments.call(this,this.data[type])),ps=10;if("tieba"===type){var page=2,tc=new TiebaComment({videoId:options.videoID,el:element[0],pageSize:ps,pageTn:options.pageTn}),tpl=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<ul class="comment-list comment-tieba-list"  static="bl=comment&stp=tieba">\n    ',_.each(data,function(t,e){__p+='\n        <li>\n            <span class="comment-index ',e+(page-1)*pagesize>2&&(__p+="comment-index-gray"),__p+='">'+(null==(__t=e+1+(page-1)*pagesize)?"":__t)+'</span>\n            <div class="comment-meta">\n                <dl>\n                <dt title="'+(null==(__t=t.user_name)?"":__t)+'"><a target="_blank" href="http://tieba.baidu.com/p/'+(null==(__t=thread_id)?"":__t)+"?pid="+(null==(__t=t.comment_id)?"":__t)+"#"+(null==(__t=t.comment_id)?"":__t)+'" static="ext=nickname">'+(null==(__t=t.user_name)?"":__t)+'</a></dt>\n                <dd class="comment-createtime">'+(null==(__t=$.dateFormat(new Date(1e3*t.create_time),"yy-MM-dd HH:mm"))?"":__t)+'</dd>\n                <!--<span class="comment-site"></span>-->\n                </dl>\n            </div>\n            <div class="comment-primary">\n                <!--<h3 class="comment-title"></h3>-->\n                <p class="comment-content">'+(null==(__t=t.content.replace(/([^\S]on)/gi," ").replace(/script/gi," "))?"":__t)+"</p>\n            </div>\n        </li>\n    "}),__p+="\n</ul>\n";return __p};$('<a class="load-more-btn hide" href="javascript:;" static="ext=more&stp=tieba">查看更多</a>').bind("click",function(){var t=this;$(t).html("加载中"),tc._load(page++,function(){if(tc.data.total_num&&tc.data.total_num>tc.data.comment_infos.length+ps*(page-1)){var e=tpl({data:tc.data.comment_infos,thread_id:tc.data.thread_id,page:page-1,pagesize:ps});element.find(".tieba").eq(0).append(e),$(t).html("查看更多<span></span>")}else $(t).remove()})}).appendTo(element),element.append('<div class="statement-tip">以上信息均来自互联网</div>')}else element.html(contentHtml),element.find(".load-more-btn").on("click",function(){$(this).html("加载中");var t=element.find("li.hide"),e=t.length;t.each(function(t,e){ps>t&&$(e).removeClass("hide")}),$(this).html("查看更多<span></span>"),ps>=e&&$(this).remove()}).trigger("click");this.renderSection.cache[type]=!0},META:{nav:{},weibo:{},douban:{},tieba:{}}}),module.exports=function(t,e){new Comment(t,e)}});
;define("detail:widget/episode/config/appendix.js",function(o,a){var c={tv22766:{hao123:{"pptv.com":"rcc_id=hao123_nqj"}},tv22926:{hao123:{"pptv.com":"rcc_id=hao123_wdljny"}},show12492:{hao123:{"qq.com":"ptag=hao123.voice4"}},tv23025:{hao123:{"iqiyi.com":"vfm=f_243_hao1&fv=534cea53c5350b116c9065c7fada7707"}},tv23046:{hao123:{"iqiyi.com":"vfm=f_243_hao1&fv=534cea53c5350b116c9065c7fada7707"},video:{"iqiyi.com":"fv=p_02_02"}},tv23032:{hao123:{"pptv.com":"rcc_id=hao123_daxiahfh"}}};a.get=function(o,a,i){var v="";return o=o.toLowerCase(),c[o]&&c[o][a]&&c[o][a][i]&&(v=c[o][a][i]),v}});
;define("detail:widget/episode/episode.js",function(require,exports,module){var Root,T=$,_=require("common:static/vendor/underscore/underscore.js"),Backbone=require("common:static/vendor/backbone/backbone.js"),ec=(require("common:static/ui/vipConfig/vipConfig.js"),require("common:static/ui/vipInfo/vipInfo.js"),require("common:static/ui/eventcenter/eventcenter.js")),templates={episodes:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="";var episode,restNum="tv"!=type||"hao123"!=frSite||finish?5:4;if(__p+="\n","duba"==frSite);else;if(__p+="\n",len&&len>0){__p+='\n	<ul class="episode-episodes-list clearfix">\n		';for(var i=start;max>i;i++)__p+="\n			",!fold||fold&&(42>i||i>max-restNum)?(__p+="\n				",episode=episodes[i].toJSON(),__p+='\n				<li class="episode-episode" data-episode="'+(null==(__t=episode.episode)?"":__t)+'">\n					<a target="_blank" class="episode-episode-card" href="'+(null==(__t=episode.url)?"":__t)+'&bl=jp_video" title="'+(null==(__t=episode.title)?"":_.escape(__t))+'" data-record="'+(null==(__t=episode.record)?"":__t)+'" data-episode="'+(null==(__t=episode.episode)?"":_.escape(__t))+'" static="stp=video&site='+(null==(__t=episode.site_url)?"":__t)+"&n="+(null==(__t=episode.episode)?"":__t),filterSite==episode.site_url&&""!==pro&&(__p+="&pro="+(null==(__t=pro)?"":__t)),__p+="",episode.isPer&&(__p+="&per=1"),__p+='">'+(null==(__t=episode.text)?"":_.escape(__t)),episode.isPay?__p+='<span class="episode-episode-pay"></span>':episode.lastEpisode&&(__p+='<span class="episode-episode-last"></span>'),__p+="",episode.isPer&&(__p+='<span class="episode-episode-per"></span>'),__p+="</a>\n				</li>\n			"):fold&&42==i&&(__p+="\n				",i=max-restNum,__p+='\n				<li class="episode-episode unfold" data-start="'+(null==(__t=start)?"":__t)+'" static="stp=unfold">\n					<a class="episode-episode-card" href="#" title="展开全部'+(null==(__t=total)?"":__t)+'集">......</a>\n				</li>\n			'),__p+="\n			",total>=len&&i==max-1&&(__p+="\n				",!fold&&(len>=pageBaseNumber||showFold)&&(__p+='\n				<li class="episode-episode fold" static="stp=fold">\n					<a class="episode-episode-card" href="#" title="收起">收起</a>\n				</li>\n				'),__p+="\n			"),__p+="\n			",i!=max-1||"hao123"!=frSite||finish||"tv"!=type||(__p+='\n			<li class="episode-episode episode-qxk" static="stp=downloadBrowse">\n				<a class="episode-episode-card" href="'+(null==(__t=episode.url)?"":__t)+'" title="抢先看" target="_blank">抢先看</a>\n			</li>\n			'),__p+="\n		";__p+="\n	</ul>\n"}else __p+='\n	<p class="episode-sites-none">暂无站点数据</p>\n';__p+="\n"}return __p},loading:function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<p class="episode-loader">努力地加载中...</p>';return __p},pagination:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){if(__p+="",paginations.length){__p+="\n    ";var idx=0;last&&(idx=paginations.length-1),__p+="\n    ",paginations.length>3?(__p+='\n        <ul class="episodes-dropdown episode-paginations-menu clearfix">\n            ',_.each(paginations,function(e,t){__p+='\n                <li class="episode-page-item',t==idx&&(__p+=" current"),__p+='">\n                    <a href="#" class="episode-page clearfix" data-start="'+(null==(__t=e.start)?"":__t)+'" title="'+(null==(__t=e.begin)?"":__t)+"-"+(null==(__t=e.end)?"":__t)+(null==(__t=unit)?"":__t)+'"><b></b>'+(null==(__t=e.begin)?"":__t)+"-"+(null==(__t=e.end)?"":__t)+"\n                    </a>\n                </li>\n            "}),__p+="\n        </ul>\n    "):(__p+='\n        <ul class="episode-paginations clearfix">\n            ',_.each(paginations,function(e,t){__p+='\n                <li class="episode-page-item',t==idx&&(__p+=" current"),__p+='">\n                    <a href="#" class="episode-page" data-start="'+(null==(__t=e.start)?"":__t)+'" title="'+(null==(__t=e.begin)?"":__t)+"-"+(null==(__t=e.end)?"":__t)+(null==(__t=unit)?"":__t)+'">'+(null==(__t=e.begin)?"":__t)+"-"+(null==(__t=e.end)?"":__t)+"</a>\n                </li>\n            "}),__p+="\n        </ul>\n    "),__p+="\n"}else __p+="\n<h6>全部剧集","video"!==window.product_name&&"duba"!==window.product_name||isBrand||!site||site.match(/iqiyi/)||(__p+=' <a  target="_blank" class="link-jishu-tv" data-open-player="1" data-title="'+(null==(__t=title)?"":__t)+'" static="stp=play_jishu"></a>'),__p+="</h6>\n";__p+="\n"}return __p},sites:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){if(__p+="",sites.length){var site,len=sites.length;if(__p+="\n",opt.isBrand&&curSite.site==opt.filterSite){__p+='\n	<div class="site-list">\n		',__p+="show"==opt.type?'\n		<span class="site-brand">\n			<span class="site" style="background-image:url('+(null==(__t=curSite.logo)?"":__t)+')">'+(null==(__t=curSite.name)?"":__t)+"全网首播</span>\n		</span>\n		":'\n		<span class="current-site-wrap">当前选择：<a class="site" style="background-image:url('+(null==(__t=curSite.logo)?"":__t)+')">'+(null==(__t=curSite.name)?"":__t)+"</a></span>\n		",__p+='\n		<span class="j-more">\n			<a href="#" class="more">更多</a>\n			<ul class="episodes-site-more j-more-list">\n			';for(var i=0,l=len;l>i;i++)site=sites[i],__p+='\n				<li>\n					<a href="#" data-site="'+(null==(__t=site.site)?"":__t)+'" class="site',site.site==curSite.site&&(__p+=" current"),__p+='" title="'+(null==(__t=site.name)?"":__t),site.isVip&&(__p+=" VIP免广告"),__p+='" static="bl=epi&blname=剧集&stp=site&site='+(null==(__t=site.site)?"":__t)+'" style="background-image:url('+(null==(__t=site.logo)?"":__t)+')">'+(null==(__t=site.name)?"":__t)+"</a>\n				</li>\n			";__p+="\n			</ul>\n		</span>\n	</div>\n"}else{__p+='\n	<div class="site-list">\n		',__p+="show"==opt.type?"\n		<span>智能排序：</span>\n		":'\n		<span class="current-site-wrap">当前选择：<a class="site" style="background-image:url('+(null==(__t=curSite.logo)?"":__t)+')">'+(null==(__t=curSite.name)?"":__t)+"</a></span>\n		",__p+="\n		";for(var i=0,l=Math.min(5,len);l>i;i++)site=sites[i],__p+='\n		<a href="#" class="site',site.site==curSite.site&&(__p+=" current"),__p+='" data-site="'+(null==(__t=site.site)?"":__t)+'" title="'+(null==(__t=site.name)?"":__t),site.isVip&&(__p+=" VIP免广告"),__p+='" static="bl=epi&blname=剧集&stp=site&site='+(null==(__t=site.site)?"":__t)+'" style="background-image:url('+(null==(__t=site.logo)?"":__t)+')">'+(null==(__t=site.name)?"":__t)+"</a>\n		",l-1>i&&(__p+="<b>&gt;</b>"),__p+="\n		";if(__p+="\n		",len>5){__p+='\n		<span class="j-more">\n			<a href="#" class="more">更多</a>\n\n			<ul class="episodes-site-more j-more-list">\n			';for(var i=5,l=len;l>i;i++)site=sites[i],__p+='\n				<li>\n					<a href="#" data-site="'+(null==(__t=site.site)?"":__t)+'" class="site',site.site==curSite.site&&(__p+=" current"),__p+='" title="'+(null==(__t=site.name)?"":__t),site.isVip&&(__p+=" VIP免广告"),__p+='" static="bl=epi&blname=剧集&stp=site&site='+(null==(__t=site.site)?"":__t)+'" style="background-image:url('+(null==(__t=site.logo)?"":__t)+')">'+(null==(__t=site.name)?"":__t)+"</a>\n				</li>\n			";__p+="\n			</ul>\n		</span>\n		"}__p+="\n		",hasPaysite&&(__p+='\n		<b class="paysite">(付费观看)</b>\n		'),__p+="\n	</div>\n"}__p+="\n"}__p+=""}return __p},newest:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="";var itm;__p+="\n";for(var i=0,l=data.length;l>i;i++)__p+="\n	",itm=data[i].toJSON(),__p+='\n	<a href="'+(null==(__t=itm.url)?"":__t)+'&bl=new_epi" class="episode-newest ',__p+=itm.thumbnail?"episode-newest-img":"episode-newest-text",__p+='" title="'+(null==(__t=itm.title)?"":__t)+'" target="_blank" static="site='+(null==(__t=itm.site_url)?"":__t)+'">\n		',__p+=itm.thumbnail?'\n		    <img src="'+(null==(__t=itm.thumbnail)?"":__t)+'" alt="'+(null==(__t=itm.title)?"":__t)+"\" onerror=\"$(this).parent().addClass('episode-newest-text').removeClass('episode-newest-img').end().remove();\"><b></b>\n		    <p>第"+(null==(__t=itm.episode)?"":__t)+'集</p>\n		    <span class="s-play"></span>\n		':"\n			第"+(null==(__t=itm.episode)?"":__t)+"集<b></b>\n		",__p+="\n	</a>\n";__p+=""}return __p},episodetip:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<div class="episode-tip">\n	<p>观看到'+(null==(__t=record)?"":__t)+'集</p>\n	<span class="arrow"><em>◆</em><i>◆</i></span>\n</div>';return __p}},Episode={setRoot:function(e){Root=e||this},Models:{},Collections:{},Views:{},Config:{}};Episode.setRoot(),_.extend(Episode,{options:{type:"",frpBrowse:!1,apiUrl:"",urlPrefix:"",finish:0,lastEpisode:"",pageBaseNumber:50,fields:{single_title:"",url:"",episode:"",is_play:"",site_order:"",site_url:"",link:"",category:"",site:""},fieldsAdapter:function(){},isLastEpisode:function(e){return!parseInt(this.finish,10)&&e&&+e+1>=this.lastEpisode}}}),_.extend(Episode,{queryModel:null,dataCollection:null,siteCollection:null,init:function(e){var t=this,i=e.type,s={site:""};$.cache.play_site_new_fr_ep={},this.options=_.extend(this.options,this.Config[i],e),"hao123"===e.frSite&&(this.options.apiPath=this.options.apiPathHao,this.options.hostUrl=this.options.hostUrlHao),this.initApiUrl(),this.queryModel=new Backbone.Model,this.dataCollection=new t.Collections.Data,this.siteCollection=new t.Collections.Site,this.focusCollection=new t.Collections.Focus,this.queryModel.on("change",_.bind(this.queryChange,t)),this.dataCollection.on("data.loaded",_.bind(this.dataLoaded,this)),this.initViews(),$.getScript("http://list.video.baidu.com/bdvappendix.js",function(){t.queryModel.set(s)})},initApiUrl:function(){var e=this.options,t=e.hasPaysite?"&frp=fufei":e.frpBrowse?"&frp=browse":"";e.apiUrl=e.apiPath+"?callback=?&dtype="+e.dtype+"PlayUrl&e=1&service=json&id="+e.id+t},initViews:function(){var e=this.Views;this.episodesView=new e.Episodes,this.headerView=new e.Header},dataLoaded:function(e){var t=e.model.get("episodes");~this.options.sort||(t=t.sort(function(e,t){return t.episode-e.episode}));var i=e.model.attributes.episodes[0];i&&this.changeHeadPlay(i),this.episodesView.collection.reset(t)},changeHeadPlay:function(e){var t=e.site_url.split(".")[0];$("#time-title").attr("href",e.url).find(".j_episode_num").hide().html(e.episode+"期").fadeIn(),$(".intro-last-news").find(".title").hide().html(e.single_title).attr({href:e.url,title:e.single_title}).fadeIn(),$(".j_play_btn_now").attr("href",e.url),$("#siteLOGO").hide().attr("src","http://vs3.bdstatic.com/logo/big/"+t+".png").fadeIn()},queryChange:function(e){var t=e.toJSON();this.episodesView.trigger("showLoader"),this._cacheQuery=e,this.dataCollection.load(t)},getTempalte:function(e){return templates[e]},getUrlAppendix:function(e){var t=this.options,i="";try{i=_bdvAppendixFn(t.type+t.id,t.frSite,e)}catch(s){}return i},getPlayUrl:function(e,t,i,s){var n,o=this.options,a=o.frpBrowse?"browse":"",l="";("video"===o.frSite||"duba"===o.frSite)&&(l=o.vfm?"&vfm="+o.vfm:o.isBrand&&o.filterSite===t?"&vfm=bdvppzq":o.frpBrowse?"&vfm=bdvcsplld":"&vfm=bdvtx"),n=s+(s.indexOf("?")>-1?"&":"?")+"page="+o.pagetn+l;var _=this.getUrlAppendix(t);return _&&!function(){for(var e,t=/([^=&]+)=([^&]+)/g;e=t.exec(_);){var i=new RegExp(e[1]+"=([^&]+)","g");n=n.replace(i,"")}}(),_&&(n+="&"+_),n+"&frp="+encodeURIComponent(o.hostUrl+a)},initedPlayRecord:!1,initingPlayRecord:!1,initPlayRecord:function(){if(this.initedPlayRecord)return this.trigger("record");if(!this.initingPlayRecord){this.initingPlayRecord=!0;var e=this.options,t={tv:"TV",comic:"C",tvshow:"T"},i=t[e.type]+e.id,s=this;if(!window.bdvRecordAPI)return void setTimeout(function(){s.initPlayRecord()},2e3);s.on("record",_.bind(s.onRecord,s)),window.bdvRecordAPI.get(function(e){var t=e&&e[i]||0;s.trigger("record",t),s.initedPlayRecord=!0})}},userRecord:0,onRecord:function(e){e&&(this.userRecord=e),this.episodesView.trigger("updateRecord",this.userRecord)}}),_.extend(Episode,Backbone.Events),_.extend(Episode.Models,{Cache:Backbone.Model.extend({defaults:{id:"",episodes:[]}}),Episodes:Backbone.Model.extend({defaults:{to:"play",url:"",title:"",text:""}}),Site:Backbone.Model.extend({defaults:{id:"",site:"",name:"",logo:"",isVip:!1,order:99,years:[],sale:{}}}),Focus:Backbone.Model.extend({defaults:{id:"",timeaxis:[]}})}),_.extend(Episode.Collections,{Data:Backbone.Collection.extend({model:Root.Models.Cache,params:function(e){var t=[];return _.each(e,function(e,i){t.push(i+"="+e)}),t.join("&")},load:function(e){var t,i=this,s=e.year||"",n=e.site+s,o=n?i.get(n):i.at(0),a=function(e){if(_.each(e,function(e){var t=e.site_info.site.replace(/\./,"__"),i=$("."+t).val();$.cache.play_site_new_fr_ep[e.site_info.site]={big_logo:e.site_info.big_logo,logo:e.site_info.logo,site:e.site_info.site,name:e.site_info.name,episode:i},e.site_info.id=e.site_info.site,e.years&&(e.site_info.years=e.years.sort(function(e,t){return t-e})),Root.siteCollection.add(e.site_info)}),e.length){var t=Root.siteCollection.at(0).toJSON();"duba"===Episode.options.frSite&&~_.indexOf(["23781","23860","23861"],Episode.options.id)||t.sale&&t.sale.site&&(Episode.options.filterSite=t.sale.site,Episode.options.isBrand=!0,Episode.options.pro=1===+t.sale.free?0:1,ec.trigger("prochange",Episode.options.pro)),_.each(e,function(e){var t=0===Root.options.finish?e.yugao:null;e.episodes&&e.episodes.length&&i.add({id:e.site_info.site+s,episodes:e.episodes.concat((t||[]).slice(0,3))})})}else i.add({id:"nosite",episodes:[]});return n=n||Root.siteCollection.getFirstSite()+s||"nosite",Root.siteCollection.length&&Episode.options.isBrand&&!i.brandSiteLoaded&&!Root.siteCollection.get(Episode.options.filterSite)&&(i.brandSiteLoaded=!0,n=Root.siteCollection.at(0).get("site")),o=i.get(n),!o||"nosite"!==o.id&&!o.get("episodes").length?Root.queryModel.set({site:n}):e.length&&e.length>1&&Episode.options.filterSite&&!i.brandSiteLoaded&&Root.siteCollection.at(0).get("site")!==Episode.options.filterSite?i.load({site:Episode.options.filterSite,forceLoad:1}):(Episode.options.isBrand&&!i.brandSiteLoaded?i.load({site:Episode.options.filterSite}):i.trigger("data.loaded",{model:o}),void Root.initPlayRecord())};return!Episode.options.isBrand||e.site!==Episode.options.filterSite||i.brandSiteLoaded||(i.brandSiteLoaded=!0,o&&o.get("episodes").length||e.forceLoad)?void(o&&("nosite"===o.id||o.get("episodes").length)?i.trigger("data.loaded",{model:o}):(t=Root.options.apiUrl+"&"+i.params(e),T.ajax({url:t,dataType:"jsonp",success:a,error:function(){a([])}}))):i.trigger("data.loaded",{model:i.get("nosite")})}}),Episodes:Backbone.Collection.extend({initialize:function(){var e=this;this.on("reset",function(){e._monthsCache=null,e._episodeByMonth={}})},model:function(e){var t=Root.options.fieldsAdapter(e);return new Root.Models.Episodes(t)},getByMonth:function(e){return e?this._episodeByMonth[e]?this._episodeByMonth[e]:this._episodeByMonth[e]=this.filter(function(t){return 0===t.get("episode").substr(4).indexOf(e)}):this.models},getAllMonth:function(){var e,t=[],i=/^(20\d{2,2})\-?([01]\d)\-?([0123]\d)$/;return this._monthsCache?this._monthsCache:(this.each(function(s){var n=s.get("episode"),o=n.match(i);o&&o.length&&e!==o[2]&&t.push(e=o[2])}),this._monthsCache=t.sort(function(e,t){return t-e}))}}),Site:Backbone.Collection.extend({model:Root.Models.Site,filterByYear:function(e){return e=""+e,_.sortBy(_.filter(this.toJSON(),function(t){return~_.indexOf(t.years,e)}),function(e){var t=e.isVip,i=e.order;return~~(t&&i)||i})},vipCheck:function(e){return this.vipChecked=!0,e&&e()},getFirstSite:function(){if("show"!==Root.options.type)return this.at(0)&&this.at(0).get("site")||"";var e=[];this.each(function(t){e=_.union(e,t.get("years"))}),e.sort(function(e,t){return+t-e});var t=this.filterByYear(e[0]);return t&&t.length&&t[0].site||""}}),Focus:Backbone.Collection.extend({model:Root.Models.Focus,url:function(e){return"/show_intro/?dtype=kandian&callback=?&service=json&id="+Root.options.id+"&site="+e.site+"&episode="+e.episode},load:function(e){var t=this.get(e.site+e.episode),i=this;return t?this.trigger("focus.loaded",t.toJSON()):void $.getJSON(this.url(e)).done(function(t){var s=t&&t.length?t[0]:null;s&&s.episode===e.episode?(s.id=e.site+s.episode,i.add(s)):s=null,i.trigger("focus.loaded",s)}).fail(function(){i.trigger("focus.loaded",null)})}})}),$("body").on("click","[data-record]",function(){var e=$(this),t=e.data("record"),i=e.data("episode");if(i)try{bdvRecordAPI.set(t,i)}catch(s){}}),module.exports=Episode});
;define("detail:widget/episode/show.js",function(require,exports,module){var _=require("common:static/vendor/underscore/underscore.js"),Backbone=require("common:static/vendor/backbone/backbone.js"),template={year:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){if(__p+="",years&&years.length){var year;__p+='\n    <ul class="episode-years-list clearfix" static="bl=epi&blname=剧集&stp=year">\n        ';for(var i=0,l=Math.min(years.length,4);l>i;i++){if(year=years[i],__p+="\n        ",3==i){__p+='\n        <li class="more j-more">\n            <a href="#" class="more-btn">更多</a>\n            <ul class="episode-years-more j-more-list">\n                ';for(var j=3,k=years.length;k>j;j++)__p+='\n                <li><a href="#" data-year="'+(null==(__t=years[j])?"":__t)+'">'+(null==(__t=years[j])?"":__t)+"</a></li>\n                ";__p+="\n            </ul>\n        </li>\n        "}else __p+='\n        <li class="item">\n            <a href="#" class="clearfix ',0==i&&(__p+="current"),__p+='" data-year="'+(null==(__t=year)?"":__t)+'">\n                <b></b>\n                <span>'+(null==(__t=year)?"":__t)+'</span>\n            </a>\n        </li>\n        <li class="dash"> | </li>\n        ';__p+="\n        "}__p+="\n    </ul>\n"}__p+=""}return __p},episode:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){if(__p+="",episodes.length){__p+="\n	";var episode,len=episodes.length;__p+='\n	<ul class="show-episodes-list ',len>10&&(__p+="episode-fold"),__p+=' clearfix">\n		',_.each(episodes,function(e,t){__p+="\n            ",episode=e.toJSON(),__p+="\n            ",10==t&&(__p+="<textarea>"),__p+='\n            <li class="episode-episode" data-episode="'+(null==(__t=episode.episode)?"":__t)+'">\n                <a static="stp=video&site='+(null==(__t=episode.site_url)?"":__t)+"&n="+(null==(__t=episode.episode)?"":__t),filterSite==episode.site_url&&""!==pro&&(__p+="&pro="+(null==(__t=pro)?"":__t)),__p+='" target="_blank" class="view-box" href="'+(null==(__t=episode.url)?"":__t)+'&bl=jp_video" title="'+(null==(__t=episode.title)?"":_.escape(__t))+'" data-record="'+(null==(__t=episode.record)?"":__t)+'" data-episode="'+(null==(__t=episode.episode)?"":_.escape(__t))+'">\n                    <span class="view">\n                        <img class="item-img" src="'+(null==(__t=episode.thumbnail)?"":__t)+'"/>\n                        <span class="info-bg"></span>\n                        <span class="info">'+(null==(__t=episode.date)?"":__t)+'</span>\n                        <span class="s-mask"></span>\n                        <span class="s-play"></span>\n                        ',episode.is_per?__p+='\n                        <span class="s-per"></span>\n                        ':episode.lastEpisode&&(__p+='\n                        <span class="s-new"></span>\n                        '),__p+='\n\n                    </span>\n                   <span class="title">'+(null==(__t=$.string.widthstr(episode.text,titlelen||11))?"":__t)+'</span>\n                </a>\n                <div class="gusets">\n                ',episode.guest.length&&(__p+='\n                    <ul>\n                        <li class="label">嘉宾：</li>\n                        \n                            ',_.each(episode.guest,function(e){__p+='\n                                <li static="stp=guest"><a target="_blank" href="http://v.baidu.com/v?word='+(null==(__t=e)?"":__t)+"&ie=utf-8&ct=301989888","hao123"==frSite&&(__p+="&fr=video"),__p+=""+(null==(__t=window.searchStr)?"":__t)+'">'+(null==(__t=e)?"":__t)+"</a></li>\n                            "}),__p+="\n                    </ul>\n                    "),__p+="\n                </div>\n            </li>\n            ",t>10&&t==len-1&&(__p+="</textarea>"),__p+="\n		"}),__p+="\n	</ul>\n    ",len>10&&(__p+='\n    <div class="episode-unfold">\n        <a href="#" data-toggle="收起">展开查看全部'+(null==(__t=len)?"":__t)+"期<i></i></a>\n    </div>\n    "),__p+="\n"}else __p+='\n	<p class="episode-sites-none">暂无站点数据</p>\n';__p+="\n"}return __p},months:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<a href="#" class="current">全部</a>\n',_.each(months,function(e){__p+='\n<a href="#" data-month="'+(null==(__t=e)?"":__t)+'">'+(null==(__t=e)?"":__t)+"月</a>\n"}),__p+="";return __p},newest:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="";var episode,site,url,len=focus&&focus.timeaxis&&focus.timeaxis.length?1:len,hasLastEpisode=!1;__p+="\n",__p+="video"!==window.product_name&&"duba"!==window.product_name||isBrand||!episodes[0]||!(site=episodes[0].toJSON().site_url)||site.match(/iqiyi/)?"\n    <h6>最新剧集</h6>\n":'\n    <h6>最新剧集 <a target="_blank" class="link-jishu-tv" data-open-player="1" data-title="'+(null==(__t=title)?"":__t)+'" static="stp=play_jishu"></a></h6>\n',__p+='\n<div class="episode-focus-wrap clearfix">\n    <div class="new-item-wrap">\n    ';for(var i=0,l=len;l>i;i++)__p+="\n    ",episode=episodes[i].toJSON(),hasLastEpisode=hasLastEpisode||episode.lastEpisode,__p+='\n	<div class="new-item new-item-'+(null==(__t=i)?"":_.escape(__t))+'">\n		<a static="stp=video&site='+(null==(__t=episode.site_url)?"":__t)+"&n="+(null==(__t=episode.episode)?"":__t)+'" target="_blank" class="view-box" href="'+(null==(__t=episode.url)?"":__t)+'&bl=jp_video" title="'+(null==(__t=episode.title)?"":_.escape(__t))+'" data-record="'+(null==(__t=episode.record)?"":__t)+'" data-episode="'+(null==(__t=episode.episode)?"":_.escape(__t))+'">\n            <span class="view">\n                ',episode.gif_thumbnail?(__p+="\n                    ",__p+=0===i?'\n                    <img class="item-img" src="'+(null==(__t=episode.gif_thumbnail)?"":__t)+'" data-ori="'+(null==(__t=episode.thumbnail)?"":__t)+'" data-gif="'+(null==(__t=episode.gif_thumbnail)?"":__t)+'" data-gif-showed="1"/>\n                    ':'\n                    <img class="item-img" src="'+(null==(__t=episode.thumbnail)?"":__t)+'" data-gif="'+(null==(__t=episode.gif_thumbnail)?"":__t)+'"/>\n                    ',__p+="\n                "):__p+='\n                <img class="item-img" src="'+(null==(__t=episode.thumbnail)?"":__t)+'"/>\n                ',__p+='\n                <span class="info-bg"></span>\n                <span class="info">'+(null==(__t=episode.date)?"":__t)+'</span>\n                <span class="s-play"></span>\n                ',0==i&&(__p+='\n                <span class="s-new"></span>\n                '),__p+='\n            </span>\n           <span class="title">'+(null==(__t=$.string.widthstr(episode.text,28))?"":__t)+'</span>\n        </a>\n        <div class="gusets">\n        ',episode.guest.length&&(__p+='\n            <ul>\n                 <li class="label">嘉宾：</li>\n\n                 ',_.each(episode.guest,function(e){__p+='\n<li static="stp=guest"><a target="_blank" href="http://v.baidu.com/v?word='+(null==(__t=e)?"":__t)+"&ie=utf-8&ct=301989888","hao123"==frSite&&(__p+="&fr=video"),__p+=""+(null==(__t=window.searchStr)?"":__t)+'">'+(null==(__t=e)?"":__t)+"</a></li>\n                "}),__p+="\n\n            </ul>\n            "),__p+="\n        </div>\n        ",episode.focus&&episode.focus.length&&(__p+='\n        <span class="arrows">\n            <b>◆</b><i>◆</i>\n        </span>\n        '),__p+="\n	</div>\n    ";__p+="\n    </div>\n    ",episodes[0]&&episodes[0].toJSON().is_per?__p+='\n    <span class="flag-per"></span>\n    ':hasLastEpisode&&(__p+='\n    <span class="flag-new"></span>\n    '),__p+="\n    ",focus&&focus.timeaxis&&focus.timeaxis.length&&(__p+="\n    ",episode=episodes[0].toJSON(),__p+='\n    <div class="focus">\n        <h6 class="title">本期看点</h6>\n        <ul class="list">\n        ',_.each(focus.timeaxis,function(e,t){return __p+="\n            ",t>=12?!1:(__p+="\n            ",t>1&&t%4==0&&(__p+='\n            </ul>\n            <ul class="list',8===t&&(__p+=" list-last"),__p+='">\n            '),__p+="\n            ",url=e.url?e.url:episode.url+(e.time?"&share_sTime="+e.time:""),void(__p+='\n            <li>\n                <a static="bl=focus&site='+(null==(__t=episode.site_url)?"":__t)+'" href="'+(null==(__t=url)?"":__t)+'" title="'+(null==(__t=e.desc)?"":__t)+'" target="_blank"><span>'+(null==(__t=timeHelper(e.time))?"":__t)+"</span>"+(null==(__t=$.string.widthstr(e.desc,14))?"":__t)+"</a>\n            </li>\n        "))}),__p+="\n        </ul>\n    </div>\n    "),__p+="\n</div>\n"}return __p},sites:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){if(__p+="",sites.length){var site,len=sites.length;if(__p+="\n",opt.isBrand&&curSite.site==opt.filterSite){__p+='\n	<div class="site-list">\n		',__p+="show"==opt.type?'\n		<span class="site-brand">\n			<span class="site" style="background-image:url('+(null==(__t=curSite.logo)?"":__t)+')">'+(null==(__t=curSite.name)?"":__t)+"全网首播</span>\n		</span>\n		":'\n		<span class="current-site-wrap">当前选择：<a class="site" style="background-image:url('+(null==(__t=curSite.logo)?"":__t)+')">'+(null==(__t=curSite.name)?"":__t)+"</a></span>\n		",__p+='\n		<span class="j-more">\n			<a href="#" class="more">更多</a>\n			<ul class="episodes-site-more j-more-list">\n			';for(var i=0,l=len;l>i;i++)site=sites[i],__p+='\n				<li>\n					<a href="#" data-site="'+(null==(__t=site.site)?"":__t)+'" class="site',site.site==curSite.site&&(__p+=" current"),__p+='" title="'+(null==(__t=site.name)?"":__t),site.isVip&&(__p+=" VIP免广告"),__p+='" static="bl=epi&blname=剧集&stp=site&site='+(null==(__t=site.site)?"":__t)+'" style="background-image:url('+(null==(__t=site.logo)?"":__t)+')">'+(null==(__t=site.name)?"":__t)+"</a>\n				</li>\n			";__p+="\n			</ul>\n		</span>\n	</div>\n"}else{__p+='\n	<div class="site-list">\n		',__p+="show"==opt.type?"\n		<span>智能排序：</span>\n		":'\n		<span class="current-site-wrap">当前选择：<a class="site" style="background-image:url('+(null==(__t=curSite.logo)?"":__t)+')">'+(null==(__t=curSite.name)?"":__t)+"</a></span>\n		",__p+="\n		";for(var i=0,l=Math.min(5,len);l>i;i++)site=sites[i],__p+='\n		<a href="#" class="site',site.site==curSite.site&&(__p+=" current"),__p+='" data-site="'+(null==(__t=site.site)?"":__t)+'" title="'+(null==(__t=site.name)?"":__t),site.isVip&&(__p+=" VIP免广告"),__p+='" static="bl=epi&blname=剧集&stp=site&site='+(null==(__t=site.site)?"":__t)+'" style="background-image:url('+(null==(__t=site.logo)?"":__t)+')">'+(null==(__t=site.name)?"":__t)+"</a>\n		",l-1>i&&(__p+="<b>&gt;</b>"),__p+="\n		";if(__p+="\n		",len>5){__p+='\n		<span class="j-more">\n			<a href="#" class="more">更多</a>\n\n			<ul class="episodes-site-more j-more-list">\n			';for(var i=5,l=len;l>i;i++)site=sites[i],__p+='\n				<li>\n					<a href="#" data-site="'+(null==(__t=site.site)?"":__t)+'" class="site',site.site==curSite.site&&(__p+=" current"),__p+='" title="'+(null==(__t=site.name)?"":__t),site.isVip&&(__p+=" VIP免广告"),__p+='" static="bl=epi&blname=剧集&stp=site&site='+(null==(__t=site.site)?"":__t)+'" style="background-image:url('+(null==(__t=site.logo)?"":__t)+')">'+(null==(__t=site.name)?"":__t)+"</a>\n				</li>\n			";__p+="\n			</ul>\n		</span>\n		"}__p+="\n		",hasPaysite&&(__p+='\n		<b class="paysite">(付费观看)</b>\n		'),__p+="\n	</div>\n"}__p+="\n"}__p+=""}return __p},cursite:_.template("<%=name%>")},Episode=require("detail:widget/episode/episode.js"),TVShowEpisode={};Episode.setRoot(TVShowEpisode),_.extend(TVShowEpisode,Episode),_.extend(TVShowEpisode.Config,{show:{dtype:"tvshow",hasYear:!0,episodeMax:10,pageBaseNumber:40,episodeLarge:!0,unit:"期",apiPath:"/show_intro/",apiPathHao:"/zongyi_intro/",urlPrefix:"/kan/tvshow/?",hostUrl:"v.baidu.com/show_intro/",hostUrlHao:"v.hao123.com/zongyi_intro/",fieldsAdapter:function(e){e=_.defaults(e,this.fields);var t,s=e.episode.replace(/(\d{4})(\d{2})(\d{2})/,"$1-$2-$3期"),i=parseInt(e.is_play,10),n=e.single_title,o=e.thumbnail_16_9||e.thumbnail,a=e.guest;-1===o.indexOf("baidu.com/")&&(o=e.thumbnail),t=TVShowEpisode.getPlayUrl(i,e.site_url,e.episode,e.url);var l={text:(i?"":"暂无")+n,title:(i?"观看 ":"搜一下 ")+n,to:i?"play":"search",url:t,date:s,site_url:e.site_url,thumbnail:o,gif_thumbnail:e.gif_thumbnail,guest:a,limit:2,episode:e.episode,lastEpisode:TVShowEpisode.options.lastEpisode===e.episode,record:"T"+TVShowEpisode.options.id};return 12661===+TVShowEpisode.options.id&&+e.episode<20150815&&(l.is_per=1),l}}}),_.extend(TVShowEpisode.Views,{Header:Backbone.View.extend({el:"#episode-header",tpl:"year",events:{"mouseover .j-more":"onMouseoverDropdown","mouseleave .j-more":"onMouseleaveDropdown","click .site-list .site":"onClickSite","click .episode-years-list li a":"onClickYear","click .episode-month-wrap a":"onClickMonth"},render:function(){this.initedHeader||(this.renderYearList(this.yearInfo),this.renderSiteList(TVShowEpisode.siteCollection.filterByYear(this.curYear)),this.initedHeader=!0)},renderYearList:function(e){var t=template[this.tpl]({years:e});this.$el.find(".episode-years").html(t)},renderSiteList:function(e){var t=this,s=_.find(e,function(e){return e.site===t.curSite})||e[0],i=template.sites({sites:e,opt:TVShowEpisode.options,curSite:s,hasPaysite:!1});this.$el.find(".episode-site-wrap").html(i),e.length>1?this.$el.find(".episode-current-site-wrap").removeClass("hide").find(".site").css("background-image","url("+s.logo+")").html(s.name):this.$el.find(".episode-current-site-wrap").addClass("hide")},initialize:function(){this.curSite="",this.curYear="",this.yearInfo=null,TVShowEpisode.dataCollection.on("data.loaded",_.bind(this.dataLoaded,this)),TVShowEpisode.episodesView.collection.on("reset",_.bind(this.renderMonths,this))},dataLoaded:function(e){var t=[],s=TVShowEpisode.siteCollection;!this.yearInfo&&s.length&&(s.each(function(e){t=_.union(t,e.get("years"))}),this.yearInfo=t.sort(function(e,t){return+t-e}),TVShowEpisode.options.isBrand&&TVShowEpisode.options.filterSite?(this.curSite=TVShowEpisode.options.filterSite,this.curYear=s.get(this.curSite).get("years")[0]):this.curYear=this.yearInfo[0]),this.render(e)},renderMonths:function(){var e=TVShowEpisode.episodesView.collection.getAllMonth();if(e){var t=this.$el.find(".episode-month-wrap");t.html(template.months({months:e}))}},_timer:null,onMouseoverDropdown:function(e){clearTimeout(this._timer);var t=$(e.currentTarget);t.find(".j-more-list").show()},onMouseleaveDropdown:function(e){var t=$(e.currentTarget);this._timer=setTimeout(function(){t.find(".j-more-list").hide()},100)},onClickSite:function(e){e.preventDefault();var t=$(e.currentTarget),s=t.data("site");s&&(t.parents(".site-list").find(".current").removeClass("current"),t.addClass("current"),this.curSite=s,t.hasClass("j-isload")?t.removeClass("j-isload"):TVShowEpisode.queryModel.set({site:this.curSite,year:this.curYear}),s=TVShowEpisode.siteCollection.get(this.curSite).toJSON(),this.$el.find(".episode-current-site-wrap .site").css("background-image","url("+s.logo+")").html(template.cursite(s)))},onClickYear:function(e){e.preventDefault();var t=$(e.currentTarget);if(!t.hasClass("current")){t.parents(".episode-years-list").find("a").removeClass("current"),t.addClass("current"),this.curYear=t.data("year");var s=TVShowEpisode.siteCollection.filterByYear(this.curYear);this.curSite=s[0].site,this.renderSiteList(s),t.hasClass("j-isload")?t.removeClass("j-isload"):TVShowEpisode.queryModel.set({site:this.curSite,year:this.curYear})}t.parents("ul").trigger("mouseleave")},onClickFolder:function(){$(".episode-show-episodes .show-episodes-list").toggleClass("episode-fold")},onClickMonth:function(e){e.preventDefault();var t=$(e.currentTarget),s=t.data("month");t.addClass("current").siblings().removeClass("current"),TVShowEpisode.episodesView.trigger("monthChange",s)}}),Episodes:Backbone.View.extend({el:"#episode-episodes",tpl:"episode",loadingTpl:"loading",posterEl:"#poster .poster-a",initialize:function(){this.template=template[this.tpl],this.tipTemplate=TVShowEpisode.getTempalte(this.loadingTpl),this.collection=new TVShowEpisode.Collections.Episodes,this.collection.on("reset",_.bind(this.collectionReset,this)),this.on("showLoader",_.bind(this.showLoader,this)),this.on("monthChange",_.bind(this.onMonthChange,this)),TVShowEpisode.focusCollection.on("focus.loaded",_.bind(this.onFocusLoad,this)),this.trigger("showLoader"),this.bindMonthEvents()},events:{"click .episode-unfold a":"onToggleFold"},showLoader:function(){var e=this.tipTemplate();this.$el.hide().html(e).show()},unfold:function(){this.render({start:0,end:TVShowEpisode.options.pageBaseNumber})},render:function(e){e||(e={});var t,s=this.$el,i=TVShowEpisode.options,n=e.start||0,o=this.collection.length,a=this.collection.getByMonth(e.month);t=this.template({episodes:a,start:n,total:o,unit:i.unit,titlelen:26,fold:e.fold&&a.length===i.pageBaseNumber&&i.pageBaseNumber>=100,filterSite:i.filterSite,pro:i.pro,frSite:i.frSite}),s.hide().html(t).fadeIn()},collectionReset:function(){var e,t,s=this.collection,i=$(this.posterEl);s.length?(e=s.at(0),t=e.get("url"),i.attr("href",t+"&bl=hb"),i.attr("static","bl=spa"+encodeURIComponent("简介")+"&site="+e.get("site_url")),TVShowEpisode.focusCollection.load({episode:e.get("episode"),site:e.get("site_url")}),$("#hao123-adv-txt").attr("href",t)):$("#j-newest-list").html("暂无站点数据"),this.unfold()},onMonthChange:function(e){this.render({start:0,month:e})},onToggleFold:function(e){e.preventDefault();var t,s=$(e.currentTarget),i=this.$el.find(".show-episodes-list"),n="";"收起"===s.text()?(s.removeClass("unfold"),i.addClass("episode-fold")):(s.addClass("unfold"),i.removeClass("episode-fold"),(t=i.find("textarea")).length&&(i.append(t.text()),t.remove())),n=s.text(),s.html(s.data("toggle")+"<i></i>").data("toggle",n)},onFocusLoad:function(e){var t=this.collection.slice(0,4);$("#j-newest-list").html(template.newest({episodes:t,len:$(".intro .intro-adv:visible").length?Math.max(t.length-1,1):t.length,focus:e,frSite:TVShowEpisode.options.frSite,title:TVShowEpisode.options.title,isBrand:TVShowEpisode.options.isBrand,timeHelper:this.timeHelper}));var s;$("#j-newest-list").off("mouseenter.showepisode").off("mouseleave.showepisode").on("mouseenter.showepisode",".view-box",function(e){clearTimeout(s);var t=$(e.currentTarget),i=t.find("img"),n=i.data("gif");n&&!+i.data("gif-showed")&&(s=setTimeout(function(){var e=new Image;e.onload=function(){i.data("ori",i.attr("src")).attr("src",n).data("gif-showed",1),t.parent().siblings().each(function(){var e=$(this).find("img");e.attr("src",e.data("ori")).data("gif-showed",0)}),e=null},e.src=n},100))}).on("mouseleave.showepisode",".view-box",function(e){clearTimeout(s);{var t=$(e.currentTarget).find("img");t.data("gif")}+!t.data("gif-showed")||(s=setTimeout(function(){t.attr("src",t.data("ori")).data("gif-showed",0)},100))})},timeHelper:function(e){var t=Math.floor(e/60),s=Math.floor(e%60);return(10>t?"0"+t:t)+":"+(10>s?"0"+s:s)},monthEpisodeHelper:function(e){return this.collection.getByMonth(e).length},bindMonthEvents:function(){$("#j-newest-list").on("click",".nav-list a",_.bind(this.headerMonthSwitch,this))},headerMonthSwitch:function(e){e.preventDefault();var t=$(e.currentTarget),s=t.data("month");$(".j-nav-wrap a[href=#episode]").trigger("click"),setTimeout(function(){TVShowEpisode.headerView.$el.find(".episode-month-wrap a[data-month="+s+"]").trigger("click")},300)}})}),module.exports=function(e){$("#playButtons").removeClass("invisible"),TVShowEpisode.init.call(TVShowEpisode,e)},module.exports.episode=TVShowEpisode});
;define("detail:widget/episode/tv.js",function(e,t,i){var o=e("common:static/vendor/underscore/underscore.js"),s=e("common:static/vendor/backbone/backbone.js"),n=e("detail:widget/episode/episode.js"),a={};n.setRoot(a),o.extend(a,n),o.extend(a.Config,{comic:{dtype:"comic",pageBaseNumber:100,unit:"集",apiPath:"/comic_intro/",apiPathHao:"/dongman_intro/",urlPrefix:"/kan/comic/?",hostUrl:"v.baidu.com/comic_intro/",hostUrlHao:"v.hao123.com/dongman_intro/",fieldsAdapter:function(e){e=o.defaults(e,this.fields);var t=parseInt(e.is_play,10),i=a.getPlayUrl(t,e.site_url,e.episode,e.url),s={text:t?e.episode:"暂无 ",title:(t?"观看 ":"搜一下 ")+"第"+e.episode+"集",to:t?"play":"search",episode:e.episode,url:i,site_url:e.site_url,thumbnail:e.thumbnail,lastEpisode:this.isLastEpisode(e.episode),record:"C"+a.options.id};return s}},tv:{dtype:"tv",pageBaseNumber:100,unit:"集",apiPath:"/tv_intro/",apiPathHao:"/dianshi_intro/",urlPrefix:"/kan/tvplay/?",hostUrl:"v.baidu.com/tv_intro/",hostUrlHao:"v.hao123.com/dianshi_intro/",fieldsAdapter:function(e){e=o.defaults(e,this.fields);var t=parseInt(e.is_play,10),i=a.getPlayUrl(t,e.site_url,e.episode,e.url),s={text:t?e.episode:"暂无 ",title:(t?"观看 ":"搜一下 ")+"第"+e.episode+"集",to:t?"play":"search",episode:e.episode,url:i,site_url:e.site_url,thumbnail:e.thumbnail_16_9||e.thumbnail,lastEpisode:this.isLastEpisode(e.episode),record:"TV"+a.options.id,isPay:!!+e.obj_is_pay};return"预告片"===e.category&&(s.text=e.episode,s.title="观看第"+e.episode+"集预告片",s.url=e.link&&e.link.indexOf("?")>-1?e.link:e.link+"?",s.lastEpisode=!1,s.isPer=!0,s.site_url=e.site),s}}}),o.extend(a.Views,{Header:s.View.extend({el:"#episode-header",tpl:"pagination",events:{"mouseover .episodes-dropdown":"onMouseoverDropdown","mouseleave .episodes-dropdown":"onMouseleaveDropdown","mouseover .j-more":"onMouseoverMore","mouseleave .j-more":"onMouseleaveMore","click .site-list .site":"onClickSite","click .episode-paginations .episode-page":"onSetPage","click .episode-paginations-menu .episode-page":"onSetPageMenu"},render:function(e){var t=e.model;this.renderPage(t.get("episodes").length,!1),this.initedSite||(this.initedSite=!0,this.renderSite())},renderPage:function(e,t,i){var s=this.curSite;if(!s){var n=a.options.filterSite,r=a.siteCollection.toJSON(),l=o.find(r,function(e){return e.site===n})||r[0];s=l?l.site:""}var d=this.pageTempate({paginations:this.createPages(e,t),unit:a.options.unit,last:i,title:a.options.title,site:s,isBrand:a.options.isBrand});this.$el.find(".episode-paginations-wrap").html(d)},siteTimer:0,renderSite:function(){var e=a.siteCollection,t=this;this.curSite=a.options.filterSite;var i=e.toJSON(),s=o.find(i,function(e){return e.site===t.curSite})||i[0];this.curSite&&s&&s.site===this.curSite?$("#video-brand").text(s.name+"全网首播").show():$("#video-brand").hide();var n=a.getTempalte("sites")({sites:e.toJSON(),opt:a.options,curSite:s,hasPaysite:a.options.hasPaysite});this.$el.find(".episode-site-wrap").html(n)},initialize:function(){this.pageTempate=a.getTempalte(this.tpl),a.dataCollection.on("data.loaded",o.bind(this.render,this))},createPages:function(e,t){var i=a.options.pageBaseNumber,s=[],n=!~a.options.sort;return t&&e>i&&(n?(s=o.range(e,0,-i),s=o.map(s,function(t){var o=e-t,s=Math.max(t-i,0),n={start:o+1,begin:t,end:s+1};return n})):(s=o.range(0,e,i),s=o.map(s,function(t){var o=t+1,s=Math.min(t+i,e),n={start:o,begin:o,end:s};return n}))),s},onClickSite:function(e){e.preventDefault();var t=$(e.currentTarget),i=t.data("site");if(i){t.parents(".site-list").find(".current").removeClass("current"),t.addClass("current"),this.curSite=i;var s=o.find(a.siteCollection.toJSON(),function(e){return e.site===i});t.parents(".site-list").find(".current-site-wrap a").attr("style","background-image:url("+s.logo+")").text(s.name),i&&a.queryModel.set({site:i})}},onSetPage:function(e){e.preventDefault();var t=$(e.currentTarget),i=t.data("start");a.episodesView.setPage(+i-1,!1,!0),t.parent().addClass("current").siblings().removeClass("current")},onMouseoverDropdown:function(e){var t=$(e.currentTarget);t.addClass("episodes-dropdown-active").find("li").show()},onMouseleaveDropdown:function(e){var t=$(e.currentTarget);t.removeClass("episodes-dropdown-active").find("li").not(".current").hide()},onSetPageMenu:function(e){e.preventDefault();var t=$(e.currentTarget),i=t.data("start");a.episodesView.setPage(+i-1,!1,!0),t.parent().addClass("current").siblings().removeClass("current"),t.parent().parent().trigger("mouseleave")},siteHoverTimer:null,onMouseoverMore:function(e){clearTimeout(this.siteHoverTimer);var t=$(e.currentTarget);t.find(".j-more-list").show()},onMouseleaveMore:function(e){var t=$(e.currentTarget);this.siteHoverTimer=setTimeout(function(){t.find(".j-more-list").hide()},100)}}),Episodes:s.View.extend({el:"#episode-episodes",tpl:"episodes",loadingTpl:"loading",events:{"click .fold":"onFold","click .unfold":"onUnfold","click .episode-qxk a":"clickQxk"},posterEl:"#poster .poster-a",btnPlay:"#j-play-btn",newlistEl:"#j-newest-list",initialize:function(){this.template=a.getTempalte(this.tpl),this.tipTemplate=a.getTempalte(this.loadingTpl),this.collection=new a.Collections.Episodes,this.collection.on("reset",o.bind(this.collectionReset,this)),this.on("showLoader",o.bind(this.showLoader,this)),this.trigger("showLoader"),this.on("updateRecord",o.bind(this.onUpdateRecord,this)),"hao123"===a.options.frSite&&this.once("initQxk",o.bind(this.initQxk,this))},showLoader:function(){var e=this.tipTemplate();this.$el.hide().html(e).show()},onFold:function(e){e.preventDefault(),this.setPage(0,!0),a.headerView.renderPage(this.collection.length,!1)},onUnfold:function(e){e.preventDefault();var t=this.collection.length,i=a.options,o=i.finish,s=o||!~i.sort?0:Math.max(Math.ceil(t/i.pageBaseNumber)-1,0)*i.pageBaseNumber;this.setPage(s,!1,!0),a.headerView.renderPage(this.collection.length,!0,!(o||!~i.sort))},setPage:function(e,t,i){this.render({end:t?void 0:a.options.pageBaseNumber+e,start:e,cancelPage:!0,showFold:i,fold:t})},renderPrevue:function(){$("#episode-header").hide();var e=$("#j-tvprevue-wrap").val();this.$el.html(e||"暂无站点数据")},render:function(e){e||(e={});var t,i=this.$el,o=a.options,s=e.start||0,r=this.collection.length,l=Math.min(e.end||r,r),d=this.collection.models,p=l-s;t=this.template({episodes:d,start:s,max:l,len:p,total:r,unit:o.unit,showFold:e.showFold,pageBaseNumber:o.pageBaseNumber,fold:e.fold&&(p>=o.pageBaseNumber/2||r>o.pageBaseNumber),filterSite:o.filterSite,pro:o.pro,frSite:o.frSite,finish:o.finish,type:o.type}),i.hide().html(t).fadeIn(),this.trigger("updateRecord",n.userRecord),this.trigger("initQxk")},collectionReset:function(){var e,t,i=this.collection,o=$(this.posterEl),s=($(this.btnPlay),i.length);s?(this.setPage(0,!0),o.length&&(e=i.at(0),t=e.get("url"),o.attr("href",t+"&bl=hb"),o.attr("static","bl=spa"+encodeURIComponent("简介")+"&site="+e.get("site_url"))),a.options.filterSite&&!this._brandUrlSeted&&(this._brandUrlSeted=!0,$("#video-brand").attr("href",t).attr("static",$("#video-brand").attr("static")+"&pro="+a.options.pro).show()),$("#hao123-adv-txt").attr("href",t),i.at(s-3)&&i.at(s-3).toJSON().isPer&&s--,i.at(s-2)&&i.at(s-2).toJSON().isPer&&s--,i.at(s-1)&&i.at(s-1).toJSON().isPer&&s--,$(".update-info .newest").text(s)):this.renderPrevue()},onUpdateRecord:function(e){if(e){var t=".episode-episode",i=this.$el.find(t+"[data-episode="+e+"]");if(i.length){var o=n.getTempalte("episodetip"),s=$(o({record:e}));i.prevAll().length<12?s.addClass("episode-tip-down"):i.position().left>.6*i.parent().width()&&s.addClass("episode-tip-right"),i.append(s),i.css("z-index",2),setTimeout(function(){s.remove()},6e3)}}},initQxk:function(){var t=e("detail:static/hao123/tvepisode/tvepisode.js");t.firstSee.call(this,a.options.title,a.options.lastEpisode)},clickQxk:function(t){var i=this,o=$(t.currentTarget),s=i._prePlayUrl||o.prop("href");t.preventDefault(),e("detail:static/hao123/utils/utils.js").callBrowser(s,i.hasYugao,"tpl=tvplay_detail_hao123&tn=tvplay_detail_hao123&bl=btn&stp=speed&ext=callback","tpl=tvplay_detail_hao123&tn=tvplay_detail_hao123&bl=btn&stp=speed&ext=download")}})}),i.exports=function(e){$("#playButtons").removeClass("invisible"),a.init.call(a,e)}});
;define("detail:widget/episodeSA/episode.js",function(require,exports,module){var Root,T=$,_=require("common:static/vendor/underscore/underscore.js"),Backbone=require("common:static/vendor/backbone/backbone.js"),vipConfig=require("common:static/ui/vipConfig/vipConfig.js"),vipInfo=require("common:static/ui/vipInfo/vipInfo.js"),templates=(require("common:static/ui/eventcenter/eventcenter.js"),require("common:static/ui/client/client.js"),{episodes:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="";var episode;if(__p+="\n",len&&len>0){__p+='\n	<ul class="episode-episodes-list clearfix">\n		';for(var i=start;max>i;i++)__p+="\n			",!fold||fold&&(42>i||i>max-5)?(__p+="\n				",episode=episodes[i].toJSON(),__p+='\n				<li class="episode-episode" data-episode="'+(null==(__t=episode.episode)?"":__t)+'">\n					<a target="_blank" class="episode-episode-card" href="'+(null==(__t=episode.url)?"":__t)+'&bl=jp_video" title="'+(null==(__t=episode.title)?"":_.escape(__t))+'" static="stp=video&site='+(null==(__t=episode.site_url)?"":__t)+"&n="+(null==(__t=episode.episode)?"":__t)+'">'+(null==(__t=episode.text)?"":_.escape(__t)),episode.lastEpisode&&(__p+='<span class="episode-episode-last"></span>'),__p+="</a>\n				</li>\n			"):fold&&42==i&&(__p+="\n				",i=max-5,__p+='\n				<li class="episode-episode unfold" data-start="'+(null==(__t=start)?"":__t)+'" static="stp=unfold">\n					<a class="episode-episode-card" href="#" title="展开全部'+(null==(__t=total)?"":__t)+'集">......</a>\n				</li>\n			'),__p+="\n			",total>=len&&i==max-1&&(__p+="\n				",!fold&&(len>=pageBaseNumber||showFold)&&(__p+='\n				<li class="episode-episode fold" static="stp=fold">\n					<a class="episode-episode-card" href="#" title="收起">收起</a>\n				</li>\n				'),__p+="\n			"),__p+="\n		";__p+="\n	</ul>\n"}else __p+='\n	<p class="episode-sites-none">暂无站点数据</p>\n';__p+=""}return __p},loading:function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<p class="episode-loader">努力地加载中...</p>';return __p},pagination:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){if(__p+="",paginations.length){__p+="\n	";var idx=0;last&&(idx=paginations.length-1),__p+="\n	",paginations.length>3?(__p+='\n		<ul class="episodes-dropdown episode-paginations-menu clearfix">\n			',_.each(paginations,function(e,t){__p+='\n				<li class="episode-page-item',t==idx&&(__p+=" current"),__p+='">\n					<a href="#" class="episode-page clearfix" data-start="'+(null==(__t=e.start)?"":__t)+'" title="'+(null==(__t=e.begin)?"":__t)+"-"+(null==(__t=e.end)?"":__t)+(null==(__t=unit)?"":__t)+'"><b></b>'+(null==(__t=e.begin)?"":__t)+"-"+(null==(__t=e.end)?"":__t)+"\n					</a>\n				</li>\n			"}),__p+="\n		</ul>\n	"):(__p+='\n		<ul class="episode-paginations clearfix">\n			',_.each(paginations,function(e,t){__p+='\n				<li class="episode-page-item',t==idx&&(__p+=" current"),__p+='">\n					<a href="#" class="episode-page" data-start="'+(null==(__t=e.start)?"":__t)+'" title="'+(null==(__t=e.begin)?"":__t)+"-"+(null==(__t=e.end)?"":__t)+(null==(__t=unit)?"":__t)+'">'+(null==(__t=e.begin)?"":__t)+"-"+(null==(__t=e.end)?"":__t)+"</a>\n				</li>\n			"}),__p+="\n		</ul>\n	"),__p+="\n"}else __p+="\n<h6>全部剧集</h6>\n";__p+=""}return __p},sites:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){if(__p+="",sites.length){var site,len=sites.length;if(__p+="\n",opt.isBrand&&curSite.site==opt.filterSite){__p+='\n	<div class="site-list">\n		<span class="site-brand">\n			<span class="site" style="background-image:url('+(null==(__t=curSite.logo)?"":__t)+')">'+(null==(__t=curSite.name)?"":__t)+'全网首播</span>\n		</span>\n		<span class="j-more">\n			<a href="#" class="more">更多</a>\n			<ul class="episodes-site-more j-more-list">\n			';for(var i=0,l=len;l>i;i++)site=sites[i],__p+='\n				<li>\n					<a href="#" data-site="'+(null==(__t=site.site)?"":__t)+'" class="site',site.site==curSite.site&&(__p+=" current"),__p+='" title="'+(null==(__t=site.name)?"":__t),site.isVip&&(__p+=" VIP免广告"),__p+='" static="bl=epi&blname=剧集&stp=site&site='+(null==(__t=site.site)?"":__t)+'" style="background-image:url('+(null==(__t=site.logo)?"":__t)+')">'+(null==(__t=site.name)?"":__t)+"</a>\n				</li>\n			";__p+="\n			</ul>\n		</span>\n	</div>\n"}else{__p+='\n	<div class="site-list">\n		<span>智能排序：</span>\n		';for(var i=0,l=Math.min(5,len);l>i;i++)site=sites[i],__p+='\n		<a href="#" class="site',site.site==curSite.site&&(__p+=" current"),__p+='" data-site="'+(null==(__t=site.site)?"":__t)+'" title="'+(null==(__t=site.name)?"":__t),site.isVip&&(__p+=" VIP免广告"),__p+='" static="bl=epi&blname=剧集&stp=site&site='+(null==(__t=site.site)?"":__t)+'" style="background-image:url('+(null==(__t=site.logo)?"":__t)+')">'+(null==(__t=site.name)?"":__t)+"</a>\n		",l-1>i&&(__p+="<b>&gt;</b>"),__p+="\n		";if(__p+="\n		",len>5){__p+='\n		<span class="j-more">\n			<a href="#" class="more">更多</a>\n			<ul class="episodes-site-more j-more-list">\n			';for(var i=5,l=len;l>i;i++)site=sites[i],__p+='\n				<li>\n					<a href="#" data-site="'+(null==(__t=site.site)?"":__t)+'" class="site',site.site==curSite.site&&(__p+=" current"),__p+='" title="'+(null==(__t=site.name)?"":__t),site.isVip&&(__p+=" VIP免广告"),__p+='" static="bl=epi&blname=剧集&stp=site&site='+(null==(__t=site.site)?"":__t)+'" style="background-image:url('+(null==(__t=site.logo)?"":__t)+')">'+(null==(__t=site.name)?"":__t)+"</a>\n				</li>\n			";__p+="\n			</ul>\n		</span>\n		"}__p+="\n	</div>\n"}__p+="\n"}__p+=""}return __p},newest:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="";var itm;__p+="\n";for(var i=0,l=data.length;l>i;i++)__p+="\n	",itm=data[i].toJSON(),__p+='\n	<a href="'+(null==(__t=itm.url)?"":__t)+'&bl=new_epi" class="episode-newest ',__p+=itm.thumbnail?"episode-newest-img":"episode-newest-text",__p+='" title="'+(null==(__t=itm.title)?"":__t)+'" target="_blank" static="site='+(null==(__t=itm.site_url)?"":__t)+'">\n		',__p+=itm.thumbnail?'\n		    <img src="'+(null==(__t=itm.thumbnail)?"":__t)+'" alt="'+(null==(__t=itm.title)?"":__t)+"\" onerror=\"$(this).parent().addClass('episode-newest-text').removeClass('episode-newest-img').end().remove();\"><b></b>\n		    <p>第"+(null==(__t=itm.episode)?"":__t)+'集</p>\n		    <span class="s-play"></span>\n		':"\n			第"+(null==(__t=itm.episode)?"":__t)+"集<b></b>\n		",__p+="\n	</a>\n";__p+=""}return __p},episodetip:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<div class="episode-tip">\n	<p>观看到'+(null==(__t=record)?"":__t)+'集</p>\n	<span class="arrow"><em>◆</em><i>◆</i></span>\n</div>';return __p}}),Episode={setRoot:function(e){Root=e||this},Models:{},Collections:{},Views:{},Config:{}};Episode.setRoot(),_.extend(Episode,{options:{type:"",frpBrowse:!1,apiUrl:"",urlPrefix:"",finish:0,lastEpisode:"",pageBaseNumber:50,fields:{single_title:"",url:"",episode:"",is_play:"",site_order:"",site_url:""},fieldsAdapter:function(){},isLastEpisode:function(e){return!parseInt(this.finish)&&e&&+e+1>=this.lastEpisode}}}),_.extend(Episode,{queryModel:null,dataCollection:null,siteCollection:null,init:function(e){var t=this,i=e.type,s={site:e.filterSite,site:""};this.options=_.extend(this.options,this.Config[i],e),this.initApiUrl(),this.queryModel=new Backbone.Model,this.dataCollection=new t.Collections.data,this.siteCollection=new t.Collections.site,this.focusCollection=new t.Collections.focus,this.queryModel.on("change",_.bind(this.queryChange,t)),this.dataCollection.on("data.loaded",_.bind(this.dataLoaded,this)),this.initViews(),this.queryModel.set(s)},initApiUrl:function(){var e=this.options,t=e.frpBrowse?"&frp=browse":"";e.apiUrl=e.apiPath+"?callback=?&dtype="+e.dtype+"PlayUrl&e=1&service=json&id="+e.id+t},initViews:function(){var e=this.Views;this.episodesView=new e.episodes,this.headerView=new e.header},dataLoaded:function(e){{var t=e.model.get("episodes");this.options}~this.options.sort||(t=t.sort(function(e,t){return t.episode-e.episode})),this.episodesView.collection.reset(t)},queryChange:function(e){var t=e.toJSON();this.episodesView.trigger("showLoader"),this._cacheQuery=e,this.dataCollection.load(t)},getTempalte:function(e){return templates[e]},getPlayUrl:function(e,t,i,s){var n,o=this.options,l=(o.urlPrefix,o.id,o.frpBrowse?"browse":""),_=o.isBrand&&o.filterSite==t?"&vfm=bdvppzq":o.frpBrowse?"&vfm=bdvcsplld":"&vfm=bdvtx";return n=s+(s.indexOf("?")>-1?"&":"?")+"page="+o.pagetn+_+"&frp="+encodeURIComponent(o.hostUrl+l)},initedPlayRecord:!1,initingPlayRecord:!1,initPlayRecord:function(){if(this.initedPlayRecord)return this.trigger("record");if(!this.initingPlayRecord){this.initingPlayRecord=!0;var e=this.options,t={tv:"TV",comic:"C",tvshow:"T"},i=t[e.type]+e.id,s=this;if(!window.bdvRecordAPI)return void setTimeout(function(){s.initPlayRecord()},2e3);s.on("record",_.bind(s.onRecord,s)),window.bdvRecordAPI.get(function(e){var t=e[i]||0;s.trigger("record",t),s.initedPlayRecord=!0})}},userRecord:0,onRecord:function(e){e&&(this.userRecord=e),this.episodesView.trigger("updateRecord",this.userRecord)}}),_.extend(Episode,Backbone.Events),_.extend(Episode.Models,{cache:Backbone.Model.extend({defaults:{id:"",episodes:[]}}),episodes:Backbone.Model.extend({defaults:{to:"play",url:"",title:"",text:""}}),site:Backbone.Model.extend({defaults:{id:"",site:"",name:"",logo:"",isVip:!1,order:99,years:[]}}),focus:Backbone.Model.extend({defaults:{id:"",timeaxis:[]}})}),_.extend(Episode.Collections,{data:Backbone.Collection.extend({model:Root.Models.cache,params:function(e){var t=[];return _.each(e,function(e,i){t.push(i+"="+e)}),t.join("&")},load:function(e){var t,i=this,s=e.year||"",n=e.site+s,o=n?i.get(n):i.at(0);Episode.options.isBrand&&e.site==Episode.options.filterSite&&(i.brandSiteLoaded=!0),o&&("nosite"==o.id||o.get("episodes").length)?i.trigger("data.loaded",{model:o}):(t=Root.options.apiUrl+"&"+i.params(e),T.getJSON(t,function(e){_.each(e,function(e){e.site_info.id=e.site_info.site,e.years&&(e.site_info.years=e.years.sort(function(e,t){return t-e})),Root.siteCollection.add(e.site_info)}),e.length?_.each(e,function(e){e.episodes&&e.episodes.length&&i.add({id:e.site_info.site+s,episodes:e.episodes})}):i.add({id:"nosite",episodes:[]}),Root.siteCollection.vipCheck(function(){return n=n||Root.siteCollection.getFirstSite()+s||"nosite",o=i.get(n),!o||"nosite"!=o.id&&!o.get("episodes").length?Root.queryModel.set({site:n}):(Episode.options.isBrand&&!i.brandSiteLoaded?i.load({site:Episode.options.filterSite}):i.trigger("data.loaded",{model:o}),void Root.initPlayRecord())})}))}}),episodes:Backbone.Collection.extend({initialize:function(){var e=this;this.on("reset",function(){e._monthsCache=null,e._episodeByMonth={}})},model:function(e){var t=Root.options.fieldsAdapter(e);return new Root.Models.episodes(t)},getByMonth:function(e){return e?this._episodeByMonth[e]?this._episodeByMonth[e]:this._episodeByMonth[e]=this.filter(function(t){return 0==t.get("episode").substr(4).indexOf(e)}):this.models},getAllMonth:function(){var e,t=[],i=/^(20\d{2,2})\-?([01]\d)\-?([0123]\d)$/;return this._monthsCache?this._monthsCache:(this.each(function(s){var n=s.get("episode"),o=n.match(i);o&&o.length&&e!=o[2]&&t.push(e=o[2])}),this._monthsCache=t.sort(function(e,t){return t-e}))}}),site:Backbone.Collection.extend({model:Root.Models.site,filterByYear:function(e){return e=""+e,_.sortBy(_.filter(this.toJSON(),function(t){return~_.indexOf(t.years,e)}),function(e){var t=e.isVip,i=e.order;return~~(t&&i)||i})},vipCheck:function(e){var t=this;return this.vipChecked||vipConfig.filterWork(Root.options.type,Root.options.id)?(this.vipChecked=!0,e&&e()):void vipInfo.get(function(i){var s=i&&i.isvip&&i.isvalid,n=vipConfig.sites;return s?(t.each(function(e){var t,i=e.get("site");n[i]&&(e.set("isVip",!0),t=_.indexOf(n.order,i),~t&&e.set("order",t),e.set("logo",vipConfig.vipSiteLogo))}),"show"!=Root.options.type&&(t.models=t.sortBy(function(e){var t=e.get("isVip"),i=e.get("order");return~~(t&&i)||i})),t.vipChecked=!0,void(e&&e())):(t.vipChecked=!0,e&&e())})},getFirstSite:function(){if("show"!=Root.options.type)return this.at(0)&&this.at(0).get("site")||"";var e=[];return this.each(function(t){e=_.union(e,t.get("years"))}),e.sort(function(e,t){return+t-e}),this.filterByYear(e[0])[0].site||""}}),focus:Backbone.Collection.extend({model:Root.Models.focus,url:function(e){return"/show_intro/?dtype=kandian&callback=?&service=json&id="+Root.options.id+"&site="+e.site+"&episode="+e.episode},load:function(e){var t=this.get(e.site+e.episode),i=this;return t?this.trigger("focus.loaded",t.toJSON()):void $.getJSON(this.url(e)).done(function(t){var s=t&&t.length?t[0]:null;s&&s.episode==e.episode?(s.id=e.site+s.episode,i.add(s)):s=null,i.trigger("focus.loaded",s)}).fail(function(){i.trigger("focus.loaded",null)})}})}),module.exports=Episode});
;define("detail:widget/episodeSA/show.js",function(require,exports,module){var _=require("common:static/vendor/underscore/underscore.js"),Backbone=require("common:static/vendor/backbone/backbone.js"),template={year:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){if(__p+="",years.length){var year;__p+='\n    <ul class="episode-years-list clearfix" static="bl=epi&blname=剧集&stp=year">\n        ';for(var i=0,l=Math.min(years.length,4);l>i;i++){if(year=years[i],__p+="\n        ",3==i){__p+='\n        <li class="more j-more">\n            <a href="#" class="more-btn">更多</a>\n            <ul class="episode-years-more j-more-list">\n                ';for(var j=3,k=years.length;k>j;j++)__p+='\n                <li><a href="#" data-year="'+(null==(__t=years[j])?"":__t)+'">'+(null==(__t=years[j])?"":__t)+"</a></li>\n                ";__p+="\n            </ul>\n        </li>\n        "}else __p+='\n        <li class="item">\n            <a href="#" class="clearfix ',0==i&&(__p+="current"),__p+='" data-year="'+(null==(__t=year)?"":__t)+'">\n                <b></b>\n                <span>'+(null==(__t=year)?"":__t)+'</span>\n            </a>\n        </li>\n        <li class="dash"> | </li>\n        ';__p+="\n        "}__p+="\n    </ul>\n"}__p+=""}return __p},episode:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){if(__p+="",episodes.length){__p+="\n	";var episode,len=episodes.length;__p+='\n	<ul class="show-episodes-list ',len>10&&(__p+="episode-fold"),__p+=' clearfix">\n		',_.each(episodes,function(e,t){__p+="\n            ",episode=e.toJSON(),__p+="\n            ",10==t&&(__p+="<textarea>"),__p+='\n            <li class="episode-episode" data-episode="'+(null==(__t=episode.episode)?"":__t)+'">\n                <a static="stp=video&site='+(null==(__t=episode.site_url)?"":__t)+"&n="+(null==(__t=episode.episode)?"":__t),filterSite==episode.site_url&&(__p+="&pro=1"),__p+='" target="_blank" class="view-box" href="'+(null==(__t=episode.url)?"":__t)+'&bl=jp_video" title="'+(null==(__t=episode.title)?"":_.escape(__t))+'">\n                    <span class="view">\n                        <img class="item-img" src="'+(null==(__t=episode.thumbnail)?"":__t)+'"/>\n                        <span class="info-bg"></span>\n                        <span class="info">'+(null==(__t=episode.date)?"":__t)+'</span>\n                        <span class="s-mask"></span>\n                        <span class="s-play"></span>\n                        ',episode.lastEpisode&&(__p+='\n                        <span class="s-new"></span>\n                        '),__p+='\n                    </span>\n                   <span class="title">'+(null==(__t=$.string.widthstr(episode.text,titlelen||11))?"":__t)+'</span>\n                </a>\n                <div class="gusets">\n                    <ul>\n                         <li class="label">嘉宾：</li>\n                         ',episode.guest.length?(__p+="\n                         ",_.each(episode.guest,function(e){__p+='\n<li static="stp=guest"><a target="_blank" href="http://v.baidu.com/v?word='+(null==(__t=e)?"":__t)+"&ie=utf-8&ct=301989888"+(null==(__t=window.searchStr)?"":__t)+'">'+(null==(__t=e)?"":__t)+"</a></li>\n                        "}),__p+="\n                        "):__p+="\n                        <li>暂无</li>\n                        ",__p+="\n                    </ul>\n                </div>\n            </li>\n            ",t>10&&t==len-1&&(__p+="</textarea>"),__p+="\n		"}),__p+="\n	</ul>\n    ",len>10&&(__p+='\n    <div class="episode-unfold">\n        <a href="#" data-toggle="收起">展开查看全部'+(null==(__t=len)?"":__t)+"期<i></i></a>\n    </div>\n    "),__p+="\n"}else __p+='\n	<p class="episode-sites-none">暂无站点数据</p>\n';__p+="\n"}return __p},months:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<a href="#" class="current">全部</a>\n',_.each(months,function(e){__p+='\n<a href="#" data-month="'+(null==(__t=e)?"":__t)+'">'+(null==(__t=e)?"":__t)+"月</a>\n"}),__p+="";return __p},newest:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="<h6>最新剧集</h6>\n";var episode,url,len=focus&&focus.timeaxis&&focus.timeaxis.length?1:len,hasLastEpisode=!1;__p+='\n<div class="episode-focus-wrap clearfix">\n    ';for(var i=0,l=len;l>i;i++)__p+="\n    ",episode=episodes[i].toJSON(),hasLastEpisode=hasLastEpisode||episode.lastEpisode,__p+='\n	<div class="new-item',i>0&&i==l-1&&(__p+=" new-item-last"),__p+="",i>0&&i==l-2&&(__p+=" new-item-last-two"),__p+='">\n		<a static="stp=video&site='+(null==(__t=episode.site_url)?"":__t)+"&n="+(null==(__t=episode.episode)?"":__t)+'" target="_blank" class="view-box" href="'+(null==(__t=episode.url)?"":__t)+'&bl=jp_video" title="'+(null==(__t=episode.title)?"":_.escape(__t))+'">\n            <span class="view">\n                <img class="item-img" src="'+(null==(__t=episode.thumbnail)?"":__t)+'"/>\n                <span class="info-bg"></span>\n                <span class="info">'+(null==(__t=episode.date)?"":__t)+'</span>\n                <span class="s-play"></span>\n                ',0==i&&(__p+='<span class="s-new"></span>'),__p+='\n            </span>\n           <span class="title">'+(null==(__t=$.string.widthstr(episode.text,28))?"":__t)+'</span>\n        </a>\n        <div class="gusets">\n            <ul>\n                 <li class="label">嘉宾：</li>\n                 ',episode.guest.length?(__p+="\n                 ",_.each(episode.guest,function(e){__p+='\n<li static="stp=guest"><a target="_blank" href="http://v.baidu.com/v?word='+(null==(__t=e)?"":__t)+"&ie=utf-8&ct=301989888"+(null==(__t=window.searchStr)?"":__t)+'">'+(null==(__t=e)?"":__t)+"</a></li>\n                "}),__p+="\n                "):__p+="\n                <li>暂无</li>\n                ",__p+="\n            </ul>\n        </div>\n        ",episode.focus&&episode.focus.length&&(__p+='\n        <span class="arrows">\n            <b>◆</b><i>◆</i>\n        </span>\n        '),__p+="\n	</div>\n    ";__p+="\n    ",hasLastEpisode&&(__p+='<span class="flag-new"></span>'),__p+="\n    ",focus&&focus.timeaxis&&focus.timeaxis.length&&(__p+="\n    ",episode=episodes[0].toJSON(),__p+='\n    <div class="focus">\n        <h6 class="title">本期看点</h6>\n        <ul class="list">\n        ',_.each(focus.timeaxis,function(e,t){return __p+="\n            ",t>=12?!1:(__p+="\n            ",t>1&&t%4==0&&(__p+='\n            </ul>\n            <ul class="list">\n            '),__p+="\n            ",url=e.url?e.url:episode.url+(e.time?"&share_sTime="+e.time:""),void(__p+='\n            <li>\n                <a static="bl=focus&site='+(null==(__t=episode.site_url)?"":__t)+'" href="'+(null==(__t=url)?"":__t)+'" title="'+(null==(__t=e.desc)?"":__t)+'" target="_blank"><span>'+(null==(__t=timeHelper(e.time))?"":__t)+"</span>"+(null==(__t=$.string.widthstr(e.desc,14))?"":__t)+"</a>\n            </li>\n        "))}),__p+="\n        </ul>\n    </div>\n    "),__p+="\n</div>\n"}return __p},sites:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){if(__p+="",sites.length){var site,len=sites.length;if(__p+="\n",opt.isBrand&&curSite.site==opt.filterSite){__p+='\n	<div class="site-list">\n		<span class="site-brand">\n			<span class="site" style="background-image:url('+(null==(__t=curSite.logo)?"":__t)+')">'+(null==(__t=curSite.name)?"":__t)+'全网首播</span>\n		</span>\n		<span class="j-more">\n			<a href="#" class="more">更多</a>\n			<ul class="episodes-site-more j-more-list">\n			';for(var i=0,l=len;l>i;i++)site=sites[i],__p+='\n				<li>\n					<a href="#" data-site="'+(null==(__t=site.site)?"":__t)+'" class="site',site.site==curSite.site&&(__p+=" current"),__p+='" title="'+(null==(__t=site.name)?"":__t),site.isVip&&(__p+=" VIP免广告"),__p+='" static="bl=epi&blname=剧集&stp=site&site='+(null==(__t=site.site)?"":__t)+'" style="background-image:url('+(null==(__t=site.logo)?"":__t)+')">'+(null==(__t=site.name)?"":__t)+"</a>\n				</li>\n			";__p+="\n			</ul>\n		</span>\n	</div>\n"}else{__p+='\n	<div class="site-list">\n		<span>智能排序：</span>\n		';for(var i=0,l=Math.min(5,len);l>i;i++)site=sites[i],__p+='\n		<a href="#" class="site',site.site==curSite.site&&(__p+=" current"),__p+='" data-site="'+(null==(__t=site.site)?"":__t)+'" title="'+(null==(__t=site.name)?"":__t),site.isVip&&(__p+=" VIP免广告"),__p+='" static="bl=epi&blname=剧集&stp=site&site='+(null==(__t=site.site)?"":__t)+'" style="background-image:url('+(null==(__t=site.logo)?"":__t)+')">'+(null==(__t=site.name)?"":__t)+"</a>\n		",l-1>i&&(__p+="<b>&gt;</b>"),__p+="\n		";if(__p+="\n		",len>5){__p+='\n		<span class="j-more">\n			<a href="#" class="more">更多</a>\n			<ul class="episodes-site-more j-more-list">\n			';for(var i=5,l=len;l>i;i++)site=sites[i],__p+='\n				<li>\n					<a href="#" data-site="'+(null==(__t=site.site)?"":__t)+'" class="site',site.site==curSite.site&&(__p+=" current"),__p+='" title="'+(null==(__t=site.name)?"":__t),site.isVip&&(__p+=" VIP免广告"),__p+='" static="bl=epi&blname=剧集&stp=site&site='+(null==(__t=site.site)?"":__t)+'" style="background-image:url('+(null==(__t=site.logo)?"":__t)+')">'+(null==(__t=site.name)?"":__t)+"</a>\n				</li>\n			";__p+="\n			</ul>\n		</span>\n		"}__p+="\n	</div>\n"}__p+="\n"}__p+=""}return __p},cursite:_.template("<%=name%>")},Episode=require("detail:widget/episodeSA/episode.js"),TVShowEpisode=new Object;Episode.setRoot(TVShowEpisode),_.extend(TVShowEpisode,Episode),_.extend(TVShowEpisode.Config,{show:{dtype:"tvshow",hasYear:!0,episodeMax:10,pageBaseNumber:40,episodeLarge:!0,unit:"期",apiPath:"/show_intro/",urlPrefix:"/kan/tvshow/?",hostUrl:"v.baidu.com/show_intro/",fieldsAdapter:function(e){e=_.defaults(e,this.fields);var t,i=e.episode.replace(/(\d{4})(\d{2})(\d{2})/,"$1-$2-$3期"),s=parseInt(e.is_play,10),n=e.single_title,l=e.thumbnail_16_9||e.thumbnail,o=e.guest;-1==l.indexOf("baidu.com/")&&(l=e.thumbnail),t="8446"==TVShowEpisode.options.id&&-1!=e.url.indexOf("sohu.com")?e.url:TVShowEpisode.getPlayUrl(s,e.site_url,e.episode,e.url);var a={text:(s?"":"暂无")+n,title:(s?"观看 ":"搜一下 ")+n,to:s?"play":"search",url:t,date:i,site_url:e.site_url,thumbnail:l,guest:o,limit:2,episode:e.episode,lastEpisode:TVShowEpisode.options.lastEpisode==e.episode};return a}}}),_.extend(TVShowEpisode.Views,{header:Backbone.View.extend({el:"#episode-header",tpl:"year",events:{"mouseover .j-more":"onMouseoverDropdown","mouseleave .j-more":"onMouseleaveDropdown","click .site-list .site":"onClickSite","click .episode-years-list li a":"onClickYear","click .episode-month-wrap a":"onClickMonth"},render:function(){this.initedHeader||(this.renderYearList(this.yearInfo),this.renderSiteList(TVShowEpisode.siteCollection.filterByYear(this.curYear)),this.initedHeader=!0)},renderYearList:function(e){var t=template[this.tpl]({years:e});this.$el.find(".episode-years").html(t)},renderSiteList:function(e){var t=this,i=_.find(e,function(e){return e.site==t.curSite})||e[0],s=template.sites({sites:e,opt:TVShowEpisode.options,curSite:i});this.$el.find(".episode-site-wrap").html(s),e.length>1?this.$el.find(".episode-current-site-wrap").removeClass("hide").find(".site").css("background-image","url("+i.logo+")").html(i.name):this.$el.find(".episode-current-site-wrap").addClass("hide")},initialize:function(){this.curSite="",this.curYear="",this.yearInfo=null,TVShowEpisode.dataCollection.on("data.loaded",_.bind(this.dataLoaded,this)),TVShowEpisode.episodesView.collection.on("reset",_.bind(this.renderMonths,this))},dataLoaded:function(e){var t=[],i=TVShowEpisode.siteCollection;!this.yearInfo&&i.length&&(i.each(function(e){t=_.union(t,e.get("years"))}),this.yearInfo=t.sort(function(e,t){return+t-e}),TVShowEpisode.options.isBrand&&TVShowEpisode.options.filterSite?(this.curSite=TVShowEpisode.options.filterSite,this.curYear=i.get(this.curSite).get("years")[0]):this.curYear=this.yearInfo[0]),this.render(e)},renderMonths:function(){var e=TVShowEpisode.episodesView.collection.getAllMonth();if(e){var t=this.$el.find(".episode-month-wrap");t.html(template.months({months:e}))}},_timer:null,onMouseoverDropdown:function(e){clearTimeout(this._timer);var t=$(e.currentTarget);t.find(".j-more-list").show()},onMouseleaveDropdown:function(e){var t=$(e.currentTarget);this._timer=setTimeout(function(){t.find(".j-more-list").hide()},100)},onClickSite:function(e){e.preventDefault();var t=$(e.currentTarget);this.curSite=t.data("site"),TVShowEpisode.queryModel.set({site:this.curSite,year:this.curYear});var i=TVShowEpisode.siteCollection.get(this.curSite).toJSON();this.$el.find(".episode-current-site-wrap .site").css("background-image","url("+i.logo+")").html(template.cursite(i))},onClickYear:function(e){e.preventDefault();var t=$(e.currentTarget);if(!t.hasClass("current")){t.parents(".episode-years-list").find("a").removeClass("current"),t.addClass("current"),this.curYear=t.data("year");var i=TVShowEpisode.siteCollection.filterByYear(this.curYear);this.curSite=i[0].site,this.renderSiteList(i),TVShowEpisode.queryModel.set({site:this.curSite,year:this.curYear})}t.parents("ul").trigger("mouseleave")},onClickFolder:function(){$(".episode-show-episodes .show-episodes-list").toggleClass("episode-fold")},onClickMonth:function(e){e.preventDefault();var t=$(e.currentTarget),i=t.data("month");t.addClass("current").siblings().removeClass("current"),TVShowEpisode.episodesView.trigger("monthChange",i)}}),episodes:Backbone.View.extend({el:"#episode-episodes",tpl:"episode",loadingTpl:"loading",posterEl:"#poster .poster-a",initialize:function(){this.template=template[this.tpl],this.tipTemplate=TVShowEpisode.getTempalte(this.loadingTpl),this.collection=new TVShowEpisode.Collections.episodes,this.collection.on("reset",_.bind(this.collectionReset,this)),this.on("showLoader",_.bind(this.showLoader,this)),this.on("monthChange",_.bind(this.onMonthChange,this)),TVShowEpisode.focusCollection.on("focus.loaded",_.bind(this.onFocusLoad,this)),this.trigger("showLoader"),this.bindMonthEvents()},events:{"click .episode-unfold a":"onToggleFold"},showLoader:function(){var e=this.tipTemplate();this.$el.hide().html(e).show()},unfold:function(){this.render({start:0,end:TVShowEpisode.options.pageBaseNumber})},render:function(e){e||(e={});var t,i=this.$el,s=TVShowEpisode.options,n=e.start||0,l=(e.end||s.episodeMax,this.collection.length),o=this.collection.getByMonth(e.month);t=this.template({episodes:o,start:n,total:l,unit:s.unit,titlelen:28,fold:e.fold&&o.length==s.pageBaseNumber&&s.pageBaseNumber>=100,filterSite:s.isPro&&s.filterSite}),i.hide().html(t).fadeIn()},collectionReset:function(){var e,t,i=this.collection,s=$(this.posterEl),n=$(".play-btn").eq(0);i.length?(e=i.at(0),t=e.get("url"),s.attr("href",t+"&bl=hb"),s.attr("static","bl=spa"+encodeURIComponent("简介")+"&site="+e.get("site_url")),TVShowEpisode.focusCollection.load({episode:e.get("episode"),site:e.get("site_url")})):n.html("查看更多"),this.unfold()},onMonthChange:function(e){this.render({start:0,month:e})},onToggleFold:function(e){e.preventDefault();var t,i=$(e.currentTarget),s=this.$el.find(".show-episodes-list"),n="";"收起"==i.text()?(i.removeClass("unfold"),s.addClass("episode-fold")):(i.addClass("unfold"),s.removeClass("episode-fold"),(t=s.find("textarea")).length&&(s.append(t.text()),t.remove())),n=i.text(),i.html(i.data("toggle")+"<i></i>").data("toggle",n)},onFocusLoad:function(e){var t=this.collection.slice(0,4);$("#j-newest-list").html(template.newest({episodes:t,len:$(".intro .intro-adv:visible").length?t.length-1:t.length,focus:e,timeHelper:this.timeHelper}))},timeHelper:function(e){var t=Math.floor(e/60),i=Math.floor(e%60);return(10>t?"0"+t:t)+":"+(10>i?"0"+i:i)},monthEpisodeHelper:function(e){return this.collection.getByMonth(e).length},bindMonthEvents:function(){$("#j-newest-list").on("click",".nav-list a",_.bind(this.headerMonthSwitch,this))},headerMonthSwitch:function(e){e.preventDefault();var t=$(e.currentTarget),i=t.data("month");$(".j-nav-wrap a[href=#episode]").trigger("click"),setTimeout(function(){TVShowEpisode.headerView.$el.find(".episode-month-wrap a[data-month="+i+"]").trigger("click")},300)}})}),module.exports=function(e){TVShowEpisode.init.call(TVShowEpisode,e)}});
;define("detail:widget/episodeSA/tv.js",function(e,t,i){var o=e("common:static/vendor/underscore/underscore.js"),s=e("common:static/vendor/backbone/backbone.js"),n=e("detail:widget/episodeSA/episode.js"),a=new Object;n.setRoot(a),o.extend(a,n),o.extend(a.Config,{comic:{dtype:"comic",pageBaseNumber:100,unit:"集",apiPath:"/comic_intro/",urlPrefix:"/kan/comic/?",hostUrl:"v.baidu.com/comic_intro/",fieldsAdapter:function(e){e=o.defaults(e,this.fields);var t=parseInt(e.is_play,10),i=a.getPlayUrl(t,e.site_url,e.episode,e.url),s={text:t?e.episode:"暂无 ",title:(t?"观看 ":"搜一下 ")+"第"+e.episode+"集",to:t?"play":"search",episode:e.episode,url:i,site_url:e.site_url,thumbnail:e.thumbnail_16_9||e.thumbnail,lastEpisode:this.isLastEpisode(e.episode)};return s}},tv:{dtype:"tv",pageBaseNumber:100,unit:"集",apiPath:"/tv_intro/",urlPrefix:"/kan/tvplay/?",hostUrl:"v.baidu.com/tv_intro/",fieldsAdapter:function(e){e=o.defaults(e,this.fields);var t=parseInt(e.is_play,10),i=a.getPlayUrl(t,e.site_url,e.episode,e.url),s={text:t?e.episode:"暂无 ",title:(t?"观看 ":"搜一下 ")+"第"+e.episode+"集",to:t?"play":"search",episode:e.episode,url:i,site_url:e.site_url,thumbnail:e.thumbnail,lastEpisode:this.isLastEpisode(e.episode)};return s}}}),o.extend(a.Views,{header:s.View.extend({el:"#episode-header",tpl:"pagination",events:{"mouseover .episodes-dropdown":"onMouseoverDropdown","mouseleave .episodes-dropdown":"onMouseleaveDropdown","mouseover .j-more":"onMouseoverMore","mouseleave .j-more":"onMouseleaveMore","click .site-list .site":"onClickSite","click .episode-paginations .episode-page":"onSetPage","click .episode-paginations-menu .episode-page":"onSetPageMenu"},render:function(e){var t=e.model;this.renderPage(t.get("episodes").length,!1),this.initedSite||(this.initedSite=!0,this.renderSite())},renderPage:function(e,t,i){var o=this.pageTempate({paginations:this.createPages(e,t),unit:a.options.unit,last:i});this.$el.find(".episode-paginations-wrap").html(o)},siteTimer:0,renderSite:function(){var e=a.siteCollection,t=a.getTempalte("sites")({sites:e.toJSON(),opt:a.options});this.$el.find(".episode-site-wrap").html(t)},initialize:function(){this.pageTempate=a.getTempalte(this.tpl),a.dataCollection.on("data.loaded",o.bind(this.render,this))},createPages:function(e,t){var i=a.options.pageBaseNumber,s=[],n=!~a.options.sort;return t&&e>i&&(n?(s=o.range(e,0,-i),s=o.map(s,function(t){var o=e-t,s=Math.max(t-i,0),n={start:o+1,begin:t,end:s+1};return n})):(s=o.range(0,e,i),s=o.map(s,function(t){var o=t+1,s=Math.min(t+i,e),n={start:o,begin:o,end:s};return n}))),s},onClickSite:function(e){e.preventDefault();var t=$(e.currentTarget),i=t.data("site");i&&a.queryModel.set({site:i})},onSetPage:function(e){e.preventDefault();var t=$(e.currentTarget),i=t.data("start");a.episodesView.setPage(+i-1,!1,!0),t.parent().addClass("current").siblings().removeClass("current")},onMouseoverDropdown:function(e){var t=$(e.currentTarget);t.addClass("episodes-dropdown-active").find("li").show()},onMouseleaveDropdown:function(e){var t=$(e.currentTarget);t.removeClass("episodes-dropdown-active").find("li").not(".current").hide()},onSetPageMenu:function(e){e.preventDefault();var t=$(e.currentTarget),i=t.data("start");a.episodesView.setPage(+i-1,!1,!0),t.parent().addClass("current").siblings().removeClass("current"),t.parent().parent().trigger("mouseleave")},_timer:null,onMouseoverMore:function(e){clearTimeout(this._timer);var t=$(e.currentTarget);t.find(".j-more-list").show()},onMouseleaveMore:function(e){var t=$(e.currentTarget);this._timer=setTimeout(function(){t.find(".j-more-list").hide()},100)}}),episodes:s.View.extend({el:"#episode-episodes",tpl:"episodes",loadingTpl:"loading",events:{"click .fold":"onFold","click .unfold":"onUnfold"},posterEl:"#poster .poster-a",btnPlay:"#j-play-btn",newlistEl:"#j-newest-list",initialize:function(){this.template=a.getTempalte(this.tpl),this.tipTemplate=a.getTempalte(this.loadingTpl),this.collection=new a.Collections.episodes,this.collection.on("reset",o.bind(this.collectionReset,this)),this.on("showLoader",o.bind(this.showLoader,this)),this.trigger("showLoader"),this.on("updateRecord",o.bind(this.onUpdateRecord,this))},showLoader:function(){var e=this.tipTemplate();this.$el.hide().html(e).show()},onFold:function(e){e.preventDefault();$(e.currentTarget);this.setPage(0,!0),a.headerView.renderPage(this.collection.length,!1)},onUnfold:function(e){e.preventDefault();var t=($(e.currentTarget),this.collection.length),i=a.options,o=i.finish,s=o?0:t-t%i.pageBaseNumber;this.setPage(s,!1,!0),a.headerView.renderPage(this.collection.length,!0,!o)},setPage:function(e,t,i){this.render({end:t?void 0:a.options.pageBaseNumber+e,start:e,cancelPage:!0,showFold:i,fold:t})},render:function(e){e||(e={});var t,i=this.$el,o=a.options,s=e.start||0,r=this.collection.length,l=Math.min(e.end||r,r),d=this.collection.models,p=l-s;t=this.template({episodes:d,start:s,max:l,len:p,total:r,unit:o.unit,showFold:e.showFold,pageBaseNumber:o.pageBaseNumber,fold:e.fold&&(p>=o.pageBaseNumber/2||r>o.pageBaseNumber)}),i.hide().html(t).fadeIn(),this.trigger("updateRecord",n.userRecord)},collectionReset:function(){{var e,t,i=this.collection,o=$(this.posterEl),s=$(this.btnPlay);$(this.newlistEl)}this.setPage(0,!0),i.length?o.length&&(e=i.at(0),t=e.get("url"),o.attr("href",t+"&bl=hb"),o.attr("static","bl=spa"+encodeURIComponent("简介")+"&site="+e.get("site_url"))):(s.html("查看更多"),s.show())},onUpdateRecord:function(e){if(e){var t=".episode-episode",i=this.$el.find(t+"[data-episode="+e+"]");if(i.length){var o=n.getTempalte("episodetip"),s=$(o({record:e}));i.prevAll().length<12?s.addClass("episode-tip-down"):i.position().left>.6*i.parent().width()&&s.addClass("episode-tip-right"),i.append(s),i.css("z-index",2),setTimeout(function(){s.remove()},6e3)}}},onUpdateRecord_old:function(e){if(e){var t,i=".episode-episode",o=this.$el.find(i+"[data-episode="+e+"]"),s=!~n.options.sort;(o.length||(o=this.$el.find(s?i+":last":i+":first"),o.data("episode")>e))&&(t=s?o.prevAll(i):o.nextAll(i),o.addClass("unseen"),t.addClass("unseen"))}}})}),i.exports=function(e){a.init.call(a,e)}});
;define("detail:widget/hottvshow/competition/competition.js",function(require,exports,module){var Base=require("common:static/ui/oo/klass.js"),_=Base._,hotTvshowData=require("detail:static/ui/utils/hotTvshowData.js"),ViewGuests=Base.CC.sub({init:function(t){this.showCompetitionlist(t.keyindex,t.topicid)},tpls:{competition:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+='<div class="comp-list clearfix">\n    ';var item,url;for(var i in data)if(item=data[i],url=item.link,item.arr_videos&&item.arr_videos.length){__p+='\n    <dl class="item">\n        <dt>\n            '+(null==(__t=item.title)?"":_.escape(__t))+'\n        </dt>\n        <dd>\n            <ul class="list">\n                ';var work;__p+="\n                ";for(var j=0,k=Math.min(item.arr_videos.length,5);k>j;j++)__p+="\n                    ",work=item.arr_videos[j],__p+='\n                    <li class="list-item-'+(null==(__t=j+1)?"":__t)+'">\n                        <a href="'+(null==(__t=work.link)?"":__t)+'" static="stp=work" title="'+(null==(__t=work.sub_title)?"":_.escape(__t))+'" target="_blank">'+(null==(__t=work.sub_title)?"":_.escape(__t))+'</a>\n                        <em class="num">0'+(null==(__t=j+1)?"":__t)+'</em>\n                        <span class="actor">'+(null==(__t=work.title)?"":_.escape(__t))+"</span>\n                    </li>\n                ";__p+="\n            </ul>\n        </dd>\n    </dl>\n    "}__p+="\n</div>"}return __p}},elements:{".vcom-list-wrap":"elList",".block-title":"elTitle"},showCompetitionlist:function(t,i){hotTvshowData.get(t||"4",this.proxy(function(t){if(t&&t.arr_tags&&t.arr_tags){var i=_.sortBy(t.arr_tags,function(t){return+t.weight});this.elList.html(this.getTpl("competition")({data:i,log:""})),t.title&&this.elTitle.text(t.title),this.el.show()}}),i)}});module.exports=function(t){new ViewGuests(t)}});
;define("detail:widget/hottvshow/episodes/episodes.js",function(require,exports,module){var Base=require("common:static/ui/oo/klass.js"),_=Base._,hotTvshowData=require("detail:static/ui/utils/hotTvshowData.js"),ViewEpisodes=Base.CC.sub({init:function(e){this.showEpisodeslist(e.keyindex,e.topicid)},tpls:{episodes:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="";var episode,len=Math.min(data.length,5);__p+='\n<div class="episode-focus-wrap clearfix">\n    ';for(var i=0;len>i;i++)__p+="\n    ",episode=data[i],__p+='\n    <div class="new-item',i==len-1&&(__p+=" new-item-last"),__p+="",i>0&&i==len-2&&(__p+=" new-item-last-two"),__p+=" new-item-"+(null==(__t=i+1)?"":__t)+" ",1===+episode.video_type&&(__p+="new-item-out"),__p+='">\n        <a static="bl=vepisodes&stp=video" target="_blank" class="view-box" href="'+(null==(__t=episode.link)?"":__t)+'&bl=jp_video" title="'+(null==(__t=episode.title)?"":_.escape(__t))+'">\n            <span class="view">\n                <img class="item-img" src="'+(null==(__t=episode.image_link)?"":__t)+'"/>\n                <span class="info-bg"></span>\n                <span class="info">'+(null==(__t=episode.actor)?"":__t)+'</span>\n                <span class="s-play"></span>\n                <span class="s-new">',1===+episode.video_type&&(__p+="OUT"),__p+='</span>\n            </span>\n           <span class="title">'+(null==(__t=$.string.widthstr(episode.title,28))?"":__t)+"</span>\n        </a>\n    </div>\n    ";__p+="\n</div>"}return __p}},elements:{".vepisodes-list-wrap":"elList",".block-title":"elTitle"},showEpisodeslist:function(e,s){hotTvshowData.get(e||"1",this.proxy(function(e){e&&e.arr_videos&&e.arr_videos.length&&(this.elList.html(this.getTpl("episodes")({data:e.arr_videos,log:""})),e.title&&this.elTitle.text(e.title),this.el.show())}),s)}});module.exports=function(e){new ViewEpisodes(e)}});
;define("detail:widget/hottvshow/guests/guests.js",function(require,exports,module){var Base=require("common:static/ui/oo/klass.js"),_=Base._,hotTvshowData=require("detail:static/ui/utils/hotTvshowData.js"),ViewGuests=Base.CC.sub({init:function(t){this.showGuestslist(t.keyindex,t.topicid)},tpls:{guests:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+='<ul class="guests-list clearfix">\n    ';var item,url;for(var i in data){if(item=data[i],url=item.tag_alias,__p+='\n    <li class="item">\n        <a href="'+(null==(__t=url)?"":__t)+'" class="item-guest ',1===+item.tag_type&&(__p+="item-guest-out"),__p+='" target="_blank" static="stp=actor&name='+(null==(__t=item.title)?"":_.escape(__t))+'&to=search" title="'+(null==(__t=item.title)?"":_.escape(__t))+'">\n            <img src="'+(null==(__t=item.trunk)?"":__t)+'" alt="'+(null==(__t=item.title)?"":_.escape(__t))+'">\n            <span class="shadow"></span>\n            <span class="title">'+(null==(__t=item.title)?"":_.escape(__t))+"</span>\n            ",1===+item.tag_type&&(__p+='<span class="extra">OUT</span>'),__p+="\n        </a>\n        ",item.arr_videos){__p+='\n        <div class="guests-works">\n            ';var work;__p+="\n            ";for(var j=0,k=Math.min(item.arr_videos.length,4);k>j;j++)__p+="\n                ",work=item.arr_videos[j],__p+='\n                <a href="'+(null==(__t=work.link)?"":__t)+'" static="stp=work&name='+(null==(__t=work.title)?"":_.escape(__t))+'" target="_blank">'+(null==(__t=work.title)?"":_.escape(__t))+"</a>\n            ";__p+="\n        </div>\n        "}__p+="\n    </li>\n    "}__p+="\n</ul>"}return __p}},elements:{".vguests-list-wrap":"elList",".block-title":"elTitle"},showGuestslist:function(t,e){hotTvshowData.get(t||"3",this.proxy(function(t){if(t&&t.arr_tags&&t.arr_tags){var e=_.sortBy(t.arr_tags,function(t){return+t.weight});this.elList.html(this.getTpl("guests")({data:e,log:""})),t.title&&this.elTitle.text(t.title),this.el.show()}}),e)}});module.exports=function(t){new ViewGuests(t)}});
;define("detail:widget/hottvshow/map/map.js",function(require,exports,module){var Base=require("common:static/ui/oo/klass.js"),_=Base._,seriesTpl={map:{name:"排名",tooltip:{trigger:"item",formatter:function(t){return[t[1],"<br/>","排名：",t[2]].join("")}},type:"map",mapType:"china",mapLocation:{x:"right",y:"center"},showLegendSymbol:!1,selectedMode:"single",itemStyle:{normal:{borderColor:"#ededed",borderWidth:1,areaStyle:{color:"#dfe5ec"},label:{show:!1}},emphasis:{areaStyle:{color:"#1a90fc"},label:{show:!0,textStyle:{color:"#fff"}}}},data:[]}},ViewBarChart=Base.CC.sub({init:function(t){this.ps=t.ps,this.barWidth=250,this.minWidth=5},elements:{".top-list":"elTopList"},tpls:{bar:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="<ol>\n";var o,i=0;for(data.length;o=data[i];i+=1)__p+='\n    <li class="clearfix">\n        <div class="place">'+(null==(__t=i+1)?"":__t)+"."+(null==(__t=o.name)?"":__t)+'</div>\n        <div class="bar"><div class="bar-cur" style="width: '+(null==(__t=o.cur)?"":__t)+'px"></div></div>\n    </li>\n';__p+="\n</ol>\n"}return __p}},_process:function(t){t=t.slice(0,this.ps);var e=this;return _.each(t,function(t){t.cur="-"===t.value||0===+t.value?e.minWidth:e.barWidth*(t.value/e.maxValue).toFixed(2)}),t},selectAll:function(){this.$bar.css("visibility","visible")},hideAll:function(){this.$bar.css("visibility","hidden")},select:function(t){this.hideAll(),this.$bar.filter(function(e){return 0===t&&e%2===0?this:1===t&&e%2===1?this:void 0}).css("visibility","visible")},render:function(t,e){this.maxValue=e;var i="",a={data:this._process(t[0])};try{i=this.getTpl("bar")(a),this.elTopList.hide().html(i).show()}catch(s){console&&console.log(s)}}}),ViewMap=Base.CC.sub({init:function(t){this.opt=_.extend({},t,{top:10,barValueThreshold:.05,prefix:{max:"MAX_",index:"REF_INDEX_"},filters:{ab:"ab_score",index:"index_score"},colors:[["#4c95ed","#7aabec","#9dbbe7","#aec5e6","#b5c9e5","#c4d3e7","#cbd7e7","#d0dbe7","#d9e0ea","#dfe5ec"],["#ed5f5b","#ed6d69","#ec7b78","#ee8b88","#ef9b99","#efa6a4","#f0b3b1","#f4c1bf","#f8cfce","#f9dcdb"]],emphasisColors:["#1a90fc","#fa4540"],option:{animation:!1,color:["#5d9eda","#ed5f5b"],tooltip:{trigger:"item"},legend:{x:10,y:20,data:[]},series:[]}}),this.cache={},this.filter=this.opt.filters.ab,this.areaDataMap={},this.isRefresh=!1,this.refIndex=0,this.maxValue=0,this.barChart=new ViewBarChart({el:this.el,ps:this.opt.top}),this.chart=echarts.init(this.elChartWrap[0]),this.render()},elements:{".chart":"elChartWrap",".ranger":"elRanger",".tab a":"elTab",".explain":"elExplain"},events:{"click .tab a":"fnSwtichTab"},fnSwtichTab:function(t){t.preventDefault();var e=$(t.currentTarget);if(!e.hasClass("selected")){this.elTab.removeClass("selected"),e.addClass("selected"),this.elExplain.text(e.data("tip"));var i=e.data("filter");this.filter=this.opt.filters[i]||this.opt.filters.ab,this.isRefresh=!0,this.render()}},getIndexData:function(t){var e="http://index.v.baidu.com/trend/map",i=this.cache.raw,a=this;return i?t(i):void $.ajax({url:e,data:{id:this.opt.videoId,type:this.opt.type},dataType:"jsonp"}).done(function(e){0===+e.errno&&e.data&&e.data.length&&(a.cache.raw=e.data,t(e.data))})},_preProcessor:function(t,e){for(var i,a=[e,":",this.filter].join(""),s=(this.cache[a],this),r=0;i=t[r];r+=1)i.sort(function(t,e){return parseInt(t[s.filter],10)>parseInt(e[s.filter],10)?-1:1});var n=t[0]&&t[0].length?this._getMaxValue(t[0]):0,h=this.pk&&t[1]&&t[1].length?this._getMaxValue(t[1]):0;this.maxValue=this.cache[this.opt.prefix.max+this.filter]=Math.max(n,h),this.refIndex=this.cache[this.opt.prefix.index+this.filter]=this.maxValue===n?0:1},_process:function(t,e){function i(t,e){for(var i,a=s.opt.colors[s.refIndex],h=t.length,o=Math.ceil(h/s.opt.top),l=[],d=[],c=0;i=t[c];c+=1){var p,f=i.place,u=parseInt(i[s.filter]||0,10),b=null;p={name:f,value:c+1},e===s.refIndex&&(b=a[h>s.opt.top?Math.round(c/o):c],p.itemStyle={normal:{areaStyle:{color:b}}}),d.push(p),p={name:f,value:u},c<s.opt.top&&l.push(p)}n.push(d),r.push(l)}this._preProcessor(e,t);for(var a,s=this,r=(this.areaDataMap[this.filter]={},[]),n=[],h=[],o=0;a=e[o];o+=1){i(a,o);var l=_.clone(seriesTpl);l.map.data=n[o],h.push(l.map)}var d={bar:r,series:h.reverse()},c=[t,":",this.filter].join("");this.cache[c]=d,this.data=d},_getMaxValue:function(t){var e=t[0],i=t[t.length-1];return Math.max(parseInt(e[this.filter],10)||0,parseInt(i[this.filter],10)||0)},_isValidSeriesData:function(t){for(var e,i=0;e=t[i];i+=1)if(e.value>0)return!0;return!1},_mergeChartOption:function(){var t=this.opt.option,e=this.data.series;t.legend.data=[],t.series=e},render:function(){this.getIndexData(this.proxy(function(t){this._process("id="+this.opt.videoId,t),this.barChart.render(this.data.bar,this.maxValue),this._mergeChartOption(),this.isRefresh?(this.chart.restore(),this.chart.setOption(this.opt.option,!0),this.isRefresh=!1):this.chart.setOption(this.opt.option),this._rendered()}))},_rendered:function(){var t="ranger-1";0===this.refIndex&&this.elRanger.hasClass(t)?this.$ranger.removeClass(t):1!==this.refIndex||this.elRanger.hasClass(t)||this.$ranger.addClass(t)},_mapFormatter:function(t){var e="-";if(t&&t.length>1){var i=t[1],a=this.areaDataMap[this.filter][i];a&&a.length&&(e=[i+"地区排名"],e.push([this.title,"：","undefined"!=typeof a[0]?"第"+a[0]+"位":"-"].join("")),e.push([this.pkTitle,"：","undefined"!=typeof a[1]?"第"+a[1]+"位":"-"].join("")),e=e.join("<br/>"))}return e}});module.exports=function(t){new ViewMap(t)}});
;define("detail:widget/hottvshow/news/news.js",function(require,exports,module){var Base=require("common:static/ui/oo/klass.js"),_=Base._,hotTvshowData=require("detail:static/ui/utils/hotTvshowData.js"),ViewNews=Base.CC.sub({init:function(t){this.opt=t,this.showSearchResult(),this.showHotNews(t.keyindex,t.topicid)},elements:{".video-news":"elVideosWrap",".news":"elNewsWrap",".block-title":"elBlockTitle"},tpls:{videos:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+='<ul class="video-news-list clearfix">\n    ';for(var i=0,len=data.length;len>i&&ps>i;i+=1){var o=data[i],itemClass=i===ps-1?"list-item-last":"";__p+='\n        <li class="list-item '+(null==(__t=itemClass)?"":__t)+'">\n            <a static="stp=po&to=play" target="_blank" class="view-box" href="'+(null==(__t=o.url)?"":__t)+'&bl=jp_video" title="'+(null==(__t=o.ti)?"":_.escape(__t))+'">\n                <span class="view">\n                    <img class="item-img" src="'+(null==(__t=o.pic)?"":__t)+'" alt="'+(null==(__t=o.ti)?"":__t)+'"/>\n                    <span class="info-bg"></span>\n                    <span class="info">'+(null==(__t=o.duration_hour)?"":__t)+'</span>\n                    <span class="s-mask"></span>\n                    <span class="s-play"></span>\n                    <span class="site">'+(null==(__t=o.srcShortUrlExt)?"":__t)+'</span>\n                </span>\n               <span class="title">'+(null==(__t=o.ti)?"":_.escape(__t))+"</span>\n            </a>\n        </li>\n    "}__p+="\n</ul>\n\n"}return __p},news:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="<ul>\n    ";for(var i=0,l=data.length;l>i;i++){__p+="\n    ";var news=data[i];__p+='\n    <li class="',__p+=i%2===0?"odd":"even",__p+='">\n        <a class="title" href="'+(null==(__t=news.news_url)?"":__t)+'" title="'+(null==(__t=news.news_title)?"":_.escape(__t))+'"\n           target="_blank">'+(null==(__t=news.news_title)?"":_.escape(__t))+'<span class="more">'+(null==(__t=formatDate(news.news_time))?"":__t)+"</span></a>\n    </li>\n    "}__p+="\n</ul>"}return __p}},getSearchResult:function(t){var s="http://v.baidu.com/v?ct=905969664&rn=6&ie=utf-8&du=3";14857===+this.opt.videoId&&(s+="&sc=1"),$.ajax({url:s,data:{word:this.opt.title},dataType:"jsonp",jsonpCallback:"jsonFn",callbackName:"jsonFnMoreCallback"}).done(function(s){s&&s.data&&s.data.length>3&&t(s.data)})},showSearchResult:function(){this.getSearchResult(this.proxy(function(t){var s=this.getTpl("videos")({data:t,ps:5});this.elVideosWrap.html(s).show(),this.el.show()}))},getHotNews:function(t){var s="http://index.v.baidu.com/detail/show";$.ajax({url:s,data:{id:this.opt.videoId,format:"json"},dataType:"jsonp"}).done(function(s){0===+s.errno&&s.data&&s.data.news&&t(s.data.news)})},showHotNews:function(t,s){this.getHotNews(this.proxy(function(e){var n=this.getTpl("news")({data:e.slice(0,6),formatDate:function(t){t=""+t+"000";var s=new Date(+t),e=function(t){return 10>t?"0"+t:t};return[s.getFullYear(),e(s.getMonth()+1),e(s.getDate())].join("-")}});hotTvshowData.get(t||"8",this.proxy(function(t){t&&t.title&&this.elBlockTitle.text(t.title),this.elNewsWrap.html(n).show(),this.el.show()}),s)}))}});module.exports=function(t){new ViewNews(t)}});
;define("detail:widget/hottvshow/people/people.js",function(require,exports,module){var Base=require("common:static/ui/oo/klass.js"),_=Base._,hotTvshowData=require("detail:static/ui/utils/hotTvshowData.js"),ViewPeople=Base.CC.sub({init:function(t){this.showToplist(t.keyindex,t.topicid)},tpls:{people:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+='<div class="people-list clearfix" static="'+(null==(__t=log||"bl=side&stp=speople&to=search")?"":__t)+'">\n    ';for(var item,url,i=0,l=Math.min(data.length,showLength);l>i;i++)item=data[i],url=item.link,__p+='\n    <a href="'+(null==(__t=url)?"":__t)+'" class="item',(i+1)%3==0&&(__p+=" item-last"),__p+='" target="_blank" static="ext=people&name='+(null==(__t=item.title)?"":_.escape(__t))+'">\n        <img src="'+(null==(__t=item.image_link)?"":__t)+'" alt="'+(null==(__t=item.title)?"":_.escape(__t))+'">\n        <span class="shadow"></span>\n        <span class="title">'+(null==(__t=item.title)?"":_.escape(__t))+"</span>\n    </a>\n    ";__p+="\n</div>"}return __p}},elements:{".vpeople-list-wrap":"elList",".block-title":"elTitle"},showToplist:function(t,e){hotTvshowData.get(t||"6",this.proxy(function(t){t&&t.arr_videos&&t.arr_videos.length&&(this.elList.html(this.getTpl("people")({data:t.arr_videos,showLength:6,log:""})),t.title&&this.elTitle.text(t.title),this.el.show())}),e)}});module.exports=function(t){new ViewPeople(t)}});
;define("detail:widget/hottvshow/related/related.js",function(require,exports,module){var Base=require("common:static/ui/oo/klass.js"),_=Base._,hotTvshowData=require("detail:static/ui/utils/hotTvshowData.js"),ViewRelated=Base.CC.sub({init:function(t){this.showToplist(t.keyindex,t.topicid)},tpls:{related:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+='<div class="related-list clearfix" static="'+(null==(__t=log||"bl=side&stp=vrelated&to=search")?"":__t)+'">\n    ';for(var item,url,i=0,l=Math.min(data.length,showLength);l>i;i++)item=data[i],url=item.link,__p+='\n    <a href="'+(null==(__t=url)?"":__t)+'" class="item',(i+1)%3==0&&(__p+=" item-last"),__p+='" target="_blank" static="name='+(null==(__t=item.title)?"":_.escape(__t))+'">\n        <img src="'+(null==(__t=item.image_link_crop||item.image_link)?"":__t)+'" alt="'+(null==(__t=item.title)?"":_.escape(__t))+'">\n        <span class="shadow"></span>\n        <span class="title">'+(null==(__t=item.title)?"":_.escape(__t))+"</span>\n    </a>\n    ";__p+="\n</div>"}return __p}},elements:{".vrelated-list-wrap":"elList",".block-title":"elTitle"},showToplist:function(t,e){hotTvshowData.get(t||"7",this.proxy(function(t){t&&t.arr_videos&&t.arr_videos.length&&(this.elList.html(this.getTpl("related")({data:t.arr_videos,showLength:6,log:""})),t.title&&this.elTitle.text(t.title),this.el.show())}),e)}});module.exports=function(t){new ViewRelated(t)}});
;define("detail:widget/hottvshow/top/top.js",function(require,exports,module){var Base=require("common:static/ui/oo/klass.js"),_=Base._,hotTvshowData=require("detail:static/ui/utils/hotTvshowData.js"),ViewTop=Base.CC.sub({init:function(t){this.showToplist(t.keyindex,t.topicid)},tpls:{top:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+='<ul class="vtop-list">\n    ';var item;__p+="\n    ";for(var i=0,l=Math.min(data.length,5);l>i;i++)__p+="\n        ",item=data[i],__p+='\n        <li class="vtop-list-item item-'+(null==(__t=i+1)?"":__t)+'">\n            <span class="zan">',item.sub_title&&(__p+=""+(null==(__t=item.sub_title)?"":_.escape(__t))+"赞"),__p+='</span>\n            <span class="num">'+(null==(__t=i+1)?"":__t)+'</span>\n            <a href="'+(null==(__t=item.link)?"":__t)+'" static="stp=vtop&ext=item&to=search" title="'+(null==(__t=item.title)?"":_.escape(__t))+'" target="_blank">'+(null==(__t=item.title)?"":_.escape(__t))+"</a>\n        </li>\n    ";__p+="\n</ul>"}return __p}},elements:{".vtop-list-wrap":"elList",".block-title":"elTitle"},showToplist:function(t,i){hotTvshowData.get(t||"5",this.proxy(function(t){if(t&&t.arr_videos&&t.arr_videos.length){var i=t.arr_videos.sort(function(t,i){return+i.sub_title-t.sub_title});this.elList.html(this.getTpl("top")({data:i})),t.title&&this.elTitle.text(t.title),this.el.show()}}),i)}});module.exports=function(t){new ViewTop(t)}});
;define("detail:widget/kandian/svgjs.js",function(t,e,i){(function(){function t(t){return t.toLowerCase().replace(/-(.)/g,function(t,e){return e.toUpperCase()})}function e(t){return 4==t.length?["#",t.substring(1,2),t.substring(1,2),t.substring(2,3),t.substring(2,3),t.substring(3,4),t.substring(3,4)].join(""):t}function i(t){var e=t.toString(16);return 1==e.length?"0"+e:e}function n(t,e,i){return(null==e||null==i)&&(null==i?i=t.height/t.width*e:null==e&&(e=t.width/t.height*i)),{width:e,height:i}}function r(t,e){return"number"==typeof t.from?t.from+(t.to-t.from)*e:t instanceof u.Color||t instanceof u.Number?t.at(e):1>e?t.from:t.to}function s(t){for(var e=0,i=t.length,n="";i>e;e++)n+=t[e][0],null!=t[e][1]&&(n+=t[e][1],null!=t[e][2]&&(n+=" ",n+=t[e][2],null!=t[e][3]&&(n+=" ",n+=t[e][3],n+=" ",n+=t[e][4],null!=t[e][5]&&(n+=" ",n+=t[e][5],n+=" ",n+=t[e][6],null!=t[e][7]&&(n+=" ",n+=t[e][7])))));return n+" "}function h(t){t.x2=t.x+t.width,t.y2=t.y+t.height,t.cx=t.x+t.width/2,t.cy=t.y+t.height/2}function o(t){if(t.matrix){var e=t.matrix.replace(/\s/g,"").split(",");6==e.length&&(t.a=parseFloat(e[0]),t.b=parseFloat(e[1]),t.c=parseFloat(e[2]),t.d=parseFloat(e[3]),t.e=parseFloat(e[4]),t.f=parseFloat(e[5]))}return t}function a(t){var e=t.toString().match(u.regex.reference);return e?e[1]:void 0}var u=this.SVG=function(t){return u.supported?(t=new u.Doc(t),u.parser||u.prepare(t),t):void 0};if(u.ns="http://www.w3.org/2000/svg",u.xmlns="http://www.w3.org/2000/xmlns/",u.xlink="http://www.w3.org/1999/xlink",u.did=1e3,u.eid=function(t){return"Svgjs"+t.charAt(0).toUpperCase()+t.slice(1)+u.did++},u.create=function(t){var e=document.createElementNS(this.ns,t);return e.setAttribute("id",this.eid(t)),e},u.extend=function(){var t,e,i,n;for(t=[].slice.call(arguments),e=t.pop(),n=t.length-1;n>=0;n--)if(t[n])for(i in e)t[n].prototype[i]=e[i];u.Set&&u.Set.inherit&&u.Set.inherit()},u.prepare=function(t){var e=document.getElementsByTagName("body")[0],i=(e?new u.Doc(e):t.nested()).size(2,0),n=u.create("path");i.node.appendChild(n),u.parser={body:e||t.parent,draw:i.style("opacity:0;position:fixed;left:100%;top:100%;overflow:hidden"),poly:i.polyline().node,path:n}},u.supported=function(){var t=!0;try{new Event("test")}catch(e){t=!1}return t&&!!this.createElementNS&&!!this.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect}.call(document),!u.supported)return!1;u.get=function(t){var e=document.getElementById(a(t)||t);return e?e.instance:void 0},u.invent=function(t){var e="function"==typeof t.create?t.create:function(){this.constructor.call(this,u.create(t.create))};return t.inherit&&(e.prototype=new t.inherit),t.extend&&u.extend(e,t.extend),t.construct&&u.extend(t.parent||u.Container,t.construct),e},u.regex={unit:/^(-?[\d\.]+)([a-z%]{0,2})$/,hex:/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,rgb:/rgb\((\d+),(\d+),(\d+)\)/,reference:/#([a-z0-9\-_]+)/i,isHex:/^#[a-f0-9]{3,6}$/i,isRgb:/^rgb\(/,isCss:/[^:]+:[^;]+;?/,isBlank:/^(\s+)?$/,isNumber:/^-?[\d\.]+$/,isPercent:/^-?[\d\.]+%$/,isImage:/\.(jpg|jpeg|png|gif)(\?[^=]+.*)?/i,isEvent:/^[\w]+:[\w]+$/},u.defaults={matrix:"1 0 0 1 0 0",attrs:{"fill-opacity":1,"stroke-opacity":1,"stroke-width":0,"stroke-linejoin":"miter","stroke-linecap":"butt",fill:"#000000",stroke:"#000000",opacity:1,x:0,y:0,cx:0,cy:0,width:0,height:0,r:0,rx:0,ry:0,offset:0,"stop-opacity":1,"stop-color":"#000000","font-size":16,"font-family":"Helvetica, Arial, sans-serif","text-anchor":"start"},trans:function(){return{x:0,y:0,scaleX:1,scaleY:1,rotation:0,skewX:0,skewY:0,matrix:this.matrix,a:1,b:0,c:0,d:1,e:0,f:0}}},u.Color=function(t){var i;this.r=0,this.g=0,this.b=0,"string"==typeof t?u.regex.isRgb.test(t)?(i=u.regex.rgb.exec(t.replace(/\s/g,"")),this.r=parseInt(i[1]),this.g=parseInt(i[2]),this.b=parseInt(i[3])):u.regex.isHex.test(t)&&(i=u.regex.hex.exec(e(t)),this.r=parseInt(i[1],16),this.g=parseInt(i[2],16),this.b=parseInt(i[3],16)):"object"==typeof t&&(this.r=t.r,this.g=t.g,this.b=t.b)},u.extend(u.Color,{toString:function(){return this.toHex()},toHex:function(){return"#"+i(this.r)+i(this.g)+i(this.b)},toRgb:function(){return"rgb("+[this.r,this.g,this.b].join()+")"},brightness:function(){return this.r/255*.3+this.g/255*.59+this.b/255*.11},morph:function(t){return this.destination=new u.Color(t),this},at:function(t){return this.destination?(t=0>t?0:t>1?1:t,new u.Color({r:~~(this.r+(this.destination.r-this.r)*t),g:~~(this.g+(this.destination.g-this.g)*t),b:~~(this.b+(this.destination.b-this.b)*t)})):this}}),u.Color.test=function(t){return t+="",u.regex.isHex.test(t)||u.regex.isRgb.test(t)},u.Color.isRgb=function(t){return t&&"number"==typeof t.r&&"number"==typeof t.g&&"number"==typeof t.b},u.Color.isColor=function(t){return u.Color.isRgb(t)||u.Color.test(t)},u.Array=function(t,e){t=(t||[]).valueOf(),0==t.length&&e&&(t=e.valueOf()),this.value=this.parse(t)},u.extend(u.Array,{morph:function(t){if(this.destination=this.parse(t),this.value.length!=this.destination.length){for(var e=this.value[this.value.length-1],i=this.destination[this.destination.length-1];this.value.length>this.destination.length;)this.destination.push(i);for(;this.value.length<this.destination.length;)this.value.push(e)}return this},settle:function(){for(var t=0,e=this.value.length,i=[];e>t;t++)-1==i.indexOf(this.value[t])&&i.push(this.value[t]);return this.value=i},at:function(t){if(!this.destination)return this;for(var e=0,i=this.value.length,n=[];i>e;e++)n.push(this.value[e]+(this.destination[e]-this.value[e])*t);return new u.Array(n)},toString:function(){return this.value.join(" ")},valueOf:function(){return this.value},parse:function(t){return t=t.valueOf(),Array.isArray(t)?t:this.split(t)},split:function(t){return t.replace(/\s+/g," ").replace(/^\s+|\s+$/g,"").split(" ")},reverse:function(){return this.value.reverse(),this}}),u.PointArray=function(){this.constructor.apply(this,arguments)},u.PointArray.prototype=new u.Array,u.extend(u.PointArray,{toString:function(){for(var t=0,e=this.value.length,i=[];e>t;t++)i.push(this.value[t].join(","));return i.join(" ")},at:function(t){if(!this.destination)return this;for(var e=0,i=this.value.length,n=[];i>e;e++)n.push([this.value[e][0]+(this.destination[e][0]-this.value[e][0])*t,this.value[e][1]+(this.destination[e][1]-this.value[e][1])*t]);return new u.PointArray(n)},parse:function(t){if(t=t.valueOf(),Array.isArray(t))return t;t=this.split(t);for(var e,i=0,n=t.length,r=[];n>i;i++)e=t[i].split(","),r.push([parseFloat(e[0]),parseFloat(e[1])]);return r},move:function(t,e){var i=this.bbox();if(t-=i.x,e-=i.y,!isNaN(t)&&!isNaN(e))for(var n=this.value.length-1;n>=0;n--)this.value[n]=[this.value[n][0]+t,this.value[n][1]+e];return this},size:function(t,e){var i,n=this.bbox();for(i=this.value.length-1;i>=0;i--)this.value[i][0]=(this.value[i][0]-n.x)*t/n.width+n.x,this.value[i][1]=(this.value[i][1]-n.y)*e/n.height+n.y;return this},bbox:function(){return u.parser.poly.setAttribute("points",this.toString()),u.parser.poly.getBBox()}}),u.PathArray=function(t,e){this.constructor.call(this,t,e)},u.PathArray.prototype=new u.Array,u.extend(u.PathArray,{toString:function(){return s(this.value)},move:function(t,e){var i=this.bbox();if(t-=i.x,e-=i.y,!isNaN(t)&&!isNaN(e))for(var n,r=this.value.length-1;r>=0;r--)n=this.value[r][0],"M"==n||"L"==n||"T"==n?(this.value[r][1]+=t,this.value[r][2]+=e):"H"==n?this.value[r][1]+=t:"V"==n?this.value[r][1]+=e:"C"==n||"S"==n||"Q"==n?(this.value[r][1]+=t,this.value[r][2]+=e,this.value[r][3]+=t,this.value[r][4]+=e,"C"==n&&(this.value[r][5]+=t,this.value[r][6]+=e)):"A"==n&&(this.value[r][6]+=t,this.value[r][7]+=e);return this},size:function(t,e){var i,n,r=this.bbox();for(i=this.value.length-1;i>=0;i--)n=this.value[i][0],"M"==n||"L"==n||"T"==n?(this.value[i][1]=(this.value[i][1]-r.x)*t/r.width+r.x,this.value[i][2]=(this.value[i][2]-r.y)*e/r.height+r.y):"H"==n?this.value[i][1]=(this.value[i][1]-r.x)*t/r.width+r.x:"V"==n?this.value[i][1]=(this.value[i][1]-r.y)*e/r.height+r.y:"C"==n||"S"==n||"Q"==n?(this.value[i][1]=(this.value[i][1]-r.x)*t/r.width+r.x,this.value[i][2]=(this.value[i][2]-r.y)*e/r.height+r.y,this.value[i][3]=(this.value[i][3]-r.x)*t/r.width+r.x,this.value[i][4]=(this.value[i][4]-r.y)*e/r.height+r.y,"C"==n&&(this.value[i][5]=(this.value[i][5]-r.x)*t/r.width+r.x,this.value[i][6]=(this.value[i][6]-r.y)*e/r.height+r.y)):"A"==n&&(this.value[i][1]=this.value[i][1]*t/r.width,this.value[i][2]=this.value[i][2]*e/r.height,this.value[i][6]=(this.value[i][6]-r.x)*t/r.width+r.x,this.value[i][7]=(this.value[i][7]-r.y)*e/r.height+r.y);return this},parse:function(t){if(t instanceof u.PathArray)return t.valueOf();var e,i,n,r,h,o,a,l,c,f,d,p=0,x=0;for(u.parser.path.setAttribute("d","string"==typeof t?t:s(t)),d=u.parser.path.pathSegList,e=0,i=d.numberOfItems;i>e;++e)f=d.getItem(e),c=f.pathSegTypeAsLetter,"M"==c||"L"==c||"H"==c||"V"==c||"C"==c||"S"==c||"Q"==c||"T"==c||"A"==c?("x"in f&&(p=f.x),"y"in f&&(x=f.y)):("x1"in f&&(h=p+f.x1),"x2"in f&&(a=p+f.x2),"y1"in f&&(o=x+f.y1),"y2"in f&&(l=x+f.y2),"x"in f&&(p+=f.x),"y"in f&&(x+=f.y),"m"==c?d.replaceItem(u.parser.path.createSVGPathSegMovetoAbs(p,x),e):"l"==c?d.replaceItem(u.parser.path.createSVGPathSegLinetoAbs(p,x),e):"h"==c?d.replaceItem(u.parser.path.createSVGPathSegLinetoHorizontalAbs(p),e):"v"==c?d.replaceItem(u.parser.path.createSVGPathSegLinetoVerticalAbs(x),e):"c"==c?d.replaceItem(u.parser.path.createSVGPathSegCurvetoCubicAbs(p,x,h,o,a,l),e):"s"==c?d.replaceItem(u.parser.path.createSVGPathSegCurvetoCubicSmoothAbs(p,x,a,l),e):"q"==c?d.replaceItem(u.parser.path.createSVGPathSegCurvetoQuadraticAbs(p,x,h,o),e):"t"==c?d.replaceItem(u.parser.path.createSVGPathSegCurvetoQuadraticSmoothAbs(p,x),e):"a"==c?d.replaceItem(u.parser.path.createSVGPathSegArcAbs(p,x,f.r1,f.r2,f.angle,f.largeArcFlag,f.sweepFlag),e):("z"==c||"Z"==c)&&(p=n,x=r)),("M"==c||"m"==c)&&(n=p,r=x);for(t=[],d=u.parser.path.pathSegList,e=0,i=d.numberOfItems;i>e;++e)f=d.getItem(e),c=f.pathSegTypeAsLetter,p=[c],"M"==c||"L"==c||"T"==c?p.push(f.x,f.y):"H"==c?p.push(f.x):"V"==c?p.push(f.y):"C"==c?p.push(f.x1,f.y1,f.x2,f.y2,f.x,f.y):"S"==c?p.push(f.x2,f.y2,f.x,f.y):"Q"==c?p.push(f.x1,f.y1,f.x,f.y):"A"==c&&p.push(f.r1,f.r2,f.angle,0|f.largeArcFlag,0|f.sweepFlag,f.x,f.y),t.push(p);return t},bbox:function(){return u.parser.path.setAttribute("d",this.toString()),u.parser.path.getBBox()}}),u.Number=function(t){if(this.value=0,this.unit="","number"==typeof t)this.value=isNaN(t)?0:isFinite(t)?t:0>t?-3.4e38:3.4e38;else if("string"==typeof t){var e=t.match(u.regex.unit);e&&(this.value=parseFloat(e[1]),"%"==e[2]?this.value/=100:"s"==e[2]&&(this.value*=1e3),this.unit=e[2])}else t instanceof u.Number&&(this.value=t.value,this.unit=t.unit)},u.extend(u.Number,{toString:function(){return("%"==this.unit?~~(1e8*this.value)/1e6:"s"==this.unit?this.value/1e3:this.value)+this.unit},valueOf:function(){return this.value},plus:function(t){return this.value=this+new u.Number(t),this},minus:function(t){return this.plus(-new u.Number(t))},times:function(t){return this.value=this*new u.Number(t),this},divide:function(t){return this.value=this/new u.Number(t),this},to:function(t){return"string"==typeof t&&(this.unit=t),this},morph:function(t){return this.destination=new u.Number(t),this},at:function(t){return this.destination?new u.Number(this.destination).minus(this).times(t).plus(this):this}}),u.ViewBox=function(t){var e,i,n,r,s=1,h=1,o=t.bbox(),a=(t.attr("viewBox")||"").match(/-?[\d\.]+/g),l=t,c=t;for(n=new u.Number(t.width()),r=new u.Number(t.height());"%"==n.unit;)s*=n.value,n=new u.Number(l instanceof u.Doc?l.parent.offsetWidth:l.parent.width()),l=l.parent;for(;"%"==r.unit;)h*=r.value,r=new u.Number(c instanceof u.Doc?c.parent.offsetHeight:c.parent.height()),c=c.parent;this.x=o.x,this.y=o.y,this.width=n*s,this.height=r*h,this.zoom=1,a&&(e=parseFloat(a[0]),i=parseFloat(a[1]),n=parseFloat(a[2]),r=parseFloat(a[3]),this.zoom=this.width/this.height>n/r?this.height/r:this.width/n,this.x=e,this.y=i,this.width=n,this.height=r)},u.extend(u.ViewBox,{toString:function(){return this.x+" "+this.y+" "+this.width+" "+this.height}}),u.BBox=function(t){var e;if(this.x=0,this.y=0,this.width=0,this.height=0,t){try{e=t.node.getBBox()}catch(i){e={x:t.node.clientLeft,y:t.node.clientTop,width:t.node.clientWidth,height:t.node.clientHeight}}this.x=e.x+t.trans.x,this.y=e.y+t.trans.y,this.width=e.width*t.trans.scaleX,this.height=e.height*t.trans.scaleY}h(this)},u.extend(u.BBox,{merge:function(t){var e=new u.BBox;return e.x=Math.min(this.x,t.x),e.y=Math.min(this.y,t.y),e.width=Math.max(this.x+this.width,t.x+t.width)-e.x,e.height=Math.max(this.y+this.height,t.y+t.height)-e.y,h(e),e}}),u.RBox=function(t){var e,i,n={};if(this.x=0,this.y=0,this.width=0,this.height=0,t){for(e=t.doc().parent,i=t.doc().viewbox().zoom,n=t.node.getBoundingClientRect(),this.x=n.left,this.y=n.top,this.x-=e.offsetLeft,this.y-=e.offsetTop;e=e.offsetParent;)this.x-=e.offsetLeft,this.y-=e.offsetTop;for(e=t;e=e.parent;)"svg"==e.type&&e.viewbox&&(i*=e.viewbox().zoom,this.x-=e.x()||0,this.y-=e.y()||0)}this.x/=i,this.y/=i,this.width=n.width/=i,this.height=n.height/=i,this.x+=window.scrollX,this.y+=window.scrollY,h(this)},u.extend(u.RBox,{merge:function(t){var e=new u.RBox;return e.x=Math.min(this.x,t.x),e.y=Math.min(this.y,t.y),e.width=Math.max(this.x+this.width,t.x+t.width)-e.x,e.height=Math.max(this.y+this.height,t.y+t.height)-e.y,h(e),e}}),u.Element=u.invent({create:function(t){this._stroke=u.defaults.attrs.stroke,this.trans=u.defaults.trans(),(this.node=t)&&(this.type=t.nodeName,this.node.instance=this)},extend:{x:function(t){return null!=t&&(t=new u.Number(t),t.value/=this.trans.scaleX),this.attr("x",t)},y:function(t){return null!=t&&(t=new u.Number(t),t.value/=this.trans.scaleY),this.attr("y",t)},cx:function(t){return null==t?this.x()+this.width()/2:this.x(t-this.width()/2)},cy:function(t){return null==t?this.y()+this.height()/2:this.y(t-this.height()/2)},move:function(t,e){return this.x(t).y(e)},center:function(t,e){return this.cx(t).cy(e)},width:function(t){return this.attr("width",t)},height:function(t){return this.attr("height",t)},size:function(t,e){var i=n(this.bbox(),t,e);return this.width(new u.Number(i.width)).height(new u.Number(i.height))},clone:function(){var t,e,i=this.type;return t="rect"==i||"ellipse"==i?this.parent[i](0,0):"line"==i?this.parent[i](0,0,0,0):"image"==i?this.parent[i](this.src):"text"==i?this.parent[i](this.content):"path"==i?this.parent[i](this.attr("d")):"polyline"==i||"polygon"==i?this.parent[i](this.attr("points")):"g"==i?this.parent.group():this.parent[i](),e=this.attr(),delete e.id,t.attr(e),t.trans=this.trans,t.transform({})},remove:function(){return this.parent&&this.parent.removeElement(this),this},replace:function(t){return this.after(t).remove(),t},addTo:function(t){return t.put(this)},putIn:function(t){return t.add(this)},doc:function(t){return this._parent(t||u.Doc)},attr:function(t,e,i){if(null==t){for(t={},e=this.node.attributes,i=e.length-1;i>=0;i--)t[e[i].nodeName]=u.regex.isNumber.test(e[i].nodeValue)?parseFloat(e[i].nodeValue):e[i].nodeValue;return t}if("object"==typeof t)for(e in t)this.attr(e,t[e]);else if(null===e)this.node.removeAttribute(t);else{if(null==e)return e=this.node.getAttribute(t),null==e?u.defaults.attrs[t]:u.regex.isNumber.test(e)?parseFloat(e):e;if("style"==t)return this.style(e);"stroke-width"==t?this.attr("stroke",parseFloat(e)>0?this._stroke:null):"stroke"==t&&(this._stroke=e),("fill"==t||"stroke"==t)&&(u.regex.isImage.test(e)&&(e=this.doc().defs().image(e,0,0)),e instanceof u.Image&&(e=this.doc().defs().pattern(0,0,function(){this.add(e)}))),"number"==typeof e?e=new u.Number(e):u.Color.isColor(e)?e=new u.Color(e):Array.isArray(e)&&(e=new u.Array(e)),"leading"==t?this.leading&&this.leading(e):"string"==typeof i?this.node.setAttributeNS(i,t,e.toString()):this.node.setAttribute(t,e.toString()),!this.rebuild||"font-size"!=t&&"x"!=t||this.rebuild(t,e)}return this},transform:function(t,e){if(0==arguments.length)return this.trans;if("string"==typeof t){if(arguments.length<2)return this.trans[t];var i={};return i[t]=e,this.transform(i)}var i=[];t=o(t);for(e in t)null!=t[e]&&(this.trans[e]=t[e]);return this.trans.matrix=this.trans.a+" "+this.trans.b+" "+this.trans.c+" "+this.trans.d+" "+this.trans.e+" "+this.trans.f,t=this.trans,t.matrix!=u.defaults.matrix&&i.push("matrix("+t.matrix+")"),0!=t.rotation&&i.push("rotate("+t.rotation+" "+(null==t.cx?this.bbox().cx:t.cx)+" "+(null==t.cy?this.bbox().cy:t.cy)+")"),(1!=t.scaleX||1!=t.scaleY)&&i.push("scale("+t.scaleX+" "+t.scaleY+")"),0!=t.skewX&&i.push("skewX("+t.skewX+")"),0!=t.skewY&&i.push("skewY("+t.skewY+")"),(0!=t.x||0!=t.y)&&i.push("translate("+new u.Number(t.x/t.scaleX)+" "+new u.Number(t.y/t.scaleY)+")"),0==i.length?this.node.removeAttribute("transform"):this.node.setAttribute("transform",i.join(" ")),this},style:function(e,i){if(0==arguments.length)return this.node.style.cssText||"";if(arguments.length<2)if("object"==typeof e)for(i in e)this.style(i,e[i]);else{if(!u.regex.isCss.test(e))return this.node.style[t(e)];e=e.split(";");for(var n=0;n<e.length;n++)i=e[n].split(":"),this.style(i[0].replace(/\s+/g,""),i[1])}else this.node.style[t(e)]=null===i||u.regex.isBlank.test(i)?"":i;return this},id:function(t){return this.attr("id",t)},bbox:function(){return new u.BBox(this)},rbox:function(){return new u.RBox(this)},inside:function(t,e){var i=this.bbox();return t>i.x&&e>i.y&&t<i.x+i.width&&e<i.y+i.height},show:function(){return this.style("display","")},hide:function(){return this.style("display","none")},visible:function(){return"none"!=this.style("display")},toString:function(){return this.attr("id")},classes:function(){var t=this.node.getAttribute("class");return null===t?[]:t.trim().split(/\s+/)},hasClass:function(t){return-1!=this.classes().indexOf(t)},addClass:function(t){var e;return this.hasClass(t)||(e=this.classes(),e.push(t),this.node.setAttribute("class",e.join(" "))),this},removeClass:function(t){var e;return this.hasClass(t)&&(e=this.classes().filter(function(e){return e!=t}),this.node.setAttribute("class",e.join(" "))),this},toggleClass:function(t){return this.hasClass(t)?this.removeClass(t):this.addClass(t),this},reference:function(t){return u.get(this.attr(t))},_parent:function(t){for(var e=this;null!=e&&!(e instanceof t);)e=e.parent;return e}}}),u.Parent=u.invent({create:function(t){this.constructor.call(this,t)},inherit:u.Element,extend:{children:function(){return this._children||(this._children=[])},add:function(t,e){return this.has(t)||(e=null==e?this.children().length:e,t.parent&&t.parent.children().splice(t.parent.index(t),1),this.children().splice(e,0,t),this.node.insertBefore(t.node,this.node.childNodes[e]||null),t.parent=this),this._defs&&(this.node.removeChild(this._defs.node),this.node.appendChild(this._defs.node)),this},put:function(t,e){return this.add(t,e),t},has:function(t){return this.index(t)>=0},index:function(t){return this.children().indexOf(t)},get:function(t){return this.children()[t]},first:function(){return this.children()[0]},last:function(){return this.children()[this.children().length-1]},each:function(t,e){var i,n,r=this.children();for(i=0,n=r.length;n>i;i++)r[i]instanceof u.Element&&t.apply(r[i],[i,r]),e&&r[i]instanceof u.Container&&r[i].each(t,e);return this},removeElement:function(t){return this.children().splice(this.index(t),1),this.node.removeChild(t.node),t.parent=null,this},clear:function(){for(var t=this.children().length-1;t>=0;t--)this.removeElement(this.children()[t]);return this._defs&&this._defs.clear(),this},defs:function(){return this.doc().defs()}}}),u.Container=u.invent({create:function(t){this.constructor.call(this,t)},inherit:u.Parent,extend:{viewbox:function(t){return 0==arguments.length?new u.ViewBox(this):(t=1==arguments.length?[t.x,t.y,t.width,t.height]:[].slice.call(arguments),this.attr("viewBox",t))}}}),u.FX=u.invent({create:function(t){this.target=t},extend:{animate:function(t,e,i){var n,s,h,o,a=this.target,l=this;return"object"==typeof t&&(i=t.delay,e=t.ease,t=t.duration),t="="==t?t:null==t?1e3:new u.Number(t).valueOf(),e=e||"<>",l.to=function(t){var i;if(t=0>t?0:t>1?1:t,null==n){n=[];for(o in l.attrs)n.push(o);if(a.morphArray&&(l._plot||n.indexOf("points")>-1)){var u,c=new a.morphArray(l._plot||l.attrs.points||a.array);l._size&&c.size(l._size.width.to,l._size.height.to),u=c.bbox(),l._x?c.move(l._x.to,u.y):l._cx&&c.move(l._cx.to-u.width/2,u.y),u=c.bbox(),l._y?c.move(u.x,l._y.to):l._cy&&c.move(u.x,l._cy.to-u.height/2),delete l._x,delete l._y,delete l._cx,delete l._cy,delete l._size,l._plot=a.array.morph(c)}}if(null==s){s=[];for(o in l.trans)s.push(o)}if(null==h){h=[];for(o in l.styles)h.push(o)}for(t="<>"==e?-Math.cos(t*Math.PI)/2+.5:">"==e?Math.sin(t*Math.PI/2):"<"==e?-Math.cos(t*Math.PI/2)+1:"-"==e?t:"function"==typeof e?e(t):t,l._plot?a.plot(l._plot.at(t)):(l._x?a.x(l._x.at(t)):l._cx&&a.cx(l._cx.at(t)),l._y?a.y(l._y.at(t)):l._cy&&a.cy(l._cy.at(t)),l._size&&a.size(l._size.width.at(t),l._size.height.at(t))),l._viewbox&&a.viewbox(l._viewbox.x.at(t),l._viewbox.y.at(t),l._viewbox.width.at(t),l._viewbox.height.at(t)),l._leading&&a.leading(l._leading.at(t)),i=n.length-1;i>=0;i--)a.attr(n[i],r(l.attrs[n[i]],t));for(i=s.length-1;i>=0;i--)a.transform(s[i],r(l.trans[s[i]],t));for(i=h.length-1;i>=0;i--)a.style(h[i],r(l.styles[h[i]],t));l._during&&l._during.call(a,t,function(e,i){return r({from:e,to:i},t)})},"number"==typeof t&&(this.timeout=setTimeout(function(){var n=(new Date).getTime();l.situation={interval:1e3/60,start:n,play:!0,finish:n+t,duration:t},l.render=function(){if(l.situation.play===!0){var n=(new Date).getTime(),r=n>l.situation.finish?1:(n-l.situation.start)/t;l.to(r),n>l.situation.finish?(l._plot&&a.plot(new u.PointArray(l._plot.destination).settle()),l._loop===!0||"number"==typeof l._loop&&l._loop>1?("number"==typeof l._loop&&--l._loop,l.animate(t,e,i)):l._after?l._after.apply(a,[l]):l.stop()):requestAnimFrame(l.render)}else requestAnimFrame(l.render)},l.render()},new u.Number(i).valueOf())),this},bbox:function(){return this.target.bbox()},attr:function(t,e){if("object"==typeof t)for(var i in t)this.attr(i,t[i]);else{var n=this.target.attr(t);this.attrs[t]=u.Color.isColor(n)?new u.Color(n).morph(e):u.regex.unit.test(n)?new u.Number(n).morph(e):{from:n,to:e}}return this},transform:function(t,e){if(1==arguments.length){t=o(t),delete t.matrix;for(e in t)this.trans[e]={from:this.target.trans[e],to:t[e]}}else{var i={};i[t]=e,this.transform(i)}return this},style:function(t,e){if("object"==typeof t)for(var i in t)this.style(i,t[i]);else this.styles[t]={from:this.target.style(t),to:e};return this},x:function(t){return this._x=new u.Number(this.target.x()).morph(t),this},y:function(t){return this._y=new u.Number(this.target.y()).morph(t),this},cx:function(t){return this._cx=new u.Number(this.target.cx()).morph(t),this},cy:function(t){return this._cy=new u.Number(this.target.cy()).morph(t),this},move:function(t,e){return this.x(t).y(e)},center:function(t,e){return this.cx(t).cy(e)},size:function(t,e){if(this.target instanceof u.Text)this.attr("font-size",t);else{var i=this.target.bbox();this._size={width:new u.Number(i.width).morph(t),height:new u.Number(i.height).morph(e)}}return this},plot:function(t){return this._plot=t,this},leading:function(t){return this.target._leading&&(this._leading=new u.Number(this.target._leading).morph(t)),this},viewbox:function(t,e,i,n){if(this.target instanceof u.Container){var r=this.target.viewbox();this._viewbox={x:new u.Number(r.x).morph(t),y:new u.Number(r.y).morph(e),width:new u.Number(r.width).morph(i),height:new u.Number(r.height).morph(n)}}return this},update:function(t){return this.target instanceof u.Stop&&(null!=t.opacity&&this.attr("stop-opacity",t.opacity),null!=t.color&&this.attr("stop-color",t.color),null!=t.offset&&this.attr("offset",new u.Number(t.offset))),this},during:function(t){return this._during=t,this},after:function(t){return this._after=t,this},loop:function(t){return this._loop=t||!0,this},stop:function(t){return t===!0?(this.animate(0),this._after&&this._after.apply(this.target,[this])):(clearTimeout(this.timeout),this.attrs={},this.trans={},this.styles={},this.situation={},delete this._x,delete this._y,delete this._cx,delete this._cy,delete this._size,delete this._plot,delete this._loop,delete this._after,delete this._during,delete this._leading,delete this._viewbox),this},pause:function(){return this.situation.play===!0&&(this.situation.play=!1,this.situation.pause=(new Date).getTime()),this},play:function(){if(this.situation.play===!1){var t=(new Date).getTime()-this.situation.pause;this.situation.finish+=t,this.situation.start+=t,this.situation.play=!0}return this}},parent:u.Element,construct:{animate:function(t,e,i){return(this.fx||(this.fx=new u.FX(this))).stop().animate(t,e,i)},stop:function(t){return this.fx&&this.fx.stop(t),this},pause:function(){return this.fx&&this.fx.pause(),this},play:function(){return this.fx&&this.fx.play(),this}}}),u.extend(u.Element,u.FX,{dx:function(t){return this.x((this.target||this).x()+t)},dy:function(t){return this.y((this.target||this).y()+t)},dmove:function(t,e){return this.dx(t).dy(e)}}),["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","mouseenter","mouseleave","touchstart","touchmove","touchleave","touchend","touchcancel"].forEach(function(t){u.Element.prototype[t]=function(e){var i=this;return this.node["on"+t]="function"==typeof e?function(){return e.apply(i,arguments)}:null,this}}),u.events={},u.listeners={},u.registerEvent=function(t){u.events[t]||(u.events[t]=new Event(t))},u.on=function(t,e,i){var n=i.bind(t.instance||t);u.listeners[i]=n,t.addEventListener(e,n,!1)},u.off=function(t,e,i){t.removeEventListener(e,u.listeners[i],!1),delete u.listeners[i]},u.extend(u.Element,{on:function(t,e){return u.on(this.node,t,e),this},off:function(t,e){return u.off(this.node,t,e),this},fire:function(t){return this.node.dispatchEvent(u.events[t]),this}}),u.Defs=u.invent({create:"defs",inherit:u.Container}),u.G=u.invent({create:"g",inherit:u.Container,extend:{x:function(t){return null==t?this.trans.x:this.transform("x",t)},y:function(t){return null==t?this.trans.y:this.transform("y",t)},cx:function(t){return null==t?this.bbox().cx:this.x(t-this.bbox().width/2)},cy:function(t){return null==t?this.bbox().cy:this.y(t-this.bbox().height/2)}},construct:{group:function(){return this.put(new u.G)}}}),u.extend(u.Element,{siblings:function(){return this.parent.children()},position:function(){return this.parent.index(this)},next:function(){return this.siblings()[this.position()+1]},previous:function(){return this.siblings()[this.position()-1]},forward:function(){var t=this.position();return this.parent.removeElement(this).put(this,t+1)},backward:function(){var t=this.position();return t>0&&this.parent.removeElement(this).add(this,t-1),this},front:function(){return this.parent.removeElement(this).put(this)},back:function(){return this.position()>0&&this.parent.removeElement(this).add(this,0),this},before:function(t){t.remove();var e=this.position();return this.parent.add(t,e),this},after:function(t){t.remove();var e=this.position();return this.parent.add(t,e+1),this}}),u.Mask=u.invent({create:function(){this.constructor.call(this,u.create("mask")),this.targets=[]},inherit:u.Container,extend:{remove:function(){for(var t=this.targets.length-1;t>=0;t--)this.targets[t]&&this.targets[t].unmask();return delete this.targets,this.parent.removeElement(this),this}},construct:{mask:function(){return this.defs().put(new u.Mask)}}}),u.extend(u.Element,{maskWith:function(t){return this.masker=t instanceof u.Mask?t:this.parent.mask().add(t),this.masker.targets.push(this),this.attr("mask",'url("#'+this.masker.attr("id")+'")')},unmask:function(){return delete this.masker,this.attr("mask",null)}}),u.Clip=u.invent({create:function(){this.constructor.call(this,u.create("clipPath")),this.targets=[]},inherit:u.Container,extend:{remove:function(){for(var t=this.targets.length-1;t>=0;t--)this.targets[t]&&this.targets[t].unclip();return delete this.targets,this.parent.removeElement(this),this}},construct:{clip:function(){return this.defs().put(new u.Clip)}}}),u.extend(u.Element,{clipWith:function(t){return this.clipper=t instanceof u.Clip?t:this.parent.clip().add(t),this.clipper.targets.push(this),this.attr("clip-path",'url("#'+this.clipper.attr("id")+'")')},unclip:function(){return delete this.clipper,this.attr("clip-path",null)}}),u.Gradient=u.invent({create:function(t){this.constructor.call(this,u.create(t+"Gradient")),this.type=t},inherit:u.Container,extend:{from:function(t,e){return this.attr("radial"==this.type?{fx:new u.Number(t),fy:new u.Number(e)}:{x1:new u.Number(t),y1:new u.Number(e)})},to:function(t,e){return this.attr("radial"==this.type?{cx:new u.Number(t),cy:new u.Number(e)}:{x2:new u.Number(t),y2:new u.Number(e)})},radius:function(t){return"radial"==this.type?this.attr({r:new u.Number(t)}):this},at:function(t,e,i){return this.put(new u.Stop).update(t,e,i)},update:function(t){return this.clear(),"function"==typeof t&&t.call(this,this),this},fill:function(){return"url(#"+this.id()+")"},toString:function(){return this.fill()}},construct:{gradient:function(t,e){return this.defs().gradient(t,e)}}}),u.extend(u.Defs,{gradient:function(t,e){return this.put(new u.Gradient(t)).update(e)}}),u.Stop=u.invent({create:"stop",inherit:u.Element,extend:{update:function(t){return("number"==typeof t||t instanceof u.Number)&&(t={offset:arguments[0],color:arguments[1],opacity:arguments[2]}),null!=t.opacity&&this.attr("stop-opacity",t.opacity),null!=t.color&&this.attr("stop-color",t.color),null!=t.offset&&this.attr("offset",new u.Number(t.offset)),this}}}),u.Pattern=u.invent({create:"pattern",inherit:u.Container,extend:{fill:function(){return"url(#"+this.id()+")"},update:function(t){return this.clear(),"function"==typeof t&&t.call(this,this),this},toString:function(){return this.fill()}},construct:{pattern:function(t,e,i){return this.defs().pattern(t,e,i)}}}),u.extend(u.Defs,{pattern:function(t,e,i){return this.put(new u.Pattern).update(i).attr({x:0,y:0,width:t,height:e,patternUnits:"userSpaceOnUse"})}}),u.Doc=u.invent({create:function(t){this.parent="string"==typeof t?document.getElementById(t):t,this.constructor.call(this,"svg"==this.parent.nodeName?this.parent:u.create("svg")),this.attr({xmlns:u.ns,version:"1.1",width:"100%",height:"100%"}).attr("xmlns:xlink",u.xlink,u.xmlns),this._defs=new u.Defs,this._defs.parent=this,this.node.appendChild(this._defs.node),this.doSpof=!1,this.parent!=this.node&&this.stage()},inherit:u.Container,extend:{stage:function(){var t=this;return this.parent.appendChild(this.node),t.spof(),u.on(window,"resize",function(){t.spof()}),this},defs:function(){return this._defs},spof:function(){if(this.doSpof){var t=this.node.getScreenCTM();t&&this.style("left",-t.e%1+"px").style("top",-t.f%1+"px")}return this},fixSubPixelOffset:function(){return this.doSpof=!0,this}}}),u.Shape=u.invent({create:function(t){this.constructor.call(this,t)},inherit:u.Element}),u.Symbol=u.invent({create:"symbol",inherit:u.Container,construct:{symbol:function(){return this.defs().put(new u.Symbol)}}}),u.Use=u.invent({create:"use",inherit:u.Shape,extend:{element:function(t){return this.target=t,this.attr("href","#"+t,u.xlink)}},construct:{use:function(t){return this.put(new u.Use).element(t)}}}),u.Rect=u.invent({create:"rect",inherit:u.Shape,construct:{rect:function(t,e){return this.put((new u.Rect).size(t,e))}}}),u.Ellipse=u.invent({create:"ellipse",inherit:u.Shape,extend:{x:function(t){return null==t?this.cx()-this.attr("rx"):this.cx(t+this.attr("rx"))},y:function(t){return null==t?this.cy()-this.attr("ry"):this.cy(t+this.attr("ry"))},cx:function(t){return null==t?this.attr("cx"):this.attr("cx",new u.Number(t).divide(this.trans.scaleX))},cy:function(t){return null==t?this.attr("cy"):this.attr("cy",new u.Number(t).divide(this.trans.scaleY))},width:function(t){return null==t?2*this.attr("rx"):this.attr("rx",new u.Number(t).divide(2))},height:function(t){return null==t?2*this.attr("ry"):this.attr("ry",new u.Number(t).divide(2))
},size:function(t,e){var i=n(this.bbox(),t,e);return this.attr({rx:new u.Number(i.width).divide(2),ry:new u.Number(i.height).divide(2)})}},construct:{circle:function(t){return this.ellipse(t,t)},ellipse:function(t,e){return this.put(new u.Ellipse).size(t,e).move(0,0)}}}),u.Line=u.invent({create:"line",inherit:u.Shape,extend:{x:function(t){var e=this.bbox();return null==t?e.x:this.attr({x1:this.attr("x1")-e.x+t,x2:this.attr("x2")-e.x+t})},y:function(t){var e=this.bbox();return null==t?e.y:this.attr({y1:this.attr("y1")-e.y+t,y2:this.attr("y2")-e.y+t})},cx:function(t){var e=this.bbox().width/2;return null==t?this.x()+e:this.x(t-e)},cy:function(t){var e=this.bbox().height/2;return null==t?this.y()+e:this.y(t-e)},width:function(t){var e=this.bbox();return null==t?e.width:this.attr(this.attr("x1")<this.attr("x2")?"x2":"x1",e.x+t)},height:function(t){var e=this.bbox();return null==t?e.height:this.attr(this.attr("y1")<this.attr("y2")?"y2":"y1",e.y+t)},size:function(t,e){var i=n(this.bbox(),t,e);return this.width(i.width).height(i.height)},plot:function(t,e,i,n){return this.attr({x1:t,y1:e,x2:i,y2:n})}},construct:{line:function(t,e,i,n){return this.put((new u.Line).plot(t,e,i,n))}}}),u.Polyline=u.invent({create:"polyline",inherit:u.Shape,construct:{polyline:function(t){return this.put(new u.Polyline).plot(t)}}}),u.Polygon=u.invent({create:"polygon",inherit:u.Shape,construct:{polygon:function(t){return this.put(new u.Polygon).plot(t)}}}),u.extend(u.Polyline,u.Polygon,{morphArray:u.PointArray,plot:function(t){return this.attr("points",this.array=new u.PointArray(t,[[0,0]]))},move:function(t,e){return this.attr("points",this.array.move(t,e))},x:function(t){return null==t?this.bbox().x:this.move(t,this.bbox().y)},y:function(t){return null==t?this.bbox().y:this.move(this.bbox().x,t)},width:function(t){var e=this.bbox();return null==t?e.width:this.size(t,e.height)},height:function(t){var e=this.bbox();return null==t?e.height:this.size(e.width,t)},size:function(t,e){var i=n(this.bbox(),t,e);return this.attr("points",this.array.size(i.width,i.height))}}),u.Path=u.invent({create:"path",inherit:u.Shape,extend:{plot:function(t){return this.attr("d",this.array=new u.PathArray(t,[["M",0,0]]))},move:function(t,e){return this.attr("d",this.array.move(t,e))},x:function(t){return null==t?this.bbox().x:this.move(t,this.bbox().y)},y:function(t){return null==t?this.bbox().y:this.move(this.bbox().x,t)},size:function(t,e){var i=n(this.bbox(),t,e);return this.attr("d",this.array.size(i.width,i.height))},width:function(t){return null==t?this.bbox().width:this.size(t,this.bbox().height)},height:function(t){return null==t?this.bbox().height:this.size(this.bbox().width,t)}},construct:{path:function(t){return this.put(new u.Path).plot(t)}}}),u.Image=u.invent({create:"image",inherit:u.Shape,extend:{load:function(t){if(!t)return this;var e=this,i=document.createElement("img");return i.onload=function(){var n=e.doc(u.Pattern);0==e.width()&&0==e.height()&&e.size(i.width,i.height),n&&0==n.width()&&0==n.height()&&n.size(e.width(),e.height()),"function"==typeof e._loaded&&e._loaded.call(e,{width:i.width,height:i.height,ratio:i.width/i.height,url:t})},this.attr("href",i.src=this.src=t,u.xlink)},loaded:function(t){return this._loaded=t,this}},construct:{image:function(t,e,i){return this.put(new u.Image).load(t).size(e||0,i||e||0)}}}),u.Text=u.invent({create:function(){this.constructor.call(this,u.create("text")),this._leading=new u.Number(1.3),this._rebuild=!0,this._build=!1,this.attr("font-family",u.defaults.attrs["font-family"])},inherit:u.Shape,extend:{x:function(t){return null==t?this.attr("x"):(this.textPath||this.lines.each(function(){this.newLined&&this.x(t)}),this.attr("x",t))},y:function(t){var e=this.attr("y"),i="number"==typeof e?e-this.bbox().y:0;return null==t?"number"==typeof e?e-i:e:this.attr("y","number"==typeof t?t+i:t)},cx:function(t){return null==t?this.bbox().cx:this.x(t-this.bbox().width/2)},cy:function(t){return null==t?this.bbox().cy:this.y(t-this.bbox().height/2)},text:function(t){if("undefined"==typeof t)return this.content;if(this.clear().build(!0),"function"==typeof t)t.call(this,this);else{t=(this.content=t).split("\n");for(var e=0,i=t.length;i>e;e++)this.tspan(t[e]).newLine()}return this.build(!1).rebuild()},size:function(t){return this.attr("font-size",t).rebuild()},leading:function(t){return null==t?this._leading:(this._leading=new u.Number(t),this.rebuild())},rebuild:function(t){if("boolean"==typeof t&&(this._rebuild=t),this._rebuild){var e=this;this.lines.each(function(){this.newLined&&(this.textPath||this.attr("x",e.attr("x")),this.attr("dy",e._leading*new u.Number(e.attr("font-size"))))}),this.fire("rebuild")}return this},build:function(t){return this._build=!!t,this}},construct:{text:function(t){return this.put(new u.Text).text(t)},plain:function(t){return this.put(new u.Text).plain(t)}}}),u.TSpan=u.invent({create:"tspan",inherit:u.Shape,extend:{text:function(t){return"function"==typeof t?t.call(this,this):this.plain(t),this},dx:function(t){return this.attr("dx",t)},dy:function(t){return this.attr("dy",t)},newLine:function(){var t=this.doc(u.Text);return this.newLined=!0,this.dy(t._leading*t.attr("font-size")).attr("x",t.x())}}}),u.extend(u.Text,u.TSpan,{plain:function(t){return this._build===!1&&this.clear(),this.node.appendChild(document.createTextNode(this.content=t)),this},tspan:function(t){var e=(this.textPath||this).node,i=new u.TSpan;return this._build===!1&&this.clear(),e.appendChild(i.node),i.parent=this,this instanceof u.Text&&this.lines.add(i),i.text(t)},clear:function(){for(var t=(this.textPath||this).node;t.hasChildNodes();)t.removeChild(t.lastChild);return this instanceof u.Text&&(delete this.lines,this.lines=new u.Set,this.content=""),this},length:function(){return this.node.getComputedTextLength()}}),u.registerEvent("rebuild"),u.TextPath=u.invent({create:"textPath",inherit:u.Element,parent:u.Text,construct:{path:function(t){for(this.textPath=new u.TextPath;this.node.hasChildNodes();)this.textPath.node.appendChild(this.node.firstChild);return this.node.appendChild(this.textPath.node),this.track=this.doc().defs().path(t),this.textPath.parent=this,this.textPath.attr("href","#"+this.track,u.xlink),this},plot:function(t){return this.track&&this.track.plot(t),this}}}),u.Nested=u.invent({create:function(){this.constructor.call(this,u.create("svg")),this.style("overflow","visible")},inherit:u.Container,construct:{nested:function(){return this.put(new u.Nested)}}}),u.A=u.invent({create:"a",inherit:u.Container,extend:{to:function(t){return this.attr("href",t,u.xlink)},show:function(t){return this.attr("show",t,u.xlink)},target:function(t){return this.attr("target",t)}},construct:{link:function(t){return this.put(new u.A).to(t)}}}),u.extend(u.Element,{linkTo:function(t){var e=new u.A;return"function"==typeof t?t.call(e,e):e.to(t),this.parent.put(e).put(this)}}),u.Marker=u.invent({create:"marker",inherit:u.Container,extend:{width:function(t){return this.attr("markerWidth",t)},height:function(t){return this.attr("markerHeight",t)},ref:function(t,e){return this.attr("refX",t).attr("refY",e)},update:function(t){return this.clear(),"function"==typeof t&&t.call(this,this),this},toString:function(){return"url(#"+this.id()+")"}},construct:{marker:function(t,e,i){return this.defs().marker(t,e,i)}}}),u.extend(u.Defs,{marker:function(t,e,i){return this.put(new u.Marker).size(t,e).ref(t/2,e/2).viewbox(0,0,t,e).attr("orient","auto").update(i)}}),u.extend(u.Line,u.Polyline,u.Polygon,u.Path,{marker:function(t,e,i,n){var r=["marker"];return"all"!=t&&r.push(t),r=r.join("-"),t=arguments[1]instanceof u.Marker?arguments[1]:this.doc().marker(e,i,n),this.attr(r,t)}});var l={stroke:["color","width","opacity","linecap","linejoin","miterlimit","dasharray","dashoffset"],fill:["color","opacity","rule"],prefix:function(t,e){return"color"==e?t:t+"-"+e}};["fill","stroke"].forEach(function(t){var e,i={};i[t]=function(i){if("string"==typeof i||u.Color.isRgb(i)||i&&"function"==typeof i.fill)this.attr(t,i);else for(e=l[t].length-1;e>=0;e--)null!=i[l[t][e]]&&this.attr(l.prefix(t,l[t][e]),i[l[t][e]]);return this},u.extend(u.Element,u.FX,i)}),u.extend(u.Element,u.FX,{rotate:function(t,e,i){return this.transform({rotation:t||0,cx:e,cy:i})},skew:function(t,e){return this.transform({skewX:t||0,skewY:e||0})},scale:function(t,e){return this.transform({scaleX:t,scaleY:null==e?t:e})},translate:function(t,e){return this.transform({x:t,y:e})},matrix:function(t){return this.transform({matrix:t})},opacity:function(t){return this.attr("opacity",t)}}),u.extend(u.Rect,u.Ellipse,u.FX,{radius:function(t,e){return this.attr({rx:t,ry:e||t})}}),u.extend(u.Path,{length:function(){return this.node.getTotalLength()},pointAt:function(t){return this.node.getPointAtLength(t)}}),u.extend(u.Parent,u.Text,u.FX,{font:function(t){for(var e in t)"leading"==e?this.leading(t[e]):"anchor"==e?this.attr("text-anchor",t[e]):"size"==e||"family"==e||"weight"==e||"stretch"==e||"variant"==e||"style"==e?this.attr("font-"+e,t[e]):this.attr(e,t[e]);return this}}),u.Set=u.invent({create:function(){this.clear()},extend:{add:function(){var t,e,i=[].slice.call(arguments);for(t=0,e=i.length;e>t;t++)this.members.push(i[t]);return this},remove:function(t){var e=this.index(t);return e>-1&&this.members.splice(e,1),this},each:function(t){for(var e=0,i=this.members.length;i>e;e++)t.apply(this.members[e],[e,this.members]);return this},clear:function(){return this.members=[],this},has:function(t){return this.index(t)>=0},index:function(t){return this.members.indexOf(t)},get:function(t){return this.members[t]},first:function(){return this.get(0)},last:function(){return this.get(this.members.length-1)},valueOf:function(){return this.members},bbox:function(){var t=new u.BBox;if(0==this.members.length)return t;var e=this.members[0].rbox();return t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,this.each(function(){t=t.merge(this.rbox())}),t}},construct:{set:function(){return new u.Set}}}),u.SetFX=u.invent({create:function(t){this.set=t}}),u.Set.inherit=function(){var t,e=[];for(var t in u.Shape.prototype)"function"==typeof u.Shape.prototype[t]&&"function"!=typeof u.Set.prototype[t]&&e.push(t);e.forEach(function(t){u.Set.prototype[t]=function(){for(var e=0,i=this.members.length;i>e;e++)this.members[e]&&"function"==typeof this.members[e][t]&&this.members[e][t].apply(this.members[e],arguments);return"animate"==t?this.fx||(this.fx=new u.SetFX(this)):this}}),e=[];for(var t in u.FX.prototype)"function"==typeof u.FX.prototype[t]&&"function"!=typeof u.SetFX.prototype[t]&&e.push(t);e.forEach(function(t){u.SetFX.prototype[t]=function(){for(var e=0,i=this.set.members.length;i>e;e++)this.set.members[e].fx[t].apply(this.set.members[e].fx,arguments);return this}})},u.extend(u.Element,{data:function(t,e,i){if("object"==typeof t)for(e in t)this.data(e,t[e]);else if(arguments.length<2)try{return JSON.parse(this.attr("data-"+t))}catch(n){return this.attr("data-"+t)}else this.attr("data-"+t,null===e?null:i===!0||"string"==typeof e||"number"==typeof e?e:JSON.stringify(e));return this}}),u.extend(u.Element,{remember:function(t,e){if("object"==typeof arguments[0])for(var e in t)this.remember(e,t[e]);else{if(1==arguments.length)return this.memory()[t];this.memory()[t]=e}return this},forget:function(){if(0==arguments.length)this._memory={};else for(var t=arguments.length-1;t>=0;t--)delete this.memory()[arguments[t]];return this},memory:function(){return this._memory||(this._memory={})}}),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}()}).call(i.exports)});
;define("detail:widget/kandian/kandian_new.js",function(t,i,e){var n=t("common:static/vendor/underscore/underscore.js"),a=t("detail:widget/kandian/svgjs.js").SVG;a.easing={bounceOut:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}};var s=n.template(['<a href="/recommend/<%=type%>/?kw=<%=encodeKey%>" static="stp=<%=encodeURI(keyword)%>"',' class="kd-item <%if (keyword.length>=4){%>kd-item-large<%}%>" target="_blank">',"<%=keyword.substr(0, 4)%>","</a>"].join(""));$.extend($.easing,{easeOutBounce:function(t,i,e,n,a){return(i/=a)<1/2.75?7.5625*n*i*i+e:2/2.75>i?n*(7.5625*(i-=1.5/2.75)*i+.75)+e:2.5/2.75>i?n*(7.5625*(i-=2.25/2.75)*i+.9375)+e:n*(7.5625*(i-=2.625/2.75)*i+.984375)+e}});var o=function(t,i,e){this.focus=t,this.eleWrap=i,this.type=e,this.initFocusDom()};n.extend(o.prototype,{initCanvas:function(){this.canvas=a(this.eleWrap),this.canvas.width(260).height(132)},initFocusSvg:function(){var t=this.focus,i=this.type;this.canvas||this.initCanvas();var e=this.canvas,a=this.groups||(this.groups=[]),s=e.width()/2,o=e.height()/2,c=~navigator.userAgent.indexOf("Firefox")?[0,0]:[0,5];n.each(t,function(t,n){if(n>5)return!1;var r=t[0].length>=4?28:25,h=e.group(),u=h.link("/recommend/"+i+"/?kw="+t[1]).attr("static","stp="+encodeURI(t[0])),d=(u.circle(2*r).fill("#d7e7ff"),u.text("").tspan(t[0].substr(0,4)));u.attr("target","_blank"),h.center(s,o),d.center(r+c[0],r+c[1]),a.push(h)}),this.moveCircles()},pos:[[220,30],[40,105],[93,81],[194,102],[30,36],[100,30],[158,46]],getRandomPos:function(){var t=Math.floor(Math.random()*this.pos.length);return this.pos.splice(t,1)[0]},posList:[],moveCircles:function(){var t=this,i=this.groups.length;n.each(this.groups,function(e,n){var s=t.getRandomPos();t.posList.push(s),e.vX=s[0],e.vY=s[1],e.animate(800,a.easing.bounceOut,3e3).center(s[0],s[1]).after(function(){n+1>=i&&t.initLine()})})},initLine:function(){{var t=this.canvas,i=(this.groups||(this.groups=[]),t.width()/2),e=t.height()/2;t.circle(8).center(i,e).fill("#ccc")}n.each(this.groups,function(n){new a.Array([i,e,n.vX,n.vY]);t.line(i,e,n.vX,n.vY).back().stroke({color:"#ddd",width:1})})},initFocusDom:function(){var t=$(this.eleWrap),i=this;n.each(this.focus,function(e,n){if(!(n>5)){var a=$(s({keyword:e[0],encodeKey:e[1],type:i.type}));a.appendTo(t)}}),setTimeout(function(){i.moveCirclesDom()},2e3)},moveCirclesDom:function(){var t=$(this.eleWrap).find(".kd-item"),i=this;t.each(function(){var t=i.getRandomPos();$(this).animate({left:t[0]-25,top:t[1]-25},800,"easeOutBounce")})}}),e.exports=function(t,i,e){var n={video:{movie:"movie",tv:"tvplay",comic:"comic",tamasha:"tvplay"},hao123:{movie:"dianying",tv:"dianshi",comic:"dongman",tamasha:"dianshi"},duba:{movie:"dianying",tv:"dianshi",comic:"dongman",tamasha:"dianshi"}};new o(t,$("#j-focus-wrap")[0],n[e][i]||"movie")}});
;define("detail:widget/mixcut/mixcut.js",function(require,exports,module){function init(opt){var elem=$("#"+opt.id),tab=$(".j-nav-wrap").find("[href=#mixcut]"),types={movie:"1",tv:"2",show:"3",comic:"4"},type=opt.type,typeId=types[type],temp=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="";var videoid=videoid||"";__p+="\n";var onepage=onepage,items=items,total=items.length,pagenum=Math.ceil(total/onepage);__p+='\n<!-- Indicators -->\n<!-- Wrapper for slides -->\n<div class="carousel-inner" role="listbox">\n    ';for(var j=0;pagenum>j;j++){__p+='\n        <div class="item ',0==j&&(__p+="active"),__p+=' hide-overflow">\n            <ul >\n                ';for(var n=0;onepage>n;n++){if(__p+="\n                    ",total>j*onepage+n){__p+="\n                    ";var item=items[j*onepage+n];__p+="\n                    <li ",n==onepage-1&&(__p+='class="last sub-item"'),__p+='>\n                        <a href="'+(null==(__t=item.url)?"":__t)+'" target="_blank" static="stp=po&videoid='+(null==(__t=videoid)?"":__t)+'" title="'+(null==(__t=item.title)?"":__t)+'" class="item-a view-box prevue-work-twoline">\n                            <span class="view">\n                                <img class="item-img" src="'+(null==(__t=item.imgh_url)?"":__t)+'"/>\n                                <span class="info-bg"></span>\n                                <span class="info">'+(null==(__t=formatDuration(item.duration))?"":__t)+'</span>\n                                <span class="s-mask"></span>\n                                <span class="s-play"></span>\n                            </span>\n                            <span class="title prevue-work-twoline-title">'+(null==(__t=$.string.widthstr(item.title,23))?"":__t)+"</span>\n                        </a>\n                    </li>\n                    "}__p+="\n                "}__p+="\n            </ul>\n        </div>\n    "}__p+="\n</div>\n\n<!-- Controls -->\n",pagenum>1&&(__p+='\n<a class="left carousel-control" href="#mixcut-carousel" role="button" data-slide="prev" static="stp=left"></a>\n<a class="right carousel-control" href="#mixcut-carousel" role="button" data-slide="next" static="stp=right"></a>\n<div class="carousel-page-info"><i>1</i><b>/'+(null==(__t=pagenum)?"":__t)+"</b></div>\n"),__p+=""}return __p},videoId=opt.videoid;$.ajax("http://v.baidu.com/videoapi?format=json&page_name=newhot_tvshow&block_sign=list_hunjian_video",{dataType:"jsonp",success:function(e){e=e[0].data.videos;var t=_.filter(e,function(e){return e.id===videoId&&e.stream_type===typeId});return t.length<1?(elem.remove(),void tab.remove()):(elem.removeClass("hide"),elem.find(".content").eq(0).html(temp({items:t,onepage:5,videoid:videoId,formatDuration:formatDuration})),void(elem.find(".item").length&&(elem.carousel({interval:0}),elem.on("slid.bs.carousel",function(){var e=$(this),t=e.find(".item.active").index()+1;e.find(".carousel-page-info i").text(t)}))))}})}require("common:static/vendor/bootstrap/js/carousel.js");var _=require("common:static/vendor/underscore/underscore.js"),formatDuration=function(e){if(!e)return"";var t=[parseInt(e/60/60,10),Math.floor(e/60%60),e%60];return 3600>e&&t.shift(),t.join(":").replace(/\b(\d)\b/g,"0$1")};exports.init=init});
;define("detail:widget/news/news.js",function(require,exports,module){var Base=require("common:static/ui/oo/klass.js"),_=Base._,viewHotnews=Base.CC.sub({init:function(t){this.getData(),this.opt=t},tpls:{hotnews:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+='<ul class="hotnews-list clearfix">\n	';var video;__p+="\n	";for(var i=0,l=Math.min(videos.length,limit);l>i;i++)__p+="\n	",video=videos[i],__p+='\n	<li class="hotnews-item',i>l-3&&(__p+=" hotnews-item-last"),__p+='">\n		<a href="',__p+=siteType&&"hao123"===siteType?""+(null==(__t=video.hao123_url)?"":__t):""+(null==(__t=video.url)?"":__t),__p+='" class="view-box" static="bl=hotnews&idx='+(null==(__t=i+1)?"":__t)+'" target="_blank" title="'+(null==(__t=video.title)?"":__t)+'">\n			<div class="view">\n				<img src="'+(null==(__t=video.imgh_url)?"":__t)+'" alt="'+(null==(__t=video.title)?"":__t)+'">\n				<span class="info-bg"></span>\n				<span class="s-play"></span>\n				<span class="info">\n					'+(null==(__t=video.duration)?"":__t)+'\n				</span>\n			</div>\n			<div class="title">'+(null==(__t=video.title)?"":__t)+"</div>\n		</a>\n	</li>\n	";__p+="\n</ul>"}return __p}},rules:{index_focus_poster_big:{exclude:{start:7,length:2}},index_focus_poster_small:{exclude:{start:7,length:1}},index_show_hot_info:{exclude:{start:5,length:3}}},handleData:function(t,e){var i,n=[],s=this;return _.each(t,function(t){var l=t.data.videos;if(l&&l.length)if(e)for(var o=0,a=l.length;a>o;o++)~l[o].url.indexOf(e)?(n.push(l.splice(o,1)[0]),--a,--o):~l[o].url.indexOf("http://baidu.")||(l.splice(o,1),--a,--o);else(i=s.rules[t.name])&&i.exclude&&(l.splice(i.exclude.start,i.exclude.length),Array.prototype.push.apply(n,l))}),n},getData:function(){var t="http://v.baidu.com/staticapi/hotnews_new.json?callback=hotnews_cb",e=this;$.ajax({url:t,dataType:"jsonp",jsonpCallback:"hotnews_cb",success:function(t){if(t&&t.length){var i=e.handleData(t);e.show(i)}}})},show:function(t){this.el.html(this.getTpl("hotnews")({videos:t,siteType:this.opt.siteType,limit:8*this.opt.pnNum})),this.opt.pnNum>1&&this.initScroll()},initScroll:function(){var t=this.el.find(".hotnews-list"),e=4*t.find("li").outerHeight(!0);this.el.height(e);var i,n=t.height(),s=function(l){if(l)return void(i=setTimeout(s,6e3));var o=parseInt(t.css("margin-top"),10)||0;Math.abs(o)+e>=n?o=0:o-=e,t.stop().animate({"margin-top":o},300),i=setTimeout(s,6e3)};s(!0),this.el.on("mouseover",function(){clearTimeout(i)}).on("mouseleave",function(){s(!0)})}});module.exports=viewHotnews});
;define("detail:widget/paysite/paysite.js",function(require,exports,module){var brandSite,T=$,ec=require("common:static/ui/eventcenter/eventcenter.js"),_=require("common:static/vendor/underscore/underscore.js"),fromSites=(require("common:static/ui/adjust/adjust.js"),"video"),sourceTypes="",paySite={},inited=!1,moreSite={},pageTn="moviedetail";moreSite.template=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){if(__p+="",sites.length>1){__p+='\n<p class="paysites-list moresite-newStyle">\n    <span>全部付费资源：</span>\n    ';for(var i=0,l=sites.length;l>i;i++)__p+="\n        ",site=helper.convert(sites[i]),__p+='\n        <a href="#" title="'+(null==(__t=site.sitename)?"":__t)+'" target="_blank" class="site-try ',cur===i&&(__p+="site-try-current"),__p+='" static="stp=switch&ext=try&site='+(null==(__t=site.site)?"":__t)+"&n="+(null==(__t=i)?"":__t)+'" style="background-image:url('+(null==(__t=site.src)?"":__t)+');" data-idx="'+(null==(__t=i)?"":__t)+'">'+(null==(__t=site.sitename)?"":__t)+"</a>\n    ";__p+="\n    </p>\n"}__p+=""}return __p},paySite.helper={convert:function(t){var e={src:"",title:"",price:"",period:"",tryTime:"",url:""},i=parseInt(t.freelooktime,10)||0,s=t.site.split("."),n=3===s.length?s[1]:s[0];"wasu.cn"===t.site&&(n="huashu"),e.tryTime="免费观看<b>"+Math.floor(i/60)+"</b>分钟",e.src=T.stringFormat("http://vs3.bdstatic.com/logo/#{0}.gif",n),e.bigsrc=T.stringFormat("http://vs3.bdstatic.com/logo/big/#{0}.png",n);var r=parseInt(t.paywatchdays,10)||0;-1===r||r>=1e5?e.period="永久有效":r>0&&(e.period="有效期"+r+"天"),T.extend(e,t),1===+t.payment&&0===parseInt(t.price,10)?(e.price="<b>"+t.sitename+"</b>",e.period="包月",e.tryTime="付费观看"):e.price="<b>&yen;</b>"+parseInt(t.price,10);var a="&page="+pageTn+"&pay=1";return"hao123"===fromSites?(a+="&frp=v.hao123.com/dianying_intro/",a+=t&&t.site&&"iqiyi.com"===t.site?"&fv=534cea53c5350b116c9065c7fada7707&vfm=f_224_hao1":"&vfm=bdvtx"):(a+="&frp=v.baidu.com/movie_intro/",t&&t.site&&"iqiyi.com"===t.site&&(a+="&fc=80a6be5a674c94d0&fv=p_02_02"),a+=t.site===brandSite?"&vfm=bdvppzq":"&vfm=bdvtx"),e.url+=a,e}},paySite.render=function(sites,cur){var me=this;if("hao123"===fromSites&&sourceTypes&&"movie"===sourceTypes&&sites){if(me.template=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="";var site=helper.convert(sites[cur]);__p+='\n<a href="'+(null==(__t=site.url)?"":__t)+'" target="_blank" static="stp=play&ext=try&site='+(null==(__t=site.site)?"":__t)+'" class="btn-paysite btn-paysite-hao123" title="'+(null==(__t=site.sitename)?"":__t)+'">\n    <p class="site-name">\n        <img src="'+(null==(__t=site.bigsrc)?"":__t)+'" onerror="this.src=\''+(null==(__t=site.src)?"":__t)+"';this.onerror=null;\">\n    </p>\n    ",site.site&&"iqiyi.com"===site.site&&(__p+='\n        <span class="iqiyi-vip-mask" style="display:none;"></span>\n    '),__p+="\n</a>\n"}return __p},sites.length&&sites.length>1){var newHtml=moreSite.template({sites:sites,T:T,helper:me.helper,cur:cur||0});$(".moresite-newStyle")&&$(".moresite-newStyle").length>0&&$(".moresite-newStyle").remove(),$("#playButtons").append(newHtml)}}else{var siteIndex=-1,curSite=_.find(sites,function(t,e){return siteIndex=e,t.site===brandSite});curSite&&($("#video-brand").text(curSite.sitename+"全网首播").show().attr("href",curSite.url),sites.splice(siteIndex,1),sites.unshift(curSite)),me.template=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="";var site=helper.convert(sites[cur]);if(__p+='\n<a href="'+(null==(__t=site.url)?"":__t)+'" target="_blank" static="stp=play&ext=try&site='+(null==(__t=site.site)?"":__t)+'" class="btn-paysite" title="'+(null==(__t=site.sitename)?"":__t)+'">\n    <p class="site-name">\n        <span class="site-cost"><img src="'+(null==(__t=site.bigsrc)?"":__t)+'" onerror="this.src=\''+(null==(__t=site.src)?"":__t)+"';this.onerror=null;\">"+(null==(__t=site.price)?"":__t)+"</span>\n        ",site.period&&(__p+='\n        <span class="site-period">('+(null==(__t=site.period)?"":__t)+")</span>\n        "),__p+='\n    </p>\n    <p class="try-time">'+(null==(__t=site.tryTime)?"":__t)+"</p>\n</a>\n",sites.length>1){__p+='\n<p class="paysites-list">\n    <span>全部付费资源：</span>\n    ';for(var i=0,l=sites.length;l>i;i++)__p+="\n        ",site=helper.convert(sites[i]),__p+='\n        <a href="#" title="'+(null==(__t=site.sitename)?"":__t)+'" target="_blank" class="site-try ',cur===i&&(__p+="site-try-current"),__p+='" static="stp=switch&ext=try&site='+(null==(__t=site.site)?"":__t)+"&n="+(null==(__t=i)?"":__t)+'" style="background-image:url('+(null==(__t=site.src)?"":__t)+');" data-idx="'+(null==(__t=i)?"":__t)+'">'+(null==(__t=site.sitename)?"":__t)+"</a>",l-1>i&&(__p+=" &gt; "),__p+="\n    ";__p+="\n</p>\n"}__p+=""}return __p}}var html=me.template({sites:sites,T:T,helper:me.helper,cur:cur||0});me.el.html(html)},paySite.getEl=function(){var t=$("#pay-sites");return t},paySite.init=function(t){var e=this;e.hasVip=!1,inited=!0,e.data=t,e.data.length&&(e.el=e.getEl(),e.render(e.data.slice(0,4)),e.el.fadeIn(200),$("#playButtons").on("click",".site-try",function(t){t.preventDefault();var i=$(t.currentTarget),s=i.data("idx");i.hasClass("site-try-current")||e.render(e.data.slice(0,4),+s)}),$("#movie-intro").on("click",".site-try",function(t){t.preventDefault();var i=$(t.currentTarget),s=i.data("idx");i.hasClass("site-try-current")||e.render(e.data.slice(0,4),+s)}),0!==$("#movie-intro").length&&0===e.data.length&&$("#j-play-btn").show(),$("#pay-sites").on("mouseover",".btn-paysite",function(t){t.preventDefault(),$(".iqiyi-vip-mask").show()}),$("#pay-sites").on("mouseleave",".btn-paysite",function(t){t.preventDefault(),$(".iqiyi-vip-mask").hide()}),$("#poster").append('<span class="paysite"></span>'))},module.exports=function(t){fromSites=t.data,pageTn=t.pageTn,sourceTypes=t.sourceTypes,brandSite=t.brandSite},ec.attach("priceLoad",function(t){var e=_.clone(t.data&&t.data.data||[]);$(function(){if(!inited){{location.href.search("fr=psvip")>0}paySite.init(e)}})})});
;define("detail:widget/pgcvideo/pgcvideo.js",function(require,exports,module){var Base=require("common:static/ui/oo/klass.js");require("common:static/vendor/bootstrap/js/transition.js"),require("common:static/vendor/bootstrap/js/carousel.js");var _=Base._,ViewPGC=Base.CC.sub({init:function(e){this.opt=e,this.render()},tpls:{pgcvideo:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="";var videoid=videoid||"";__p+="\n";var onepage=onepage,items=items,total=items.length,pagenum=Math.ceil(total/onepage);__p+='\n\n<div class="carousel-inner" role="listbox">\n    ';for(var j=0;pagenum>j;j++){__p+='\n        <div class="item ',0==j&&(__p+="active"),__p+=' hide-overflow">\n            <ul >\n                ';for(var n=0;onepage>n;n++){if(__p+="\n                    ",total>j*onepage+n){__p+="\n                    ";var item=items[j*onepage+n];__p+='\n                    <li class="pgc-sug-item ',n==onepage-1&&(__p+="last"),__p+=" ",n==onepage-2&&(__p+="last2"),__p+='" >\n                        <a href="'+(null==(__t=item.link)?"":__t)+'" target="_blank" static="stp=po&videoid='+(null==(__t=videoid)?"":__t)+'" title="'+(null==(__t=item.title)?"":_.escape(__t))+'" class="item-a view-box prevue-work-twoline">\n                            <span class="view">\n                                <img class="item-img" src="'+(null==(__t=item.image_link)?"":__t)+'"/>\n                                <span class="info-bg"></span>\n                                <span class="info">'+(null==(__t=formatDuration(item.duration))?"":__t)+'</span>\n                                <span class="s-mask"></span>\n                                <span class="s-play"></span>\n                                <span class="pgc-img">\n                                    <img src="',__p+=item.channel_image_link?""+(null==(__t=item.channel_image_link)?"":__t):"http://list.video.baidu.com/default-icon.png",__p+='">\n                                </span>\n                                <span class="pgc-author-name">'+(null==(__t=item.channel_display_title)?"":_.escape(__t))+'</span>\n                            </span>\n                            <span class="title prevue-work-twoline-title">'+(null==(__t=$.string.widthstr(item.title,22))?"":__t)+'</span>\n                        </a>\n                        <a class="pgc-author-title" href="http://v.baidu.com/i/list?tag='+(null==(__t=item.channel_title)?"":_.escape(__t))+'" target="_blank" title="'+(null==(__t=item.channel_display_title)?"":__t)+'">'+(null==(__t=item.channel_display_title)?"":__t)+'</a>\n                        <span class="pgc-author-subscribe" data-name="'+(null==(__t=item.channel_title)?"":_.escape(__t))+'">订阅</span>\n                        <span class="pgc-author-unsubscribe hide" data-name="'+(null==(__t=item.channel_title)?"":_.escape(__t))+'">\n                            <span class="normal-status">已订阅</span>\n                            <span class="hover-status">取消</span>\n                        </span>\n                    </li>\n                    '}__p+="\n                "}__p+="\n            </ul>\n        </div>\n    "}__p+="\n</div>\n\n",pagenum>1&&(__p+='\n<a class="left carousel-control" href="#block-pgcvideo" role="button" data-slide="prev" static="stp=left"></a>\n<a class="right carousel-control" href="#block-pgcvideo" role="button" data-slide="next" static="stp=right"></a>\n<div class="carousel-page-info"><i>1</i><b>/'+(null==(__t=pagenum)?"":__t)+"</b></div>\n"),__p+="\n"}return __p}},elements:{".block-content":"elContent"},events:{"click .pgc-author-subscribe":"onSubscribe","click .pgc-author-unsubscribe":"onUnsubscribe"},getData:function(e){var t=this.opt;$.ajax({url:"http://v.baidu.com/"+t.type+"_intro/?callback=?",data:{dtype:"relatedsvideo",service:"json",id:t.videoid,limit:10},dataType:"jsonp",success:function(t){t&&0===+t.errno&&t.data&&t.data.length&&e(t.data)}})},formatDuration:function(e){var t=[parseInt(e/60/60,10),Math.floor(e/60%60),e%60];return 3600>e&&t.shift(),t.join(":").replace(/\b(\d)\b/g,"0$1")},render:function(){var e=this;this.getData(function(t){var n=e.getTpl("pgcvideo")({items:t,videoid:e.opt.videoid,onepage:5,formatDuration:e.formatDuration});e.elContent.html(n),e.el.show(),e.el.find(".item").length&&(e.el.carousel({interval:0}),e.el.on("slid.bs.carousel",function(){var e=$(this),t=e.find(".item.active").index()+1;e.find(".carousel-page-info i").text(t)}))})},onSubscribe:function(e){var t=$(e.currentTarget),n=t.data("name"),a=this;e.preventDefault(),Base.Observer.trigger("subscribeChannel",n,function(e){1===e&&(a.el.find(".pgc-author-subscribe[data-name="+n+"]").addClass("hide"),a.el.find(".pgc-author-unsubscribe[data-name="+n+"]").removeClass("hide"))})},onUnsubscribe:function(e){var t=$(e.currentTarget),n=t.data("name"),a=this;e.preventDefault(),Base.Observer.trigger("unsubscribeChannel",n,function(e){0===e&&(a.el.find(".pgc-author-subscribe[data-name="+n+"]").removeClass("hide"),a.el.find(".pgc-author-unsubscribe[data-name="+n+"]").addClass("hide"))})}});module.exports=function(e){new ViewPGC(e)}});
;define("detail:widget/piao/piao.js",function(require,exports,module){var _=require("common:static/vendor/underscore/underscore.js"),Tickets=module.exports=function(t){this.opt=$.extend(!0,{videoId:0,cityId:0,areaId:0,cinemaId:0},t),this.init()};$.extend(Tickets.prototype,{api:_.template("/ticket/cinema?video_id=<%=videoId%>&city=<%=cityId%>&label=B&area=<%=areaId%>&cinema=<%=cinemaId%>&callback=?"),tpls:{piao:function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<div class="tickets-help">\n	<p class="contact">客服:4000998998 <a href="/user/ticketlist/" target="_blank" id="ucLink" static="stp=uc">进入个人中心</a></p>\n	<p>本服务由百度电影票倾情为您提供</p>\n</div>\n<div class="tickets-select">\n	<div class="tickets-city j-city-select">\n		<span class="city"></span><b class="arrow"></b>\n		<div class="j-t-city-list"></div>\n	</div>\n	<div class="tickets-meta tickets-area">\n		<label class="area">地区：</label>\n		<div class="tickets-meta-list clearfix j-t-area-list"></div>\n		<a href="#" class="more" static="stp=amore">更多</a>\n	</div>\n	<div class="tickets-meta tickets-cinemas">\n		<label class="cinema">影院：</label>\n		<div class="tickets-meta-list clearfix j-t-cinema-list"></div>\n		<a href="#" class="more" static="cmore">更多</a>\n	</div>\n</div>\n<div class="tickets-loading j-tickets-loading">正在加载，请稍后...</div>\n<div class="tickets-sessions j-t-ticket-list"></div>';return __p},areas:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="";var area;if(__p+="\n",areas&&areas.length){__p+="\n";for(var i=0,l=areas.length;l>i;i++)__p+="\n",area=areas[i],__p+='\n<a href="#" ',area.id==opt.areaId&&(__p+='class="current"'),__p+=' data-areaid="'+(null==(__t=area.id)?"":__t)+'" static="stp=ft_areas&amp;areaid='+(null==(__t=area.id)?"":__t)+'">'+(null==(__t=area.name)?"":__t)+"</a>\n";__p+="\n"}__p+=""}return __p},cinemas:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="";var cinema;if(__p+="\n",cinemas&&cinemas.length){__p+="\n	";for(var i=0,l=cinemas.length;l>i;i++)__p+="\n	",cinema=cinemas[i],__p+='\n	<a href="#" ',cinema.id==opt.cinemaId&&(__p+='class="current"'),__p+=' data-cinemaid="'+(null==(__t=cinema.id)?"":__t)+'" static="stp=ft_cinemas&amp;cinemaid='+(null==(__t=cinema.id)?"":__t)+'">'+(null==(__t=cinema.name)?"":__t)+"</a>\n	";__p+="\n"}else __p+="\n	<span>",__p+=error?""+(null==(__t=error)?"":__t):"没有上映的电影院",__p+="</span>\n";__p+=""}return __p},citylist:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+='<div class="city-list j-city-list-wrap">\n	<h6>热门城市</h6>\n	';var city,list;__p+='\n	<ul class="hot-city clearfix" static="stp=hct">\n		';for(var i=0,l=hotcities.length;l>i;i++)__p+="\n		",city=hotcities[i],__p+="\n		<li",city.id==opt.cityId&&(__p+=' class="selected"'),__p+=' data-id="'+(null==(__t=city.id)?"":__t)+'" static="cityid='+(null==(__t=city.id)?"":__t)+'">'+(null==(__t=city.name)?"":__t)+"</li>\n		";__p+='\n	</ul>\n	<h6>所有城市</h6>\n	<div class="label-wp clearfix" static="stp=py">\n		';for(var i=0,l=allcities.length;l>i;i++)__p+='\n		<a href="#" data-router="'+(null==(__t=allcities[i].pinyin)?"":__t)+'" ',0==i&&(__p+='class="selected"'),__p+=' static="py='+(null==(__t=allcities[i].pinyin)?"":__t)+'">'+(null==(__t=allcities[i].pinyin)?"":__t)+"</a>\n		";__p+="\n	</div>\n	";for(var i=0,l=allcities.length;l>i;i++){__p+="\n	",list=allcities[i].cities,__p+='\n	<ul class="city-item clearfix ',0==i&&(__p+="selected"),__p+='" data-to="'+(null==(__t=allcities[i].pinyin)?"":__t)+'" static="stp=nct">\n		';for(var j=0,k=list.length;k>j;j++)__p+="\n		",city=list[j],__p+="\n		<li",city.id==opt.cityId&&(__p+=' class="selected"'),__p+=' data-id="'+(null==(__t=city.id)?"":__t)+'" static="cityid='+(null==(__t=city.id)?"":__t)+'">'+(null==(__t=city.name)?"":__t)+"</li>\n		";__p+="\n	</ul>\n	"}__p+="\n</div>"}return __p},tickets:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="";var ticket,src,cinema,cinemaId=opt.cinemaId;if(__p+="\n",cinemas&&cinemas.length){__p+="\n	";for(var i=0,l=cinemas.length;l>i;i++){if(__p+="\n		",cinema=cinemas[i],__p+="\n		",cinema.id==cinemaId){__p+='\n		<div class="tickets-cinema-name">'+(null==(__t=cinema.name)?"":__t)+'</div>\n		<p class="tickets-cinema-meta">'+(null==(__t=cinema.address)?"":__t)+" "+(null==(__t=cinema.phone_number)?"":__t)+"</p>\n		";break}__p+="\n	"}__p+="\n"}if(__p+="\n",tickets&&tickets.length){__p+='\n	<ul class="tickets-session-tab clearfix">\n	';for(var i=0,l=Math.min(tickets.length,4);l>i;i++)__p+='\n		<li class="date-tab" data-idx="'+(null==(__t=i)?"":__t)+'">'+(null==(__t=tickets[i][0].date)?"":__t)+"</li>\n	";if(__p+="\n	",tickets.length>4){__p+='\n		<li class="date-more">\n			<a href="javascript:;">更多</a>\n			<ul class="date-more-list">\n				';for(var i=4,l=tickets.length;l>i;i++)__p+='\n					<li class="date-list"><a href="#" data-idx="'+(null==(__t=i)?"":__t)+'">'+(null==(__t=tickets[i][0].date)?"":__t)+"</a></li>\n				";__p+="\n			</ul>\n		</li>\n	"}__p+="\n	</ul>\n	";for(var i=0,l=tickets.length;l>i;i++){__p+='\n	<ul class="tickets-session-list',0==i&&(__p+=" current"),__p+='" data-to="'+(null==(__t=i)?"":__t)+'">\n		';for(var j=0,k=tickets[i].length;k>j;j++)__p+="\n		<li>\n			",ticket=tickets[i][j],src=ticket.src_details[0],__p+='\n			<a href="http://v.baidu.com/ticket/pickseat/?cinema_id='+(null==(__t=src.cinema_id)?"":__t)+"&third_from="+(null==(__t=src.src)?"":__t)+"&seq_no="+(null==(__t=src.seq_no)?"":__t)+"&terminal_type=pc&video_id="+(null==(__t=opt.videoId)?"":__t)+'" class="buy',"wanda"==src.src&&(__p+=" phone"),__p+='" target="_blank" data-seqno="'+(null==(__t=src.seq_no)?"":__t)+'" static="stp=seat">选座购票</a>\n			<span class="start-time">'+(null==(__t=ticket.show_btime)?"":__t)+'</span>\n			<span class="end-time">'+(null==(__t=ticket.show_etime)?"":__t)+' 结束</span>\n			<span class="type">',src.language&&"无"!=src.language&&(__p+=""+(null==(__t=src.language)?"":__t)),__p+=""+(null==(__t=src.type)?"":__t)+'</span>\n			<span class="price">优惠价<b>'+(null==(__t=ticket.lower_price)?"":__t)+"</b>元</span>\n		</li>\n		";__p+="\n	</ul>\n	"}__p+="\n"}else __p+='\n	<p class="tickets-none">',__p+=error?""+(null==(__t=error)?"":__t):'无法加载场次信息, <a href="#" class="j-ticket-refresh">点击重试</a>',__p+="</p>\n";__p+=""}return __p},phone:function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<div class="tickets-phone">\n	<a href="#" class="tickets-phone-close">x</a>\n	<input type="text" class="tickets-phone-input" placeholder="请输入手机号码" maxLength="11">\n</div>';return __p}},getTickets:function(t){var i=this.api(this.opt);$.getJSON(i).done(function(i){return 0===i.errno?void(t&&t(i.data)):void(t&&t({error:i.msg}))}).fail(function(){t&&t({})})},cache:{current:null,areas:{},cinemas:{},tickets:{}},formatCache:function(){var t=this.opt,i=this.cache;return{opt:t,current:i.current,areas:i.areas[t.cityId],cinemas:i.cinemas[t.areaId],tickets:i.tickets[t.cinemaId],error:""}},getCache:function(t){var i=this,e=i.opt,a=this.cache;return this.$loading.show(),this.$ticketList.hide(),a.areas[e.cityId]&&a.areas[e.cityId].length&&a.cinemas[e.areaId]&&a.cinemas[e.areaId].length&&a.tickets[e.cinemaId]&&a.tickets[e.cinemaId].length?void(t&&t(this.formatCache())):void this.getTickets(function(n){if(n.error)return t&&t({opt:this.opt,areas:[],cinemas:[],tickets:[],error:n.error});n.citylist&&(a.current=n.citylist.cur_city,e.cityId=a.current.id,a.hotcities=n.citylist.hot_cities,a.allcities=n.citylist.allcities);var s=e.cityId;n.areas&&(a.areas[s]=n.areas);var c=e.areaId||n.areas&&n.areas[0].id||0;e.areaId=c,n.cinemas&&(a.cinemas[c]=n.cinemas);var r=e.cinemaId||n.cinemas&&n.cinemas[0].id||0;e.cinemaId=r,a.tickets[r]=n.tickets,t&&t(i.formatCache())})},updateAreas:function(t){var i=this.tpls.areas;this.$areaList.html(i(t))},updateCinemas:function(t){var i=this.tpls.cinemas;this.$cinemaList.html(i(t))},updateTickets:function(t){var i=this.tpls.tickets;this.$ticketList.html(i(t)),this.$loading.hide(),this.$ticketList.show();var e=this.$ticketList.find(".tickets-session-tab li[data-idx=0]");setTimeout(function(){e.addClass("current")},20)},fnCityChange:function(t,i){this.opt.cityId=i||0,this.opt.areaId=0,this.opt.cinemaId=0;var e=this;this.getCache(function(t){i||e.$citySelect.find(".city").html(t.current.name),e.updateAreas(t),e.updateCinemas(t),e.updateTickets(t)})},fnAreaChange:function(t,i){this.opt.areaId=i||0,this.opt.cinemaId=0;var e=this;this.getCache(function(t){e.updateCinemas(t),e.updateTickets(t)})},fnCinemaChange:function(t,i){this.opt.cinemaId=i||0;var e=this;this.getCache(function(t){e.updateTickets(t)})},fnSelectCity:function(){this.$cityListWrap.length||(this.$citySelect.append(this.tpls.citylist({hotcities:this.cache.hotcities,allcities:this.cache.allcities,opt:this.opt})),this.$cityListWrap=this.$el.find(".j-city-list-wrap")),this.$cityListWrap.fadeToggle(300)},fnChangeCity:function(t){var i=$(t.currentTarget),e=i.data("id");this.$cityListWrap.find(".city-item li.selected, .hot-city li.selected").removeClass("selected"),i.addClass("selected"),this.$el.trigger("cityChange",e),this.$citySelect.find(".city").html(i.text())},fnChangeArea:function(t){t.preventDefault();var i=$(t.currentTarget),e=i.data("areaid");i.addClass("current").siblings().removeClass("current"),this.$el.trigger("areaChange",e)},fnChangeCinema:function(t){t.preventDefault();var i=$(t.currentTarget),e=i.data("cinemaid");i.addClass("current").siblings().removeClass("current"),this.$el.trigger("cinemaChange",e)},fnChangeCityByAlphabet:function(t){t.preventDefault(),t.stopPropagation();var i=$(t.currentTarget),e=i.data("router");i.hasClass("selected")||(this.$cityListWrap.find(".city-item.selected").removeClass("selected").siblings(".city-item[data-to="+e+"]").addClass("selected"),i.addClass("selected").siblings().removeClass("selected"))},fnChangeSessionByDay:function(t){t.preventDefault();var i=$(t.currentTarget),e=i.data("idx");i.hasClass("current")||(this.$el.find(".tickets-session-list.current").removeClass("current").siblings(".tickets-session-list[data-to="+e+"]").addClass("current"),i.parents(".tickets-session-tab").find(".current").removeClass("current").end().end().addClass("current"))},fnShowOrHideMore:function(t){t.preventDefault();var i=$(t.currentTarget),e=i.prev(".tickets-meta-list");e.toggleClass("showmore")},fnShowPhoneWin:function(t){var i,e,a=$(t.currentTarget),n=a.parent("li"),s=a.data("seqno"),c=n.find(".tickets-phone");return c.length||(c=$(this.tpls.phone({})).appendTo(n)),c.data("seqno")==s?(e=c.find("input"),i=e.val(),/1[3578][0-9]{9,9}/.test(i)?(a.attr("href",a.attr("href")+"&user_mobile="+i),void c.hide()):(setTimeout(function(){e.addClass("error")},200),setTimeout(function(){e.removeClass("error")},400),setTimeout(function(){e.addClass("error")},600),setTimeout(function(){e.removeClass("error").focus()},800),void t.preventDefault())):(c.data("seqno",s).show(),void t.preventDefault())},fnHidePhoneWin:function(t){t.preventDefault();var i=$(t.currentTarget);i.parent().remove()},fnRefreshTicket:function(t){t.preventDefault(),this.$cinemaList.find(".current").trigger("click")},_timerMoreDate:0,fnShowMoreDate:function(t){t.preventDefault(),clearTimeout(this._timerMoreDate),$(t.currentTarget).find(".date-more-list").show()},fnHideMoreDate:function(t){t.preventDefault(),clearTimeout(this._timerMoreDate),setTimeout(function(){$(t.currentTarget).find(".date-more-list").hide()},100)},initEles:function(){this.$cityList=this.$el.find(".j-t-city-list"),this.$cityListWrap=this.$el.find(".j-city-list-wrap"),this.$citySelect=this.$el.find(".j-city-select"),this.$areaList=this.$el.find(".j-t-area-list"),this.$cinemaList=this.$el.find(".j-t-cinema-list"),this.$ticketList=this.$el.find(".j-t-ticket-list"),this.$loading=this.$el.find(".j-tickets-loading")},initEvents:function(){var t=this.$el;t.on("cityChange",$.proxy(this.fnCityChange,this)),t.on("areaChange",$.proxy(this.fnAreaChange,this)),t.on("cinemaChange",$.proxy(this.fnCinemaChange,this)),t.on("click",".j-city-select",$.proxy(this.fnSelectCity,this)).on("click",".city-item li, .hot-city li",$.proxy(this.fnChangeCity,this)).on("click",".j-t-area-list a",$.proxy(this.fnChangeArea,this)).on("click",".j-t-cinema-list a",$.proxy(this.fnChangeCinema,this)).on("click",".label-wp a",$.proxy(this.fnChangeCityByAlphabet,this)).on("click",".tickets-session-tab .date-tab,.tickets-session-tab .date-list a",$.proxy(this.fnChangeSessionByDay,this)).on("click",".tickets-meta .more",$.proxy(this.fnShowOrHideMore,this)).on("click",".phone",$.proxy(this.fnShowPhoneWin,this)).on("click",".tickets-phone-close",$.proxy(this.fnHidePhoneWin,this)).on("click",".j-ticket-refresh",$.proxy(this.fnRefreshTicket,this)).on("mouseover",".date-more",$.proxy(this.fnShowMoreDate,this)).on("mouseleave",".date-more",$.proxy(this.fnHideMoreDate,this))},initWraps:function(){this.$el.html(this.tpls.piao({})),this.initEles(),this.$el.trigger("cityChange")},init:function(){this.$el=$(".j-tickets-wrap"),this.initEvents(),this.initWraps()}})});
;define("detail:widget/playsource/playsource.js",function(require,exports,module){function showPlayBtn(t){if(t){var e=T("#playButtons .play-btn");if(e&&e.length){var i=e[0],a=i.className;i.className=a.replace(/j-play-source-btn/gi,"intro-play-btn-viped"),i.title="vip免费播放",T("#pay-sites").hide()}}$("#j-play-btn").addClass("showOnece"),playButtons.css("visibility","visible")}function loadSitePlayUrl(t,e){function i(){loginCheck(function(e){var i,n=location.search.indexOf("frp=browse")>-1?"browse":"";e&&e.value?(i=e.vipinfo,i&&i.isvip&&i.isvalid&&(n="vip"),playSite.get({vid:t,userType:n},function(t){a(t,n)})):playSite.get({vid:t,userType:n},a)})}function a(t,e){if(t&&t.length){for(var i=config.siteVipProxies,a=0,o=t.length;o>a;a++){var r=t[a].site;if(t[a].noAD=0,"vip"===e)for(var l=0;l<i.length;l++)if(r.indexOf(i[l])>-1&&r.indexOf("61.hz.letv.com")<0){t[a].noAD=1;break}}n(t,e),showPlayBtn("vip"===e)}}function n(t){{var i=T(".play-sites-list")[0];t[0]}if(t.length>0){T(i).parent().show(),initBtn(t,e);var a=tplPlaySites({data:t,playurlappend:e,brandSite:sourceConfig.brandSite});T(i).eq(0).html(a);var n=T(i).find(".more"),o=T(i).find(".play-sites-more");if(!n.length)return;o.css({right:0,top:n.position().top+n.height()});var r;n.hover(function(){clearTimeout(r),o.show()},function(){clearTimeout(r),r=setTimeout(function(){o.hide()},100)}),o.on("mouseenter",function(){clearTimeout(r)}).on("mouseleave",function(){clearTimeout(r),o.hide()})}}t||(t=T("#videoId").attr("value")),i()}function load(t,e,i){VIDEOID=t,e?loadSitePlayUrl(t,i):showPlayBtn()}function changePlayBtn(t,e){VIDEOID=t,e&&loginCheck(function(e){e&&e.value?vipInfo.get(function(e){"hao123"!==sourceConfig.site&&e.isvip&&e.isvalid?playSite.checkVIPSite({vid:t,userType:"vip"},function(t){if(t){var e=T("#playButtons .play-btn");if(e&&e.length){var i=e[0],a=i.className;i.className=a.replace(/j-play-source-btn/gi,"intro-play-btn-viped"),i.title="免广告播放",T("#pay-sites").hide()}}showPlayBtn()}):showPlayBtn()}):showPlayBtn()})}function initBtn(playSources,playurlappend){var $btnPlaySource=$(".j-play-source-btn"),tplPlaySources=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+='<div class="play-sources clearfix" static="bl=spa&blname=简介&stp=playsource">\n	';for(var i=0,l=data.length;l>i;i++){__p+="\n    ";var url=data[i].link+playurlappend(data[i].site);__p+='\n	<a href="'+(null==(__t=url)?"":__t)+'" target="_blank" style="background-image:url('+(null==(__t=data[i].logo)?"":__t)+')" static="site='+(null==(__t=data[i].site)?"":__t)+'">'+(null==(__t=data[i].name)?"":__t)+"</a>\n	"}__p+="\n</div>"}return __p},playSource=_.find(playSources,function(t){return t.sale})||playSources[0];if(playSource&&$btnPlaySource){if(playSource.sale&&playSource.sale.site){sourceConfig.brandSite=playSource.sale.site,sourceConfig.pro=0===+playSource.sale.free?1:0;var playurlAppends=$("#video-brand").attr("static")+"&pro="+sourceConfig.pro,urlAppends=playSource.link+playurlappend(playSource.site);$("#video-brand").attr("href",urlAppends).text(playSource.name+"全网首播").show().attr("static",playurlAppends),ec.trigger("prochange",sourceConfig.pro)}var logoPic=playSource.logo.replace(/logo\/(.*)\.gif$/,"logo/big/$1.png"),newHrefs=playSource.link+playurlappend(playSource.site);$btnPlaySource.attr("href",newHrefs).find("img").attr("src",logoPic).show();var $playSources=$(tplPlaySources({data:playSources,playurlappend:playurlappend})),btnPosition=$btnPlaySource.position()||{},btnHeight=$btnPlaySource.outerHeight();$btnPlaySource.after($playSources),$playSources.css({left:btnPosition.left,top:btnPosition.top}).hide();var _timer;$btnPlaySource.on("mouseover",".play-source",function(){clearTimeout(_timer),$playSources.show().stop(!0).animate({left:$btnPlaySource.position().left,top:$btnPlaySource.position().top+btnHeight},300),$(this).addClass("play-source-active")}).on("mouseleave",".play-source",function(){clearTimeout(_timer);var t=$(this);_timer=setTimeout(function(){$playSources.stop(!0).animate({top:$btnPlaySource.position().top},300,function(){$playSources.hide()}),t.removeClass("play-source-active")},200)}),$playSources.on("mouseover",function(){clearTimeout(_timer)}).on("mouseleave",function(){$btnPlaySource.find(".play-source").trigger("mouseleave")})}}function _init(t){sourceConfig=t;var e=t.id,i=t.ispaid,a=t.isPlay,n=t.videoId,o=function(){var e=t.brandSite,i=t.play_url_append;return function(t){if(e&&t===e){var a=i.replace(/vfm=([^\&]+)\&?/,"");return"&vfm=bdvppzq"+a}return i}}();o.toString=o.valueOf=function(){return t.play_url_append},!+i||t.brandSite&&+t.isPlay?load(n,a,o):loginCheck(function(i){i&&i.value?vipInfo.get(function(i){i.isvip&&i.isvalid?payapis.checkPrice(n,function(t){var i=[];t&&t.data&&t.data.length>0&&(i=t.data),i&&i.length>0?(pay.init({videoid:n,fufei_payment:t.fufei_payment,site_list:i,play_url_append:o+"&pay=1"}),T("#"+e)[0].style.visibility="visible"):(a&&changePlayBtn(n,a),load(n,a,o))},t.site):(a?changePlayBtn(n,a):payapis.checkPrice(n,function(){},t.site),load(n,a,o))}):(a?changePlayBtn(n,a):payapis.checkPrice(n,function(){},t.site),load(n,a,o))})}function init(t){var e="http://list.video.baidu.com/eventfor2014/detail.js",i=function(e){var i=!1;$.each(e,function(e,a){var n;if("event_2014_detail"===a.name){if(n=a.data.videos,!n||!n.length)return _init(t);$.each(n,function(e,a){if(a.id===t.videoId||0!==+a.hot_day){if(a.imgh_url){var n=$('<img src="'+a.imgh_url+'" width="190" height="40"/>');a.intro&&(n=$('<a href="'+a.intro+'" target="_blank"></a>').append(n)),$(".vdieo-adv-pic").addClass("ashow").html(n)}if(a.imgv_url){var n=$('<img src="'+a.imgv_url+'" width="160" height="40"/>');a.sites&&(n=$('<a href="'+a.sites+'" target="_blank"></a>').append(n)),$(".video-adv-title-pic").addClass("ashow").html(n)}if(1===+a.hot_week&&a.url){i=!0,$("#posterContainer").attr("href",a.url),$("#playButtons").hide();var o='style="display:block;margin-top:20px;width:128px;height:40px;',r="background:url(http://list.video.baidu.com/pc_static/common/btn_play_free.gif) ",l='" target="_blank" '+o+r+'0 0 no-repeat;"></a>';$("#movie-intro .intro").append('<a href="'+a.url+l)}return 1===+a.hot_day?!1:void 0}})}}),i||_init(t)};"video"===t.site?$.ajax({url:e,dataType:"jsonp",jsonpCallback:"videoEvent14Detail",crossDomain:!0,scriptCharset:"gb2312",success:function(t){$(function(){i(t)})},timeout:5e3,error:function(){_init(t)}}):_init(t)}var sourceConfig,T=$,_=require("common:static/vendor/underscore/underscore.js"),core=(require("common:static/vendor/bootstrap/js/tooltip.js"),require("common:static/ui/core/core.js")),config=core.config,ec=(core.vApp,require("common:static/ui/eventcenter/eventcenter.js")),loginCheck=require("common:static/ui/loginCheck/loginCheck.js"),vipInfo=require("common:static/ui/vipInfo/vipInfo.js"),payapis=(require("detail:static/ui/vipPlayPortal/vipPlayPortal.js"),require("detail:static/ui/payapis/payapis.js")),pay=require("detail:static/ui/pay/pay.js"),playSite=require("detail:static/ui/playSite/playSite.js"),tplPlaySites=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="",brandSite&&(__p+='\n    <a href="#" class="more" static="ext=more">  更多</a>\n        <span class="play-sites-more">\n'),__p+="\n";for(var i=0,l=data.length;l>i;i++){__p+="\n    ";var url=data[i].link+playurlappend(data[i].site);__p+='\n    <a 	href="'+(null==(__t=url)?"":__t)+'"\n        class="play-site ',1==data[i].noAD&&(__p+=" grayColor"),__p+='"\n        target="_blank"\n        style="background-image:url(',__p+=1==data[i].noAD?"http://list.video.baidu.com/pc_static/common/icon/vip_super_small.png":""+(null==(__t=data[i].logo)?"":__t),__p+=')"\n        static="site='+(null==(__t=data[i].site)?"":__t)+'"\n        data-site="'+(null==(__t=data[i].site)?"":__t)+'"\n        title="'+(null==(__t=data[i].name)?"":__t)+'">\n        '+(null==(__t=data[i].name)?"":__t)+"\n    </a>\n    ",!brandSite&&l-1>i&&(__p+=" <b>&gt;</b> "),__p+="\n "}__p+="\n",brandSite&&(__p+="\n    </span>\n"),__p+=""}return __p},VIDEOID="",playButtons=T("#playButtons");module.exports={load:load,changePlayBtn:changePlayBtn,init:init}});
;define("detail:widget/prevue/prevue.js",function(require,exports,module){function init(opt){var elem=$("#"+opt.id),type=opt.type,temp=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="";var videoid=videoid||"";__p+="\n";var onepage=onepage,items=items,total=items.length,pagenum=Math.ceil(total/onepage);__p+='\n<!-- Indicators -->\n<!-- Wrapper for slides -->\n<div class="carousel-inner" role="listbox">\n    ';for(var j=0;pagenum>j;j++){__p+='\n        <div class="item ',0==j&&(__p+="active"),__p+=' hide-overflow">\n            <ul >\n                ';for(var n=0;onepage>n;n++){if(__p+="\n                    ",total>j*onepage+n){__p+="\n                    ";var item=items[j*onepage+n];__p+="\n                    <li ",n==onepage-1&&(__p+='class="last sub-item"'),__p+='>\n                        <a href="'+(null==(__t=item.link)?"":__t)+'" target="_blank" static="stp=po&videoid='+(null==(__t=videoid)?"":__t)+'" title="'+(null==(__t=item.sub_title)?"":__t)+'" class="item-a view-box prevue-work-twoline">\n                            <span class="view">\n                                <img class="item-img" src="'+(null==(__t=item.thumbnail)?"":__t)+'"/>\n                                <span class="info-bg"></span>\n                                <span class="info">'+(null==(__t=formatDuration(item.duration))?"":__t)+'</span>\n                                <span class="s-mask"></span>\n                                <span class="s-play"></span>\n                            </span>\n                            <span class="title prevue-work-twoline-title">'+(null==(__t=$.string.widthstr(item.sub_title,23))?"":__t)+"</span>\n                        </a>\n                    </li>\n                    "}__p+="\n                "}__p+="\n            </ul>\n        </div>\n    "}__p+="\n</div>\n\n<!-- Controls -->\n",pagenum>1&&(__p+='\n<a class="left carousel-control" href="#prevue-carousel" role="button" data-slide="prev" static="stp=left"></a>\n<a class="right carousel-control" href="#prevue-carousel" role="button" data-slide="next" static="stp=right"></a>\n<div class="carousel-page-info"><i>1</i><b>/'+(null==(__t=pagenum)?"":__t)+"</b></div>\n"),__p+=""}return __p},videoId=opt.videoid,dType=($("#detailPrevue"),config.dataType.periphery[type]);$.ajax(config.getRemoteUrl(type)+"?dtype="+dType+"&service=json&id="+videoId,{dataType:"jsonp",success:function(e){return e.length<3?void elem.remove():(showPlayBtn(e,opt),elem.removeClass("hide"),elem.find(".content").eq(0).html(temp({items:e,onepage:5,videoid:videoId,formatDuration:formatDuration})),void(elem.find(".item").length&&(elem.carousel({interval:0}),elem.on("slid.bs.carousel",function(){var e=$(this),t=e.find(".item.active").index()+1;e.find(".carousel-page-info i").text(t)}))))}})}require("common:static/vendor/bootstrap/js/carousel.js");var core=require("common:static/ui/core/core.js"),config=core.config,formatDuration=(core.vApp,require("common:static/vendor/underscore/underscore.js"),function(e){var t=[parseInt(e/60/60,10),Math.floor(e/60%60),e%60];return 3600>e&&t.shift(),t.join(":").replace(/\b(\d)\b/g,"0$1")}),showPlayBtn=function(e,t){var n=$("#j-play-btn.intro-play-btn-more");if(n.length)try{{var a=t.release.split("-");+new Date-new Date(parseInt(a[0],10),parseInt(a[1],10)+1,parseInt(a[2],10)),parseInt(t.ispaid,10)}n.removeClass("intro-play-btn-more").addClass("intro-play-btn-yugao").attr("href",e[0].link).attr("static",n.attr("static").replace("ext=more","ext=prev"))}catch(i){}};exports.init=init});
;define("detail:widget/qrCode/qrCode.js",function(require,exports,module){var Base=require("common:static/ui/oo/klass.js"),$=(Base._,require("common:static/vendor/jquery/jquery.js")),ViewqrCodeList=Base.CC.sub({init:function(t){this.opt=t,this.showData(),this.opt.proType="tv"===this.opt.showType?"电视剧":"电影"},tpls:{qrCode:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+="",data&&(__p+='\n<div class="detail-top-qrCode">\n	',data.tip&&(__p+='\n		<p class="qrCode-word">'+(null==(__t=data.tip)?"":__t)+"</p>\n	"),__p+="\n	",data.imgurl&&(__p+='\n		<a href="',__p+=data.url?""+(null==(__t=data.url)?"":__t):"#",__p+='" class="qrCode-pic-link" target="_blank">\n			<img src="'+(null==(__t=data.imgurl)?"":__t)+'" alt="',data.tip&&(__p+=""+(null==(__t=data.tip)?"":__t)),__p+='" class="qrCode-pic-link-img">\n		</a>\n	'),__p+="\n</div>\n"),__p+="\n";return __p}},showData:function(){var t=this,a="http://www.hao123.com/qr/api?format=json&channel="+this.opt.type+"&style="+this.opt.style;$.ajax({url:a,dataType:"jsonp",success:function(a){if(a&&a.data&&a.data.length)for(var e=0;e<a.data.length;e++)a.data[e].title&&a.data[e].title===t.opt.proType&&$(t.opt.el).append(t.getTpl("qrCode")({data:a.data[e]}))}})}});module.exports=function(t){new ViewqrCodeList(t)}});
;define("detail:widget/rank/new.js",function(require,exports,module){var lastDate,comingUrl=(require("common:static/vendor/underscore/underscore.js"),"/movie_intro/?dtype=newhotlist&service=json&id=0&callback=?"),tpl=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="";var isNewDay,item,idx=0;if(__p+="\n",movies&&movies.length){__p+="\n	";for(var i=0,l=movies.length;l>i;i++)if(__p+="\n	",item=movies[i],isNewDay=helper(item),void 0!==isNewDay){if(__p+="\n	",idx++>=10)break;__p+="\n		",isNewDay&&(__p+="\n			",i>0&&(__p+="\n			</dd>\n		</dl>\n			"),__p+='\n		<dl class="release-data clearfix">\n			<dt>\n				<div class="day">'+(null==(__t=isNewDay.month)?"":__t)+"月"+(null==(__t=isNewDay.day)?"":__t)+"日<span></span></div>\n			</dt>\n			<dd>\n		"),__p+='\n				<div class="new-item">\n					<a title="'+(null==(__t=item.title)?"":__t)+'" href="'+(null==(__t=hostUrl)?"":__t)+(null==(__t=item.works_id)?"":__t)+'.html?frp=browse" static="no='+(null==(__t=i+1)?"":__t)+'" target="_blank">'+(null==(__t=item.title.substr(0,14))?"":__t)+"</a>\n				</div>\n	"}__p+="\n			</dd>\n		</dl>\n"}__p+=""}return __p},getData=function(t){$.getJSON(comingUrl).done(function(e){$.isPlainObject(e)||(e=$.parseJSON(e)),t&&t(e["new"])}).fail(function(){t&&t([])})},REG_DATE=/^(20\d{2,2})\-([01]\d)\-([0123]\d)$/,dateHelper=function(t){var e=t.release_date,n=e.toString().match(REG_DATE);return n&&n.length?lastDate===e?!1:(lastDate=e,{year:n[1],month:n[2],day:n[3]}):void 0};module.exports=function(t,e){getData(function(n){var i=tpl({movies:n,helper:dateHelper,hostUrl:"hao123"==e?"/dianying/":"/movie/"});t.append(i)})}});
;define("detail:widget/rank/rank.js",function(require,exports,module){var tpl=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){if(__p+="",rankList.length){if(__p+="\n	",hasTicket){__p+="\n		";for(var i=0,l=Math.min(rankList.length,12);l>i;i++){__p+="\n			";var rank=rankList[i];__p+='\n			<li>\n				<a title="'+(null==(__t=rank.title)?"":__t)+'" href="/movie/'+(null==(__t=rank.works_id)?"":__t)+'.html?frp=browse" static="no='+(null==(__t=i+1)?"":__t)+'" target="_blank">'+(null==(__t=rank.title.substr(0,9))?"":__t)+"</a>\n				",rank.release_date&&(__p+="\n				<b>"+(null==(__t=rank.release_date)?"":__t)+"</b>\n				"),__p+="\n			</li>\n		"}__p+="\n	"}else{__p+="\n		";for(var i=0,l=Math.min(rankList.length,8);l>i;i++){__p+="\n			";var rank=rankList[i];__p+='\n			<li>\n				<a title="'+(null==(__t=rank.title)?"":__t)+'" href="'+(null==(__t="hao123"==site?rank.hao123_url:rank.url)?"":__t)+'" static="no='+(null==(__t=i+1)?"":__t)+'" target="_blank">'+(null==(__t=rank.title.substr(0,9))?"":__t)+"</a>\n				<span",3>i&&(__p+=' class="top3"'),__p+=">"+(null==(__t=i+1)?"":__t)+"</span>",rank.hot_day&&(__p+="<b>"+(null==(__t=(rank.hot_day/1e4).toFixed(1))?"":__t)+"万</b>"),__p+="\n			</li>\n		"}__p+="\n	"}__p+="\n"}__p+=""}return __p},topData=require("detail:static/ui/utils/topData.js");module.exports=function(_,t,n){topData.get(_,function(_){var a=tpl({rankList:_.videos,hasTicket:!1,site:n});t.html(a)})}});
;define("detail:widget/scenario/scenario.js",function(require,exports,module){function ScenarioModule(config){ScenarioModule.validation(config),this.id=config.id,this.title=config.title,this.hosturl=config.hosturl,this.container=g(config.container),this.isFinish=config.isFinish,this.fr=config.frp,this.template=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){if(__p+="","object"==typeof loadedData&&loadedData.length){var intros=loadedData,introNumber=intros.length,introLastIndex=introNumber-1,current="undefined"!=typeof fields?parseInt(fields,10):0;__p+='\n    <div class="sub-hd">\n        <div class="control control-pagenav" static="bl=sce&blname=分集剧情&stp=pagenav">\n            <div class="control-inner">\n                ';for(var idx=0;introNumber>idx;idx++){var isLastPage=idx===introNumber-1,intro=intros[idx],className=idx===current?"selected":"";__p+='\n                    <a href="javascript:void(0);" data-fields="'+(null==(__t=idx)?"":__t)+'" class="'+(null==(__t=className)?"":__t)+'">'+(null==(__t=intro.part)?"":__t)+"集"+(null==(__t=isLastPage&&isFinish?"[完]":"")?"":__t)+"</a>\n                "}__p+='\n            </div>\n        </div>\n    </div>\n    <div class="sub-bd" static="bl=sce&blname=分集剧情&stp=content&to=play',pro!==!1&&(__p+="&pro="+(null==(__t=pro)?"":__t)),__p+='">\n        ';for(var partIntros=intros[current].intro,introIndex=0,len=partIntros.length;len>introIndex;introIndex++){var item=partIntros[introIndex],isLast=5===introIndex||introIndex+1===len,isPlay=item.url&&-1===item.url.indexOf("v.baidu.com")?1:0,url=item.url+(item.url.indexOf("?")>-1?"&":"?")+"vfm="+(1==pro?"bdvppzq":"browse"==templateData.fr?"bdvcsplld":"bdvtx");__p+='\n            <div class="entry clearfix ',isLast&&(__p+="last-entry"),__p+='">\n                <h3><a href="'+(null==(__t=isPlay?url+"&bl=sce_content":"javascript:;")?"":__t)+'" target="_blank"><span class="s-play"></span>'+(null==(__t=title)?"":__t)+" 第"+(null==(__t=item.episode)?"":__t)+"集"+(null==(__t=idx===introLastIndex&&isFinish?'<span class="s-finish">[大结局]</span>':"")?"":__t)+'</a></h3>\n                <div class="des">\n                    '+(null==(__t=item.intro?item.intro.replace(/(&#x26|&#x22|&#x27|&#x5C)/g,"$1;").replace(/<b$/g,""):"暂无本集简介")?"":__t)+"\n                </div>\n            </div>\n        "}__p+='\n    </div>\n    <div class="sub-ft">\n        <div class="control control-pagenav control-pagenav-down" static="bl=sce&blname=分集剧情&stp=quick',pro!==!1&&(__p+="&pro="+(null==(__t=pro)?"":__t)),__p+='">\n            <h3>快速播放<span class="s-play"></span></h3>\n            <div class="control-inner">\n            <ul>\n            ';for(var idx=0;introNumber>idx;idx++){var isLastPage=idx===introNumber-1,intro=intros[idx];__p+='\n                <li class="dropdown">\n                    <a href="javascript:void(0);" data-toggle="dropdown" class="js-tip-target" data-fields="'+(null==(__t=idx)?"":__t)+'">'+(null==(__t=intro.part)?"":__t)+"集"+(null==(__t=isLastPage&&isFinish?"[完]":"")?"":__t)+'<span class="arrow"></span></a>\n                    <ul class="dropdown-menu" role="menu">\n                        '+(null==(__t=quickplay[idx])?"":__t)+"\n                    </ul>\n                </li>\n            "}__p+="\n            </ul>\n            </div>\n        </div>\n    </div>\n"}else __p+="\n    <p>暂无剧情简介</p>\n";__p+=""}return __p},this.callbacks={loaded:"function"==typeof config.loaded?config.loaded:function(){},rendered:"function"==typeof config.rendered?config.rendered:function(){}},this.data={fields:"0",title:this.title,templateData:config.templateData||{},isFinish:this.isFinish,id:this.id,hosturl:this.hosturl,pro:config.isPro},this.init()}var T=$,_=require("common:static/vendor/underscore/underscore.js")._,core=require("common:static/ui/core/core.js"),vApp=core.vApp,config=core.config;require("common:static/vendor/bootstrap/js/dropdown.js");var g=function(t){return document.getElementById(t)};ScenarioModule.validation=function(t){if(!t.id)throw new Error("Scenario: id is null");if(!g(t.container))throw new Error("Scenario: container is null");if(void 0===t.isFinish)throw new Error("Scenario: isFinish is undefined")},ScenarioModule.prototype={init:function(){this.load()},load:function(){var t=this;T(this.container).addClass("loading"),T.ajax(config.getRemoteUrl("tv")+"?dtype=tvEpisodeIntro&service=json&id="+this.id,{dataType:"jsonp",success:function(n){try{t.loadSuccess(n)}catch(i){vApp.debug(i)}0===n.length&&require("detail:widget/loadHao123/loadHao123.js")()}})},loadSuccess:function(t){T(this.container).removeClass("loading"),this.data.loadedData=t,this.callbacks.loaded(this),t.length?this.render():$("#scenarioBlock").addClass("hide")},render:function(){var t=this,n=t.data.loadedData,i=[],e=_.template('<li><a title="<%=subtitle%>" <%if (isPlay === 1) {%>href="<%=url%>&bl=sce_quick" target="_blank"<%} else {%>style="color: #d7d7d7"<%}%>>第<%=episode%>集</a></li>');_.forEach(n,function(t,n){for(var o,a,r=[],s=0;a=t.intro[s];s++)o=T.extend({},a),o.isPlay=o.url&&-1===o.url.indexOf("v.baidu.com")?1:0,r.push(e(o));i[n]=r.join("")}),this.data.quickplay=i,this.container.innerHTML=this.template(this.data),this.rendered()},rendered:function(){this.bindEvent(),this.callbacks.rendered(this)},bindEvent:function(){var t=this,n=T.find(".control",this.container),i=function(n){n.preventDefault();var i=n.target.getAttribute("data-fields");i&&(t.data.fields=i,t.render())};_.each(n,function(t){T(t).hasClass("control-pagenav-down")||T(t).on("click",i)}),$(".control-pagenav-down").on("mouseenter.bs.dropdown.data-api",'[data-toggle="dropdown"]',$.fn.dropdown.Constructor.prototype.toggle)}},module.exports=ScenarioModule});
;define("detail:widget/showLive/showLive.js",function(t,e,r){var i=t("common:static/vendor/underscore/underscore.js"),a={"天":"0","日":"0","一":"1","二":"2","三":"3","四":"4","五":"5","六":"6","、":"and","至":"to","到":"to"},n=function(t,e){this.timeArray={},this.dayArray=[],this.curTime={},this.timePattern=/[周|星期]?([一二三四五六日天])([、至到]?)[周|星期]?([一二三四五六日天]?)[^\d]*(\d*)?[:：]?(\d*)?/,this.init=function(){this.getCurrentTime(),this.formatTime(),this.linkHandler()},this.getCurrentTime=function(){var t=new Date;this.curTime.curWeek=t.getDay().toString(),this.curTime.curHour=t.getHours(),this.curTime.curMinute=t.getMinutes()},this.formatTime=function(){var r=this.timePattern.exec(t);this.timeArray.startweek=r[1]?a[r[1]]:"",this.timeArray.endweek=r[3]?a[r[3]]:"",this.timeArray.link=r[2]?a[r[2]]:"",this.timeArray.starthour=r[4]||0,this.timeArray.startminute=r[5]||0;var i=parseInt(e/3600),n=parseInt(e/60)%60;this.timeArray.endminute=parseInt(this.timeArray.startminute)+n,this.timeArray.endhour=parseInt(this.timeArray.starthour)+i,this.timeArray.endminute>=60&&(this.timeArray.endminute%=60,this.timeArray.endhour++)},this.linkHandler=function(){this.timeArray&&this.timeArray.link?"to"==this.timeArray.link?this.weekToHandler():"and"==this.timeArray.link&&this.weekAndHandler():this.timeArray&&this.timeArray.startweek&&this.dayHandler()},this.weekToHandler=function(){this.timeArray.startweek=parseInt(this.timeArray.startweek),this.timeArray.endweek=parseInt(this.timeArray.endweek);for(var t=Math.min(this.timeArray.startweek,this.timeArray.endweek),e=Math.max(this.timeArray.startweek,this.timeArray.endweek),r=t;e>=r;r++)this.dayArray.push(r.toString())},this.weekAndHandler=function(){this.dayArray.push(this.timeArray.startweek),this.dayArray.push(this.timeArray.endweek)},this.dayHandler=function(){this.dayArray.push(this.timeArray.startweek)},this.stateHandler=function(){if(~i.indexOf(this.dayArray,this.curTime.curWeek)){var t={},e={},r={};if(t.hour=this.timeArray.starthour,t.minute=this.timeArray.startminute,e.hour=this.timeArray.endhour,e.minute=this.timeArray.endminute,r.hour=this.curTime.curHour,r.minute=this.curTime.curMinute,this.timeCompare(r,t)&&this.timeCompare(e,r))return!0}return!1},this.timeCompare=function(t,e){return t.hour>e.hour?!0:t.hour<e.hour?!1:t.minute>=e.minute?!0:!1}},s=i.template('<a href="<%=url%>" target="_blank" static="stp=station&to=live"><%=text%></a>'),h=function(){var t=new Date,e=function(t){return(10>t?"0":"")+t};return[t.getFullYear(),e(t.getMonth()+1),e(t.getDate())].join("-")};r.exports=function(t){var e=$(".j-update-info"),r=new n(t.freq,t.duration);r.init();var i=r.stateHandler();if(i){var a=s({text:"正在直播 "+h()+" 期",url:t.playurl});e.html(a).addClass("live")}}});
;define("detail:widget/staffs/staffs.js",function(require,exports,module){var _=require("common:static/vendor/underscore/underscore.js"),init=function(site){var $staffInfo=$(".j-staff-info"),url="/person_intro/?dtype=personWorks&service=json&ps=30&id=#id&wt=movie:tvplay:show&callback=?",tpl=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){if(__p+="",works.length){__p+="\n	";var work,type,len;__p+='\n	<ul class="staff-plays clearfix">\n		';for(var i=0,l=Math.min(works.length,8);l>i;i++)__p+="\n		  ",work=works[i],__p+="\n		  ",type=work.type,__p+='\n			<li><span>[<a href="http://'+(null==(__t=hostUrl)?"":__t)+"/"+(null==(__t=type)?"":__t)+'" target="_blank" static="stp=channel&amp;type='+(null==(__t=type)?"":__t)+'">'+(null==(__t=work.typeCn)?"":__t)+'</a>]</span><a href="/'+(null==(__t=type)?"":__t)+"/"+(null==(__t=work.works_id)?"":__t)+'.html" title="'+(null==(__t=work.title)?"":__t)+'" static="stp=work&amp;type='+(null==(__t=type)?"":__t)+"&amp;wid="+(null==(__t=work.works_id)?"":__t)+'" target="_blank">',len=6,"tv"==type&&(len=5),__p+=""+(null==(__t=work.title.substr(0,len))?"":__t)+"</a></li>\n		";__p+="\n	</ul>\n"}else __p+="\n	<p>没有查到Ta的作品:-(</p>\n";__p+=""}return __p},typeMap={video:{movie:"movie",tv:"tv",showHost:"show",showGuest:"show"},hao123:{movie:"dianying",tv:"dianshi",showHost:"zongyi",showGuest:"zongyi"},duba:{movie:"movie",tv:"tv",showHost:"show",showGuest:"show"}},render=function(t,e){var n=tpl({works:e,hostUrl:"hao123"===site?"v.hao123.com":"v.baidu.com"});$staffInfo.filter("[data-personid="+t+"]").find("dd").html(n);try{e.length||$staffInfo.filter("[data-personid="+t+"]").hide()}catch(o){}},handleData=function(t,e){var n=[],o=typeMap[site];_.each(e,function(t){if(t.list.length&&"showGuest"!==t.type){var e="电影";"showHost"===t.type?e="综艺":"tv"===t.type&&(e="电视剧"),_.each(t.list,function(s){s.typeCn=e,s.type=o[t.type],n.push(s)})}}),n=n.sort(function(t,e){return(e.al_date||e.net_show_time||0)-(t.al_date||t.net_show_time||0)}),render(t,n)},getInfo=function(t){var e=url.replace("#id",t);$.getJSON(e,function(e){handleData(t,e)})};$staffInfo.length&&($staffInfo.each(function(){getInfo($(this).data("personid"))}),$("#j-staff-wrap").removeClass("hide"),$("#nav-staff").removeClass("hide"))};module.exports=init});
;define("detail:widget/staticEpisode/staticEpisode.js",function(require,exports,module){var Root,T=$,_=require("common:static/vendor/underscore/underscore.js"),Backbone=require("common:static/vendor/backbone/backbone.js"),vipConfig=require("common:static/ui/vipConfig/vipConfig.js"),vipInfo=require("common:static/ui/vipInfo/vipInfo.js"),ec=require("common:static/ui/eventcenter/eventcenter.js"),templates={episodes:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="";var episode,restNum="tv"!=type||"hao123"!=frSite||finish?5:4;if(__p+="\n",len&&len>0){__p+='\n	<ul class="episode-episodes-list clearfix">\n		';for(var i=start;max>i;i++)__p+="\n			",!fold||fold&&(42>i||i>max-restNum)?(__p+="\n				",episode=episodes[i].toJSON(),__p+='\n				<li class="episode-episode" data-episode="'+(null==(__t=episode.episode)?"":__t)+'">\n					<a target="_blank" class="episode-episode-card" href="'+(null==(__t=episode.url)?"":__t)+'&bl=jp_video" title="'+(null==(__t=episode.title)?"":_.escape(__t))+'" data-record="'+(null==(__t=episode.record)?"":__t)+'" data-episode="'+(null==(__t=episode.episode)?"":_.escape(__t))+'" static="stp=video&site='+(null==(__t=episode.site_url)?"":__t)+"&n="+(null==(__t=episode.episode)?"":__t),filterSite==episode.site_url&&""!==pro&&(__p+="&pro="+(null==(__t=pro)?"":__t)),__p+="",episode.isPer&&(__p+="&per=1"),__p+='">'+(null==(__t=episode.text)?"":_.escape(__t)),episode.lastEpisode&&(__p+='<span class="episode-episode-last"></span>'),__p+="",episode.isPer&&(__p+='<span class="episode-episode-per"></span>'),__p+="</a>\n				</li>\n			"):fold&&42==i&&(__p+="\n				",i=max-restNum,__p+='\n				<li class="episode-episode unfold" data-start="'+(null==(__t=start)?"":__t)+'" static="stp=unfold">\n					<a class="episode-episode-card" href="#" title="展开全部'+(null==(__t=total)?"":__t)+'集">......</a>\n				</li>\n			'),__p+="\n			",total>=len&&i==max-1&&(__p+="\n				",!fold&&(len>=pageBaseNumber||showFold)&&(__p+='\n				<li class="episode-episode fold" static="stp=fold">\n					<a class="episode-episode-card" href="#" title="收起">收起</a>\n				</li>\n				'),__p+="\n			"),__p+="\n			",i!=max-1||"hao123"!=frSite||finish||"tv"!=type||(__p+='\n			<li class="episode-episode episode-qxk" static="stp=downloadBrowse">\n				<a class="episode-episode-card" href="'+(null==(__t=episode.url)?"":__t)+'" title="抢先看" target="_blank">抢先看</a>\n			</li>\n			'),__p+="\n		";__p+="\n	</ul>\n"}else __p+='\n	<p class="episode-sites-none">暂无站点数据</p>\n';__p+=""}return __p},loading:function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<p class="episode-loader">努力地加载中...</p>';return __p},pagination:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){if(__p+="",paginations.length){__p+="\n	";var idx=0;last&&(idx=paginations.length-1),__p+="\n	",paginations.length>3?(__p+='\n		<ul class="episodes-dropdown episode-paginations-menu clearfix">\n			',_.each(paginations,function(e,t){__p+='\n				<li class="episode-page-item',t==idx&&(__p+=" current"),__p+='">\n					<a href="#" class="episode-page clearfix" data-start="'+(null==(__t=e.start)?"":__t)+'" title="'+(null==(__t=e.begin)?"":__t)+"-"+(null==(__t=e.end)?"":__t)+(null==(__t=unit)?"":__t)+'"><b></b>'+(null==(__t=e.begin)?"":__t)+"-"+(null==(__t=e.end)?"":__t)+"\n					</a>\n				</li>\n			"}),__p+="\n		</ul>\n	"):(__p+='\n		<ul class="episode-paginations clearfix">\n			',_.each(paginations,function(e,t){__p+='\n				<li class="episode-page-item',t==idx&&(__p+=" current"),__p+='">\n					<a href="#" class="episode-page" data-start="'+(null==(__t=e.start)?"":__t)+'" title="'+(null==(__t=e.begin)?"":__t)+"-"+(null==(__t=e.end)?"":__t)+(null==(__t=unit)?"":__t)+'">'+(null==(__t=e.begin)?"":__t)+"-"+(null==(__t=e.end)?"":__t)+"</a>\n				</li>\n			"}),__p+="\n		</ul>\n	"),__p+="\n"}else __p+="\n<h6>全部剧集</h6>\n";__p+=""}return __p},sites:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){if(__p+="",sites.length){var site,len=sites.length;if(__p+="\n",opt.isBrand&&curSite.site==opt.filterSite){__p+='\n	<div class="site-list">\n		',__p+="show"==opt.type?'\n		<span class="site-brand">\n			<span class="site" style="background-image:url('+(null==(__t=curSite.logo)?"":__t)+')">'+(null==(__t=curSite.name)?"":__t)+"全网首播</span>\n		</span>\n		":'\n		<span class="current-site-wrap">当前选择：<a class="site" style="background-image:url('+(null==(__t=curSite.logo)?"":__t)+')">'+(null==(__t=curSite.name)?"":__t)+"</a></span>\n		",__p+='\n		<span class="j-more">\n			<a href="#" class="more">更多</a>\n			<ul class="episodes-site-more j-more-list">\n			';for(var i=0,l=len;l>i;i++)site=sites[i],__p+='\n				<li>\n					<a href="#" data-site="'+(null==(__t=site.site)?"":__t)+'" class="site',site.site==curSite.site&&(__p+=" current"),__p+='" title="'+(null==(__t=site.name)?"":__t),site.isVip&&(__p+=" VIP免广告"),__p+='" static="bl=epi&blname=剧集&stp=site&site='+(null==(__t=site.site)?"":__t)+'" style="background-image:url('+(null==(__t=site.logo)?"":__t)+')">'+(null==(__t=site.name)?"":__t)+"</a>\n				</li>\n			";__p+="\n			</ul>\n		</span>\n	</div>\n"}else{__p+='\n	<div class="site-list">\n		',__p+="show"==opt.type?"\n		<span>智能排序：</span>\n		":'\n		<span class="current-site-wrap">当前选择：<a class="site" style="background-image:url('+(null==(__t=curSite.logo)?"":__t)+')">'+(null==(__t=curSite.name)?"":__t)+"</a></span>\n		",__p+="\n		";for(var i=0,l=Math.min(5,len);l>i;i++)site=sites[i],__p+='\n		<a href="#" class="site',site.site==curSite.site&&(__p+=" current"),__p+='" data-site="'+(null==(__t=site.site)?"":__t)+'" title="'+(null==(__t=site.name)?"":__t),site.isVip&&(__p+=" VIP免广告"),__p+="\" static=\"bl=epi&amp;blname={%urlencode('剧集')%}&amp;stp=site&site="+(null==(__t=site.site)?"":__t)+'" style="background-image:url('+(null==(__t=site.logo)?"":__t)+')">'+(null==(__t=site.name)?"":__t)+"</a>\n		",l-1>i&&(__p+="<b>&gt;</b>"),__p+="\n		";if(__p+="\n		",len>5){__p+='\n		<span class="j-more">\n			<a href="#" class="more">更多</a>\n\n			<ul class="episodes-site-more j-more-list">\n			';for(var i=5,l=len;l>i;i++)site=sites[i],__p+='\n				<li>\n					<a href="#" data-site="'+(null==(__t=site.site)?"":__t)+'" class="site',site.site==curSite.site&&(__p+=" current"),__p+='" title="'+(null==(__t=site.name)?"":__t),site.isVip&&(__p+=" VIP免广告"),__p+="\" static=\"bl=epi&amp;blname={%urlencode('剧集')%}&amp;stp=site&site="+(null==(__t=site.site)?"":__t)+'" style="background-image:url('+(null==(__t=site.logo)?"":__t)+')">'+(null==(__t=site.name)?"":__t)+"</a>\n				</li>\n			";__p+="\n			</ul>\n		</span>\n		"}__p+="\n		",hasPaysite&&(__p+='\n		<b class="paysite">(付费观看)</b>\n		'),__p+="\n	</div>\n"}__p+="\n"}__p+=""}return __p},newest:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="";var itm;__p+="\n";for(var i=0,l=data.length;l>i;i++)__p+="\n	",itm=data[i].toJSON(),__p+='\n	<a href="'+(null==(__t=itm.url)?"":__t)+'&bl=new_epi" class="episode-newest ',__p+=itm.thumbnail?"episode-newest-img":"episode-newest-text",__p+='" title="'+(null==(__t=itm.title)?"":__t)+'" target="_blank" static="site='+(null==(__t=itm.site_url)?"":__t)+'">\n		',__p+=itm.thumbnail?'\n		    <img src="'+(null==(__t=itm.thumbnail)?"":__t)+'" alt="'+(null==(__t=itm.title)?"":__t)+"\" onerror=\"$(this).parent().addClass('episode-newest-text').removeClass('episode-newest-img').end().remove();\"><b></b>\n		    <p>第"+(null==(__t=itm.episode)?"":__t)+'集</p>\n		    <span class="s-play"></span>\n		':"\n			第"+(null==(__t=itm.episode)?"":__t)+"集<b></b>\n		",__p+="\n	</a>\n";__p+=""}return __p},episodetip:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<div class="episode-tip">\n	<p>观看到'+(null==(__t=record)?"":__t)+'集</p>\n	<span class="arrow"><em>◆</em><i>◆</i></span>\n</div>';return __p}},Episode={setRoot:function(e){Root=e||this},Models:{},Collections:{},Views:{},Config:{}};Episode.setRoot(),_.extend(Episode,{options:{type:"",frpBrowse:!1,apiUrl:"",urlPrefix:"",finish:0,lastEpisode:"",pageBaseNumber:50,fields:{single_title:"",url:"",episode:"",is_play:"",site_order:"",site_url:"",link:"",category:"",site:""},fieldsAdapter:function(){},isLastEpisode:function(e){return!parseInt(this.finish,10)&&e&&+e+1>=this.lastEpisode}}}),_.extend(Episode,{queryModel:null,dataCollection:null,siteCollection:null,init:function(e){var t=this,i=e.type,s={site:""};$.cache.play_site_new_fr_ep={},this.options=_.extend(this.options,this.Config[i],e),"hao123"===e.frSite&&(this.options.apiPath=this.options.apiPathHao,this.options.hostUrl=this.options.hostUrlHao),this.initApiUrl(),this.queryModel=new Backbone.Model,this.dataCollection=new t.Collections.Data,this.siteCollection=new t.Collections.Site,this.focusCollection=new t.Collections.Focus,this.queryModel.on("change",_.bind(this.queryChange,t)),this.dataCollection.on("data.loaded",_.bind(this.dataLoaded,this)),this.initViews(),this.queryModel.set(s)},initApiUrl:function(){var e=this.options,t=e.hasPaysite?"&frp=fufei":e.frpBrowse?"&frp=browse":"",i=e.dtype+"PlayUrl&e=1&service=json&id="+e.id;e.apiUrl=e.apiPath+"?callback=?&dtype="+i+t},initViews:function(){var e=this.Views;this.episodesView=new e.Episodes,this.headerView=new e.Header},dataLoaded:function(e){var t=e.model.get("episodes");~this.options.sort||(t=t.sort(function(e,t){return t.episode-e.episode}));var i=e.model.attributes.episodes[0];i&&this.changeHeadPlay(i),this.episodesView.collection.reset(t)},changeHeadPlay:function(e){var t=e.site_url.split(".")[0];$("#time-title").attr("href",e.url).find(".j_episode_num").hide().html(e.episode+"期").fadeIn(),$(".intro-last-news").find(".title").hide().html(e.single_title).attr({href:e.url,title:e.single_title}).fadeIn(),$(".j_play_btn_now").attr("href",e.url),$("#siteLOGO").hide().attr("src","http://vs3.bdstatic.com/logo/big/"+t+".png").fadeIn()},queryChange:function(e){var t=e.toJSON();this._cacheQuery=e,this.dataCollection.load(t)},getTempalte:function(e){return templates[e]},getUrlAppendix:function(e){var t=this.options,i="";try{i=_bdvAppendixFn(t.type+t.id,t.frSite,e)}catch(s){}return i},getPlayUrl:function(e,t,i,s){var n,o=this.options,_=o.frpBrowse?"browse":"",l="";"video"===o.frSite&&(l=o.vfm?"&vfm="+o.vfm:o.isBrand&&o.filterSite===t?"&vfm=bdvppzq":o.frpBrowse?"&vfm=bdvcsplld":"&vfm=bdvtx");var a=encodeURIComponent(o.hostUrl+_);n=s+(s.indexOf("?")>-1?"&":"?")+"page="+o.pagetn+l+"&frp="+a;var r=this.getUrlAppendix(t);return r&&(n+="&"+r),n},initedPlayRecord:!1,initingPlayRecord:!1,initPlayRecord:function(){if(this.initedPlayRecord)return this.trigger("record");if(!this.initingPlayRecord){this.initingPlayRecord=!0;var e=this.options,t={tv:"TV",comic:"C",tvshow:"T"},i=t[e.type]+e.id,s=this;if(!window.bdvRecordAPI)return void setTimeout(function(){s.initPlayRecord()},2e3);s.on("record",_.bind(s.onRecord,s)),window.bdvRecordAPI.get(function(e){var t=e&&e[i]||0;s.trigger("record",t),s.initedPlayRecord=!0})}},userRecord:0,onRecord:function(e){e&&(this.userRecord=e),this.episodesView.trigger("updateRecord",this.userRecord)}}),_.extend(Episode,Backbone.Events),_.extend(Episode.Models,{Cache:Backbone.Model.extend({defaults:{id:"",episodes:[]}}),Episodes:Backbone.Model.extend({defaults:{to:"play",url:"",title:"",text:""}}),Site:Backbone.Model.extend({defaults:{id:"",site:"",name:"",logo:"",isVip:!1,order:99,years:[],sale:{}}}),Focus:Backbone.Model.extend({defaults:{id:"",timeaxis:[]}})}),_.extend(Episode.Collections,{Data:Backbone.Collection.extend({model:Root.Models.Cache,params:function(e){var t=[];return _.each(e,function(e,i){t.push(i+"="+e)}),t.join("&")},load:function(e){var t,i=this,s=e.year||"",n=e.site+s,o=n?i.get(n):i.at(0),l=function(e){if(_.each(e,function(e){var t=e.site_info.site.replace(/\./,"__"),i=$("."+t).val();$.cache.play_site_new_fr_ep[e.site_info.site]={big_logo:e.site_info.big_logo,logo:e.site_info.logo,site:e.site_info.site,name:e.site_info.name,episode:i},e.site_info.id=e.site_info.site,e.years&&(e.site_info.years=e.years.sort(function(e,t){return t-e})),Root.siteCollection.add(e.site_info)}),e.length){var t=Root.siteCollection.at(0).toJSON();t.sale&&t.sale.site&&(Episode.options.filterSite=t.sale.site,Episode.options.isBrand=!0,Episode.options.pro=1===+t.sale.free?0:1,ec.trigger("prochange",Episode.options.pro)),_.each(e,function(e){var t=0===Root.options.finish?e.yugao:null;e.episodes&&e.episodes.length&&i.add({id:e.site_info.site+s,episodes:e.episodes.concat((t||[]).slice(0,3))})})}else i.add({id:"nosite",episodes:[]});Root.siteCollection.vipCheck(function(){return n=n||Root.siteCollection.getFirstSite()+s||"nosite",o=i.get(n),!o||"nosite"!==o.id&&!o.get("episodes").length?Root.queryModel.set({site:n}):(Episode.options.isBrand&&!i.brandSiteLoaded?i.load({site:Episode.options.filterSite}):i.trigger("data.loaded",{model:o}),void Root.initPlayRecord())})};Episode.options.isBrand&&e.site===Episode.options.filterSite&&(i.brandSiteLoaded=!0),o&&("nosite"===o.id||o.get("episodes").length)?i.trigger("data.loaded",{model:o}):(t=Root.options.apiUrl+"&"+i.params(e),T.ajax({url:t,dataType:"jsonp",success:l,error:function(){l([])}}))}}),Episodes:Backbone.Collection.extend({initialize:function(){var e=this;this.on("reset",function(){e._monthsCache=null,e._episodeByMonth={}})},model:function(e){var t=Root.options.fieldsAdapter(e);return new Root.Models.Episodes(t)},getByMonth:function(e){return e?this._episodeByMonth[e]?this._episodeByMonth[e]:this._episodeByMonth[e]=this.filter(function(t){return 0===t.get("episode").substr(4).indexOf(e)}):this.models},getAllMonth:function(){var e,t=[],i=/^(20\d{2,2})\-?([01]\d)\-?([0123]\d)$/;return this._monthsCache?this._monthsCache:(this.each(function(s){var n=s.get("episode"),o=n.match(i);o&&o.length&&e!==o[2]&&t.push(e=o[2])}),this._monthsCache=t.sort(function(e,t){return t-e}))}}),Site:Backbone.Collection.extend({model:Root.Models.Site,filterByYear:function(e){return e=""+e,_.sortBy(_.filter(this.toJSON(),function(t){return~_.indexOf(t.years,e)}),function(e){var t=e.isVip,i=e.order;return~~(t&&i)||i})},vipCheck:function(e){var t=this;return this.vipChecked||vipConfig.filterWork(Root.options.type,Root.options.id)?(this.vipChecked=!0,e&&e()):void vipInfo.get(function(i){var s=i&&i.isvip&&i.isvalid,n=vipConfig.sites;return s?(t.each(function(e){var t,i=e.get("site");n[i]&&(e.set("isVip",!0),t=_.indexOf(n.order,i),~t&&e.set("order",t),e.set("logo",vipConfig.vipSiteLogo))}),"show"!==Root.options.type&&(t.models=t.sortBy(function(e){var t=e.get("isVip"),i=e.get("order");return~~(t&&i)||i})),t.vipChecked=!0,void(e&&e())):(t.vipChecked=!0,e&&e())})},getFirstSite:function(){if("show"!==Root.options.type)return this.at(0)&&this.at(0).get("site")||"";var e=[];this.each(function(t){e=_.union(e,t.get("years"))}),e.sort(function(e,t){return+t-e});var t=this.filterByYear(e[0]);return t&&t.length&&t[0].site||""}}),Focus:Backbone.Collection.extend({model:Root.Models.Focus,url:function(e){var t="/show_intro/?dtype=kandian&callback=?&service=json";return t+"&id="+Root.options.id+"&site="+e.site+"&episode="+e.episode},load:function(e){var t=this.get(e.site+e.episode),i=this;return t?this.trigger("focus.loaded",t.toJSON()):void $.getJSON(this.url(e)).done(function(t){var s=t&&t.length?t[0]:null;s&&s.episode===e.episode?(s.id=e.site+s.episode,i.add(s)):s=null,i.trigger("focus.loaded",s)}).fail(function(){i.trigger("focus.loaded",null)})}})}),$("body").on("click","[data-record]",function(){var e=$(this),t=e.data("record"),i=e.data("episode");if(i)try{bdvRecordAPI.set(t,i)}catch(s){}}),module.exports=Episode});
;define("detail:widget/staticEpisode/staticTv.js",function(e,t,i){var o=e("common:static/vendor/underscore/underscore.js"),s=e("common:static/vendor/backbone/backbone.js"),n=e("detail:widget/staticEpisode/staticEpisode.js"),a={};n.setRoot(a),o.extend(a,n),o.extend(a.Config,{comic:{dtype:"comic",pageBaseNumber:100,unit:"集",apiPath:"/comic_intro/",apiPathHao:"/dongman_intro/",urlPrefix:"/kan/comic/?",hostUrl:"v.baidu.com/comic_intro/",hostUrlHao:"v.hao123.com/dongman_intro/",fieldsAdapter:function(e){e=o.defaults(e,this.fields);var t=parseInt(e.is_play,10),i=a.getPlayUrl(t,e.site_url,e.episode,e.url),s={text:t?e.episode:"暂无 ",title:(t?"观看 ":"搜一下 ")+"第"+e.episode+"集",to:t?"play":"search",episode:e.episode,url:i,site_url:e.site_url,thumbnail:e.thumbnail,lastEpisode:this.isLastEpisode(e.episode),record:"C"+a.options.id};return s}},tv:{dtype:"tv",pageBaseNumber:100,unit:"集",apiPath:"/tv_intro/",apiPathHao:"/dianshi_intro/",urlPrefix:"/kan/tvplay/?",hostUrl:"v.baidu.com/tv_intro/",hostUrlHao:"v.hao123.com/dianshi_intro/",fieldsAdapter:function(e){e=o.defaults(e,this.fields);var t=parseInt(e.is_play,10),i=a.getPlayUrl(t,e.site_url,e.episode,e.url),s={text:t?e.episode:"暂无 ",title:(t?"观看 ":"搜一下 ")+"第"+e.episode+"集",to:t?"play":"search",episode:e.episode,url:i,site_url:e.site_url,thumbnail:e.thumbnail_16_9||e.thumbnail,lastEpisode:this.isLastEpisode(e.episode),record:"TV"+a.options.id};return"预告片"===e.category&&(s.text=e.episode,s.title="观看第"+e.episode+"集预告片",s.url=e.link&&e.link.indexOf("?")>-1?e.link:e.link+"?",s.lastEpisode=!1,s.isPer=!0,s.site_url=e.site),s}}}),o.extend(a.Views,{Header:s.View.extend({el:"#episode-header",tpl:"pagination",events:{"mouseover .episodes-dropdown":"onMouseoverDropdown","mouseleave .episodes-dropdown":"onMouseleaveDropdown","mouseover .j-more":"onMouseoverMore","mouseleave .j-more":"onMouseleaveMore","click .site-list .site":"onClickSite","click .episode-paginations .episode-page":"onSetPage","click .episode-paginations-menu .episode-page":"onSetPageMenu"},render:function(e){var t=e.model;this.initedSite=!0,this.initedSite||(this.renderPage(t.get("episodes").length,!1),this.renderSite())},renderPage:function(e,t,i){var o=this.pageTempate({paginations:this.createPages(e,t),unit:a.options.unit,last:i});this.$el.find(".episode-paginations-wrap").html(o)},siteTimer:0,renderSite:function(){var e=a.siteCollection,t=this;this.curSite=a.options.filterSite;var i=e.toJSON(),s=o.find(i,function(e){return e.site===t.curSite})||i[0];this.curSite&&$("#video-brand").text(s.name+"全网首播").show();var n=a.getTempalte("sites")({sites:e.toJSON(),opt:a.options,curSite:s,hasPaysite:a.options.hasPaysite});this.$el.find(".episode-site-wrap").html(n)},initialize:function(){this.pageTempate=a.getTempalte(this.tpl),a.dataCollection.on("data.loaded",o.bind(this.render,this))},createPages:function(e,t){var i=a.options.pageBaseNumber,s=[],n=!~a.options.sort;return t&&e>i&&(n?(s=o.range(e,0,-i),s=o.map(s,function(t){var o=e-t,s=Math.max(t-i,0),n={start:o+1,begin:t,end:s+1};return n})):(s=o.range(0,e,i),s=o.map(s,function(t){var o=t+1,s=Math.min(t+i,e),n={start:o,begin:o,end:s};return n}))),s},onClickSite:function(e){e.preventDefault();var t=$(e.currentTarget),i=t.data("site");if(i){t.parents(".site-list").find(".current").removeClass("current"),t.addClass("current"),this.curSite=i;var s=o.find(a.siteCollection.toJSON(),function(e){return e.site===i}),n="background-image:url("+s.logo+")";t.parents(".site-list").find(".current-site-wrap a").attr("style",n).text(s.name),i&&a.queryModel.set({site:i})}},onSetPage:function(e){e.preventDefault();var t=$(e.currentTarget),i=t.data("start");a.episodesView.setPage(+i-1,!1,!0),t.parent().addClass("current").siblings().removeClass("current")},onMouseoverDropdown:function(e){var t=$(e.currentTarget);t.addClass("episodes-dropdown-active").find("li").show()},onMouseleaveDropdown:function(e){var t=$(e.currentTarget);t.removeClass("episodes-dropdown-active").find("li").not(".current").hide()},onSetPageMenu:function(e){e.preventDefault();var t=$(e.currentTarget),i=t.data("start");a.episodesView.setPage(+i-1,!1,!0),t.parent().addClass("current").siblings().removeClass("current"),t.parent().parent().trigger("mouseleave")},siteHoverTimer:null,onMouseoverMore:function(e){clearTimeout(this.siteHoverTimer);var t=$(e.currentTarget);t.find(".j-more-list").show()},onMouseleaveMore:function(e){var t=$(e.currentTarget);this.siteHoverTimer=setTimeout(function(){t.find(".j-more-list").hide()},100)}}),Episodes:s.View.extend({el:"#episode-episodes",tpl:"episodes",loadingTpl:"loading",events:{"click .fold":"onFold","click .unfold":"onUnfold","click .episode-qxk a":"clickQxk"},posterEl:"#poster .poster-a",btnPlay:"#j-play-btn",newlistEl:"#j-newest-list",initialize:function(){this.template=a.getTempalte(this.tpl),this.tipTemplate=a.getTempalte(this.loadingTpl),this.collection=new a.Collections.Episodes,this.collection.on("reset",o.bind(this.collectionReset,this)),this.on("showLoader",o.bind(this.showLoader,this)),this.on("updateRecord",o.bind(this.onUpdateRecord,this)),"hao123"===a.options.frSite&&this.once("initQxk",o.bind(this.initQxk,this))},showLoader:function(){var e=this.tipTemplate();this.$el.hide().html(e).show()},onFold:function(e){e.preventDefault(),this.setPage(0,!0),a.headerView.renderPage(this.collection.length,!1)},onUnfold:function(e){e.preventDefault();var t=this.collection.length,i=a.options,o=i.finish,s=Math.max(Math.ceil(t/i.pageBaseNumber)-1,0)*i.pageBaseNumber,n=o||!~i.sort?0:s;this.setPage(n,!1,!0),a.headerView.renderPage(this.collection.length,!0,!(o||!~i.sort))},setPage:function(e,t,i){this.render({end:t?void 0:a.options.pageBaseNumber+e,start:e,cancelPage:!0,showFold:i,fold:t})},renderPrevue:function(){$("#episode-header").hide(),this.$el.html($("#j-tvprevue-wrap").val())},render:function(e){e||(e={});var t,i=this.$el,o=a.options,s=e.start||0,r=this.collection.length,l=Math.min(e.end||r,r),d=this.collection.models,p=l-s;t=this.template({episodes:d,start:s,max:l,len:p,total:r,unit:o.unit,showFold:e.showFold,pageBaseNumber:o.pageBaseNumber,fold:e.fold&&(p>=o.pageBaseNumber/2||r>o.pageBaseNumber),filterSite:o.filterSite,pro:o.pro,frSite:o.frSite,finish:o.finish,type:o.type}),i.hide().html(t).fadeIn(),this.trigger("updateRecord",n.userRecord),this.trigger("initQxk")},collectionReset:function(){{var e,t,i=this.collection,o=$(this.posterEl);$(this.btnPlay)}if(i.length){if(o.length&&(e=i.at(0),t=e.get("url"),o.attr("href",t+"&bl=hb"),o.attr("static","bl=spa&blname=简介&site="+e.get("site_url"))),a.options.filterSite&&!this._brandUrlSeted){this._brandUrlSeted=!0;var s=$("#video-brand").attr("static")+"&pro="+a.options.pro;$("#video-brand").attr("href",t).attr("static",s).show()}$("#hao123-adv-txt").attr("href",t)}else this.renderPrevue()},onUpdateRecord:function(e){if(e){var t=".episode-episode",i=this.$el.find(t+"[data-episode="+e+"]");if(i.length){var o=n.getTempalte("episodetip"),s=$(o({record:e}));i.prevAll().length<12?s.addClass("episode-tip-down"):i.position().left>.6*i.parent().width()&&s.addClass("episode-tip-right"),i.append(s),i.css("z-index",2),setTimeout(function(){s.remove()},6e3)}}},initQxk:function(){var t=e("detail:static/hao123/tvepisode/tvepisode.js");t.firstSee.call(this,a.options.title,a.options.lastEpisode)},clickQxk:function(t){var i=this,o=$(t.currentTarget),s=i._prePlayUrl||o.prop("href");t.preventDefault();var n="tpl=tvplay_detail_hao123&tn=tvplay_detail_hao123&bl=btn&stp=speed&ext=callback",a="tpl=tvplay_detail_hao123&tn=tvplay_detail_hao123&bl=btn&stp=speed&ext=download";e("detail:static/hao123/utils/utils.js").callBrowser(s,i.hasYugao,n,a)}})}),i.exports=function(e){$("#playButtons").removeClass("invisible"),a.init.call(a,e)}});
;define("detail:widget/staticPrevue/staticPrevue.js",function(e,i){function t(e){var i=$("#"+e.id);i.find(".item").length&&(i.carousel({interval:0}),i.on("slid.bs.carousel",function(){var e=$(this),i=e.find(".item.active").index()+1;e.find(".carousel-page-info i").text(i)}))}e("common:static/vendor/bootstrap/js/carousel.js");e("common:static/ui/core/core.js"),e("common:static/vendor/underscore/underscore.js");i.init=t});
;define("detail:widget/subscribe/subscribe.js",function(t,i,e){function n(t,i,e){if(c.isFunction(t)&&c.isFunction(i)){e=e||3e3;var n=setInterval(function(){t()&&(n&&clearInterval(n),i())},200);setTimeout(function(){n&&clearInterval(n)},e)}}var s=t("common:static/ui/eventcenter/eventcenter.js"),r=t("common:static/ui/bdvTrace/config/config.js"),c=t("common:static/vendor/underscore/underscore.js"),o={},u={movie:"M",tv:"TV",tvplay:"TV",tamasha:"T",show:"T",tvshow:"T",comic:"C",cartoon:"C"},d={init:function(t,i){this.type=t,this.worksId=i,this.recordKey=u[this.type]+this.worksId,this.bindEl(),this.bindEvent()},bindEl:function(){this.$el=$("#subscribeControl"),this.$btn=this.$el.find("a.btn"),this.$btnSubscribed=this.$el.find(".btn-subscribed"),this.$tip=this.$el.find(".tip")},bindEvent:function(){var t=this;this.$btn.on("click",function(i){i.preventDefault(),$(i.currentTarget).hasClass("btn-subscribed")||s.trigger("bdvTrace.add",{params:{type:t.type,works_id:t.worksId,last_view:t.getRecord()},callback:function(i){i==r.status.success?t.subscribed():i==r.status.errLimited&&t.alertTip()}})}),this.$tip.find(".show-history").on("click",function(t){t.preventDefault(),s.trigger("bdvTrace.list")}),this.$btnSubscribed.on("click",function(t){t.preventDefault(),s.trigger("bdvTrace.list")}),setTimeout(function(){t.$tip.fadeOut()},5e3)},subscribed:function(){this.$btn.hide(),this.$tip.hide(),this.$btnSubscribed.show(),setTimeout(function(){s.trigger("bdvTrace.list",{hide:!0})},5e3)},getRecord:function(){return o[this.recordKey]||0},alertTip:function(){var t=this.$tip.find(".text");t.text("您订阅的剧集已超过20部，暂时无法订阅更多，您可以尝试清理已订阅的剧集。"),this.$tip.addClass("error").show()}};e.exports=function(t,i){var e=window;t&&i&&setTimeout(function(){n(function(){return"undefined"!=typeof e.bdvRecordAPI},function(){e.bdvRecordAPI.get(function(t){o=t||{}})}),d.init(t,i)},400)}});
;define("detail:widget/subscribe/traceUtil.js",function(t,e){function a(t,e,a){if(c.isFunction(t)&&c.isFunction(e)){a=a||3e3;var n=setInterval(function(){t()&&(n&&clearInterval(n),e())},200);setTimeout(function(){n&&clearInterval(n)},a)}}var c=t("common:static/vendor/underscore/underscore.js"),n=e.keyMap={movie:"M",tv:"TV",tvplay:"TV",tamasha:"T",show:"T",tvshow:"T",comic:"C",cartoon:"C"},o={tv:"tvplay",show:"tvshow"};e.loop=a;{var i=e.getUID=i=function(){var t=$.cookie.getRaw("FLASHID");if(t)return t.substr(0,32);var e=$.cookie.getRaw("BAIDUID");return e?e.substr(0,32):void 0};e.trace={api:"http://i.hao123.com/uc/video?callback=?",getData:function(t,e){t.c=i(),t.category=o[t.category]||t.category;var a=this.api+"&name="+t.name;delete t.name,$.ajax({url:a,dataType:"jsonp",data:t,success:e})},check:function(t,e){var a=c.extend({ac:"collect_judge"},t);this.getData(a,e)},watch:function(t,e){var a=c.extend({ac:"watch"},t);this.getData(a,e)},submit:function(t,e){var a=c.extend({ac:"collect"},t);this.getData(a,e)}}}e.getBdvId=function(t,e){return n[t]+e}});
;define("detail:widget/subscribe/subscribe_hao123.js",function(t,i,n){var e=(t("common:static/ui/eventcenter/eventcenter.js"),t("common:static/ui/bdvTrace/config/config.js"),t("common:static/vendor/underscore/underscore.js")),s=t("detail:widget/subscribe/traceUtil.js"),o=t("common:static/ui/loginCheck/loginCheck.js"),c=t("common:static/ui/bdPassPop/bdPassPop.js"),r=function(t){this.opt=e.extend({},t),this.initEl(),this.checkSub()};e.extend(r.prototype,{initEl:function(){this.$el=$("#subscribeControl"),this.$btn=this.$el.find("a.btn-subscribe"),this.$btnSubscribed=this.$el.find(".btn-subscribed"),this.$tip=this.$el.find(".tip")},checkSub:function(t){var i=this,n=i.opt;this.unbindEvents(),o(function(e){e&&e.value&&(i.isLogin=!0,s.trace.check({category:n.type,name:n.nameEn,id:n.worksId},function(n){n&&0===+n.errno&&1===n.data?i.$btnSubscribed.removeClass("btn-hide"):(t&&i.submit(),i.$btn.removeClass("btn-hide"),i.$tip.removeClass("btn-hide"),i.bindEvents())}))})},unbindEvents:function(){this.$btn.off("click")},bindEvents:function(){this.$btn.on("click",e.bind(this.onSub,this))},onSub:function(t){t.preventDefault();var i=this;return i.isLogin?void this.submit():c.show(function(){i.checkSub(1)})},submit:function(){if(!this.submiting){this.submiting=!0;var t=this,i=this.opt;bdvRecordAPI.init({proxy:location.protocol+"//"+location.host+"/static/common/html/proxy_blank.html"}),bdvRecordAPI.getRecord(s.getBdvId(this.opt.type,this.opt.worksId),function(n){var e="0";n&&n.result&&("movie"===t.type?e="0":n.result.episode),s.trace.submit({id:i.worksId,name:i.nameEn,category:i.type,episode:e},function(i){i&&0===+i.errno?t.onSuccess():t.onFailure()})})}},onSuccess:function(){this.$btn.addClass("btn-hide"),this.$tip.hide(),this.$btnSubscribed.removeClass("btn-hide")},alertTip:function(){var t=this.$tip.find(".text");t.text("收藏未成功，请重试"),this.$tip.addClass("error").show();var i=this;setTimeout(function(){i.$tip.hide()},3e3)},onFailure:function(){this.alertTip()}}),n.exports=function(t){if(t.type&&t.worksId){var i=function(){try{bdvRecordAPI.init(),new r(t)}catch(n){setTimeout(i,5e3)}};setTimeout(i,2e3)}}});
;define("detail:widget/tabpicarea_ajax/tabpicarea_ajax.js",function(e,t,a){var i=function(e){var t=$("#"+e),a=t.find(".tang-body-item");t.on("mouseover",".tang-title li",function(e){var i=$(e.currentTarget),n=i.index();a.eq(n).show().siblings().hide(),"index_show_mini2"===t.attr("id")&&i.find("a").attr("href")&&t.find(".anchor-more").attr("href",i.find("a").attr("href")),i.addClass("tang-title-item-selected").siblings().removeClass("tang-title-item-selected")})};a.exports=i});
;define("detail:widget/tieba/tieba.js",function(i,e,o){var t,a=i("common:static/ui/eventcenter/eventcenter.js"),n=i("common:static/ui/loginCheck/loginCheck.js"),c=i("common:static/ui/bdPassPop/bdPassPop.js"),d=function(i,e){var o=$("#tieba-login-mask"),d=function(e){i.css("height",e.data),o.height(e.data)};"undefined"!=typeof window.addEventListener?window.addEventListener("message",d,!1):"undefined"!=typeof window.attachEvent&&window.attachEvent("onmessage",d),window.updateIframeHeight=function(){var e=parseInt(top.frames["tieba-iframe"].frames.iframeH.location.hash.split("#")[1],10);e>0&&(i.css("height",e),o.height(e))},a.attach("window:resize",function(i){var e=i.size;t(1024===+e?729:954)}),a.trigger("window:resize",{size:$("html")[0].className.match(/w(\d*)/)[1]}),n(function(t){return t.uid&&t.value?o.remove():(o.css({position:"absolute",top:i.position().top,left:0,width:i.width(),height:i.height(),"z-index":10,"background-color":"#fff",cursor:"pointer"}).css("opacity",0),void o.on("click",function(i){i.preventDefault(),i.stopPropagation(),c.show(function(){o.off("click").remove(),$.log("http://pc.videoclick.baidu.com/v.gif?pid=104&bl=tiebamask&login=true&tn="+e)})}))})};o.exports=function(i,e,o){var a={"db-rdqa-pool002.db01.baidu.com":"video","video.baidu.com":"video","video.hao123.com":"vhao123","v.hao123.com":"vhao123","v.baidu.com":"vbaidu","shipin.baidu.com":"shipin","movie.baidu.com":"movie","vidoe.baidu.com":"vidoe"},n=a[location.hostname]||"vbaidu";t=function(o){n&&(i[0].src="http://tieba.baidu.com/f?ie=utf-8&kw="+e+"&innerfr="+n+"&rn=8&width="+o)},d(i,o)}});
;define("detail:widget/timeline/timeline_slide.js",function(require,exports,module){var Carousel=require("common:static/ui/carousel/jCarouselLite.js");exports.Carousel=function(data,container){for(var els=[],i=0;i<data.length;i++){var obj={},el=(data[i],function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){if(__p+='<div class="video">\n	',"0"==data.is_periphery&&(__p+='<span class="fullPlay"></span>'),__p+='\n    <a target="_blank" href="'+(null==(__t=data.link)?"":__t)+'" title="'+(null==(__t=data.sub_title)?"":__t)+'">\n        <img class="vid-cover" src="'+(null==(__t=data.thumbnail)?"":__t)+'" alt="'+(null==(__t=data.sub_title)?"":__t)+'">\n        <span class="gradient-bg">&nbsp;</span>\n        <span class="play-video-icon">&nbsp;</span>\n        <span class="site">'+(null==(__t=data.site_url)?"":__t)+"</span>\n        ",data.duration){if(__p+="\n        	",data.duration<60){__p+="\n        	    ";var my_duration="00:"+data.duration;__p+="\n        	"}else if(data.duration>60&&data.duration<3600){__p+="\n        	    ";var minute=Math.floor(data.duration/60);__p+="\n        	    ";var second=Math.floor(data.duration%60);__p+="\n        	    ",10>minute&&(minute="0"+minute),__p+="\n        	    ",10>second&&(second="0"+second),__p+="\n        	    ";var my_duration=minute+":"+second;__p+="\n        	"}__p+="\n        	","00:00"!==my_duration&&"00"!==my_duration&&"0"!==my_duration&&(__p+='\n        	    <span class="duration">'+(null==(__t=my_duration)?"":__t)+"</span>\n        	"),__p+="\n    	"}__p+='\n    </a>\n</div>\n<a class="title" target="_blank" href="'+(null==(__t=data.link)?"":__t)+'" title="'+(null==(__t=data.sub_title)?"":__t)+'">'+(null==(__t=data.sub_title)?"":__t)+"</a>\n"}return __p}({data:data[i]}));obj.content=el,els.push(obj)}if($(window).width()<1245){var len=4,width=185,rightValue=11,all=data.length;all-=Math.floor(all/len)}else var len=5,width=195,rightValue=21,all=data.length;var max=all/len,carousel=new Carousel({auto:null,speed:500,vertical:!1,visible:len,step:len,originalIndex:0,itemsTag:".slides-item",itemSize:width,items:els,buffer:-1e-4,afterEnd:function(a){var t=(a-2.5)/5,n=container.find(".carousel-prev"),e=container.find(".carousel-next");0===t||t===-.1?(n.hide(),e.show()):t+1>=max?(n.show(),e.hide()):0!==a&&(n.show(),e.show())}});carousel.render(container),container.find(".slides-item").each(function(a,t){0!==a&&a%4===0&&$(t).addClass("change-item")}),container.append($('<div class="carousel-prev hide"></div>').css("top",20)),container.append($('<div class="carousel-next hide"></div>').css({top:20,right:rightValue})),carousel.tabLeft=container.find(".carousel-prev"),carousel.tabRight=container.find(".carousel-next"),carousel.tabLeft.on("click",function(){carousel.prev()}),carousel.tabRight.on("click",function(){carousel.next()}),all>len&&carousel.tabRight.show()}});
;define("detail:widget/timeline/timeline.js",function(require,exports,module){var myCarousel=(require("common:static/vendor/underscore/underscore.js"),require("detail:widget/timeline/timeline_slide.js").Carousel),scheduleAPI="http://v.baidu.com/videoapi/?page_name=hotevent&format=json&block_sign=index_special_hot_show_",videoAPI="/show_intro/?dtype=showepisodevideos";window.curEpisode="";var Timeline={init:function(){var t=this;t.lastest={},t.videoId=$("#videoId").val(),$.cache.videos={},t.titleContainer=$(".timeline-title-wrap"),t.contentContainer=$(".timeline-content-layout"),t.fetchData(t.render),t.rendered=!1},breakOff:function(){$(".timeline-wrap").parent().remove()},fetchData:function(t){var e=this,i=scheduleAPI+e.videoId;$.ajax({url:i,dataType:"jsonp",type:"post",success:function(i){i&&i[0]?($.cache.schedule=i[0].data.videos,e.lastest=$.cache.schedule[$.cache.schedule.length-1],t&&t.call(e)):e.breakOff()},error:function(){e.breakOff()}})},fetchContentData:function(t){var e=this;$.ajax({url:videoAPI,data:{id:e.videoId,episode:t},dataType:"jsonp",success:function(i){$.cache.videos[t]=i,e.renderContent(t)},error:function(){e.breakOff()}})},render:function(){var t=this;t.rendered||(t.titleLayout($.cache.schedule),t.rendered=!0),t.bindEvent();var e=$("#schedule_"+(window.curEpisode||t.lastest.episode));e.trigger("click")},titleLayout:function(data){var self=this,html=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+='<ul class="title-list">\n	';for(var i=0;i<data.length;i++){var item=data[i];__p+='\n	    <li class="title-item active" id="schedule_'+(null==(__t=item.episode)?"":__t)+'" data-episode="'+(null==(__t=item.episode)?"":__t)+'" data-index="'+(null==(__t=i)?"":__t)+'">\n	    	<i class="pointer"></i>\n	    	<i class="triangle"></i>\n	        <div class="title-inner">\n	        	<p class="t1">'+(null==(__t=item.title)?"":__t)+'</p>\n	        	<p class="t2">'+(null==(__t=item.sub_title)?"":__t)+"</p>\n        	</div>\n	    </li>\n    "}__p+="\n</ul>\n"}return __p}({data:data});self.titleContainer.html(html)},renderContent:function(episode){var self=this,data=$.cache.videos[episode],carousel=($("#videos_"+episode),"");if(self.contentContainer.empty(),data.length>5)carousel=myCarousel(data,self.contentContainer);else{carousel='<ul class="videos-set">';for(var html="",j=0;j<data.length;j++)html=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){if(__p+='<div class="video">\n	',"0"==data.is_periphery&&(__p+='<span class="fullPlay"></span>'),__p+='\n    <a target="_blank" href="'+(null==(__t=data.link)?"":__t)+'" title="'+(null==(__t=data.sub_title)?"":__t)+'">\n        <img class="vid-cover" src="'+(null==(__t=data.thumbnail)?"":__t)+'" alt="'+(null==(__t=data.sub_title)?"":__t)+'">\n        <span class="gradient-bg">&nbsp;</span>\n        <span class="play-video-icon">&nbsp;</span>\n        <span class="site">'+(null==(__t=data.site_url)?"":__t)+"</span>\n        ",data.duration){if(__p+="\n        	",data.duration<60){__p+="\n        	    ";var my_duration="00:"+data.duration;__p+="\n        	"}else if(data.duration>60&&data.duration<3600){__p+="\n        	    ";var minute=Math.floor(data.duration/60);__p+="\n        	    ";var second=Math.floor(data.duration%60);__p+="\n        	    ",10>minute&&(minute="0"+minute),__p+="\n        	    ",10>second&&(second="0"+second),__p+="\n        	    ";var my_duration=minute+":"+second;__p+="\n        	"}__p+="\n        	","00:00"!==my_duration&&"00"!==my_duration&&"0"!==my_duration&&(__p+='\n        	    <span class="duration">'+(null==(__t=my_duration)?"":__t)+"</span>\n        	"),__p+="\n    	"}__p+='\n    </a>\n</div>\n<a class="title" target="_blank" href="'+(null==(__t=data.link)?"":__t)+'" title="'+(null==(__t=data.sub_title)?"":__t)+'">'+(null==(__t=data.sub_title)?"":__t)+"</a>\n"}return __p}({data:data[j]}),carousel+=0!==j&&j%4===0?'<li class="slides-item items change-item">'+html+"</li>":'<li class="slides-item items">'+html+"</li>";carousel+="</ul>",self.contentContainer.html(carousel).show()}},bindEvent:function(){var t=this,e=t.titleContainer.find(".title-list"),i=t.titleContainer.find(".title-item"),n=i.length;if($(window).width()<1245)var a=81,s=9;else var a=87,s=11;var l=n*a;e.css({width:1.05*l}).on("click",".title-item",function(){var i=$(this).data("episode");if($(this).addClass("select").siblings().removeClass("select"),n>s){var l=0,d=$(this).data("index"),o=(s-1)/2;l=d+o>=n?-(n-s)*a:0>d-o?0:-(d-o)*a,e.css({left:l})}window.curEpisode=$(this).data("episode"),$.cache.videos[i]?t.renderContent(i):t.fetchContentData(i)})}};module.exports=function(){Timeline.init(),Timeline.rendered&&$(window).resize(function(){Timeline.render()})}});
;define("detail:widget/top/top.js",function(require,exports,module){var frSite,topData=(require("common:static/vendor/underscore/underscore.js"),require("detail:static/ui/utils/topData.js")),tpl=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){if(__p+="",videos&&videos.length){__p+='\n<ul class="top-list" data-for="top-'+(null==(__t=type)?"":__t)+'" static="bl=most_fav&to=search&blname=网友最爱看">\n	';var video,img;__p+="\n	";for(var i=0,l=Math.min(videos.length,8);l>i;i++)__p+="\n	<li",0==i&&(__p+=' class="active"'),__p+=">\n		",video=videos[i],__p+='\n		<a href="'+(null==(__t="hao123"==frSite?video.hao123_url:video.url)?"":__t)+'" title="'+(null==(__t=video.title)?"":__t)+'" target="_blank" static="stp=po&no='+(null==(__t=i)?"":__t)+'">\n			<div class="top-cover">\n				',img=~video.imgh_url.indexOf("blank.gif")?video.imgv_url:video.imgh_url,__p+='\n				<img src="'+(null==(__t=img)?"":__t)+'" alt="'+(null==(__t=video.title)?"":__t)+'">\n				<div class="mask"></div>\n				<span class="play"></span>\n                <div class="ie6-trick"></div>\n			</div>\n			<div class="top-info">\n				<p>'+(null==(__t=video.title)?"":__t)+"</p>\n				<span",3>i&&(__p+=' class="top3"'),__p+=">"+(null==(__t=i+1)?"":__t)+"</span>\n				",video.hot_day&&(__p+="<b>"+(null==(__t=(video.hot_day/1e4).toFixed(1))?"":__t)+"万</b>"),__p+="\n			</div>\n		</a>\n	</li>\n	";__p+="\n</ul>\n"}__p+=""}return __p},$eleWrap=$(".j-top-content-wrap"),isFading=!1,showToplist=function(i){var t=$eleWrap.find("[data-for=top-"+i+"]");return t.length?void $eleWrap.find(".top-list:visible").fadeOut(300,function(){t.fadeIn(200,function(){isFading=!1})}):void topData.get(i,function(t){var e=tpl({videos:t.videos,type:i,frSite:frSite});$(e).appendTo($eleWrap).fadeIn(200,function(){isFading=!1}).siblings().hide()})},initEvents=function(){var i=$(".j-top-tabs");i.on("mouseenter","li",function(i){if(!isFading){isFading=!0;var t=$(i.currentTarget),e=t.attr("data-type");if(!e||t.hasClass("active"))return void(isFading=!1);t.addClass("active").siblings().removeClass("active"),showToplist(e)}}),$eleWrap.on("mouseenter",".top-list li",function(i){var t=$(i.currentTarget);t.addClass("active").siblings().removeClass("active")})};module.exports=function(i){frSite=i,showToplist("all"),initEvents()}});
;define("detail:widget/tvprevue/tvprevue.js",function(require,exports,module){var Base=require("common:static/ui/oo/klass.js"),_=Base._;require("common:static/vendor/bootstrap/js/transition.js"),require("common:static/vendor/bootstrap/js/carousel.js");var ViewPrevue=Base.CC.sub({init:function(t){this.opt=t,this.loadData()},tpls:{tvprevue:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="";var item;__p+='\n<div class="episode-focus-wrap clearfix">\n    ';for(var i=0,l=Math.min(items.length,4);l>i;i++)__p+="\n    ",item=items[i],__p+='\n    <div class="new-item',i>0&&i==l-1&&(__p+=" new-item-last"),__p+="",i>0&&i==l-2&&(__p+=" new-item-last-two"),__p+='">\n        <a static="stp=tvprevue&site='+(null==(__t=item.site)?"":__t)+"&videoid="+(null==(__t=item.videoid)?"":__t)+'" target="_blank" class="view-box" href="'+(null==(__t=item.link)?"":__t)+'&bl=jp_video" title="'+(null==(__t=item.sub_title)?"":_.escape(__t))+'">\n            <span class="view">\n                <img class="item-img" src="'+(null==(__t=item.thumbnail)?"":__t)+'"/>\n                <span class="info-bg"></span>\n                <span class="info">'+(null==(__t=timeHelper(item.duration))?"":__t)+'</span>\n                <span class="s-play"></span>\n                <span class="s-new ',"花絮"===item.category&&(__p+="s-new-huaxu"),__p+='">'+(null==(__t=item.category)?"":__t)+'</span>\n            </span>\n           <span class="title">'+(null==(__t=$.string.widthstr(item.sub_title,28))?"":__t)+"</span>\n        </a>\n    </div>\n    ";__p+="\n</div>"}return __p},prevues:function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="";var listitem;__p+="\n";for(var i=0,l=list.length;l>i;i++){if(__p+="\n    ",listitem=list[i],__p+="\n    ",listitem.data&&listitem.data.length){__p+='\n        <div class="block carousel slide common-carousel" id="block-prevues-'+(null==(__t=i)?"":__t)+'">\n            <h2 class="block-title">'+(null==(__t=listitem.key)?"":_.escape(__t))+'</h2>\n            <div class="content" static="bl=detailPrevue&stp='+(null==(__t=listitem.key)?"":_.escape(__t))+'">\n                ';var onepage=5,videos=listitem.data,total=videos.length,pagenum=Math.ceil(total/onepage);__p+='\n                <div class="carousel-inner" role="listbox">\n                    ';for(var j=0;pagenum>j;j++){__p+='\n                        <div class="item ',0===j&&(__p+="active"),__p+=' hide-overflow">\n                            <ul >\n                                ';for(var n=0;onepage>n;n++){if(__p+="\n                                    ",total>j*onepage+n){__p+="\n                                    ";var item=videos[j*onepage+n];__p+="\n                                    <li ",n===onepage-1&&(__p+='class="last sub-item"'),__p+='>\n                                        <a href="'+(null==(__t=item.link)?"":__t)+'" target="_blank" static="stp=po&videoid='+(null==(__t=videoid)?"":__t)+'" title="'+(null==(__t=item.sub_title)?"":__t)+'" class="item-a view-box">\n                                            <span class="view">\n                                                <img class="item-img" src="'+(null==(__t=item.thumbnail)?"":__t)+'"/>\n                                                <span class="info-bg"></span>\n                                                <span class="info">'+(null==(__t=timeHelper(item.duration))?"":__t)+'</span>\n                                                <span class="s-mask"></span>\n                                                <span class="s-play"></span>\n                                            </span>\n                                            <span class="title">'+(null==(__t=$.string.widthstr(item.sub_title,11))?"":__t)+"</span>\n                                        </a>\n                                    </li>\n                                    "}__p+="\n                                "}__p+="\n                            </ul>\n                        </div>\n                    "}__p+="\n                </div>\n\n                ",pagenum>1&&(__p+='\n                <a class="left carousel-control" href="#block-prevues-'+(null==(__t=i)?"":__t)+'" role="button" data-slide="prev" static="stp=left"></a>\n                <a class="right carousel-control" href="#block-prevues-'+(null==(__t=i)?"":__t)+'" role="button" data-slide="next" static="stp=right"></a>\n                <div class="carousel-page-info"><i>1</i><b>/'+(null==(__t=pagenum)?"":__t)+"</b></div>\n                "),__p+="\n            </div>\n        </div>\n    "}__p+="\n"}__p+=""}return __p}},loadData:function(){var t="/tv_intro/?dtype=peripherynotshown&service=json&callback=?&id="+this.opt.id,e=this;$.getJSON(t).done(function(t){t.latest&&t.latest.length&&e.showLatest(t.latest),t.list&&t.list.length&&e.showList(t.list)})},timeHelper:function(t){if(t=parseInt(t,10),isNaN(t)||!t)return"";var e=[parseInt(t/60/60,10),Math.floor(t/60%60),t%60];return 3600>t&&e.shift(),e.join(":").replace(/\b(\d)\b/g,"0$1")},showLatest:function(t){{var e=_.pluck(t,"data"),i=[];[].join}if(_.each(e,function(t){t&&t.length&&(i=_.union(i,t))}),!i.length)return this.el.replaceWith('<p class="episode-sites-none">暂无站点数据</p>');var n=$(this.getTpl("tvprevue")({items:i,timeHelper:this.timeHelper,videoid:this.opt.id}));this.el.find(".content").html(n),this.el.show()},showList:function(t){$("#movie-videos").off("showdata.lazy");var e=$(this.getTpl("prevues")({list:t,timeHelper:this.timeHelper,videoid:this.opt.id}));$("#prevue-carousel").hide().before(e),e.filter(".carousel").each(function(){var t=$(this);t.carousel({interval:0}),t.on("slid.bs.carousel",function(){var t=$(this),e=t.find(".item.active").index()+1;t.find(".carousel-page-info i").text(e)})})}});module.exports=function(t){new ViewPrevue(t)}});
;define("detail:widget/ugcsource/ugcsource.js",function(t,a,e){function i(t,a,e){function i(t,a){Math.floor(Math.random()*(a-t+1)+t)}function s(t){t=t||6;var a="playSourceFilmVTRCallback",i="carousel-ugc-wp";window[a]=function(t){o();var l=r("#morePlaySource")[0];if(t.data.length>2){r(l).parent().removeClass("hide");var s=t.data,n=!1,u=r("#playSourceVTR").attr("data-resourceshield");e&&e.length>=1&&1!=u&&(e.length>2&&(e=e.slice(0,2)),n=!0,s=e.concat(t.data.slice(-4)));var d=c(s,n,i),p=r("#morePlaySource"),v=r("#main").attr("pagetn")||"moviedetail_br",m=encodeURIComponent("简介");p.attr("static","tn="+v+"&tpl="+v+"&bl=spa&blname="+m),p.html(d),$("#"+i).carousel({interval:!1}),$("#"+i).on("slid.bs.carousel",function(){var t=$(this),a=t.find(".item.active").index()+1;t.find(".carousel-page-info i").text(a)})}window[a]=null};var l="http://v.baidu.com/v?ie=utf-8&",s=[];s.push("rn="+t),s.push("word="+p.word),s.push("ct=905969664"),s.push("jsonFn="+a),s.push("tt=time"+parseInt(1e11*Math.random()));try{r.ajax(l+s.join("&"),{dataType:"jsonp",scriptCharset:"gb2312",crossDomain:!0})}catch(n){u.debug(n),o()}}function n(t,a){var e=null,o=null;return a?t.isYY?(e=i(80,90),o="yellow"):(e=i(20,30),o="blue"):(e=i(20,40),o=e>30?"yellow":"blue"),{val:e,flag:o}}function c(t,a,e){var i,o=t.length,s="",c=u.isFromYB()?"yy_play_link yy_play_replace":"",d=5,p=Math.ceil(o/d);s+=l.template('<ol class="carousel-indicators">            <%for(var i=0;i<pagenum;i++){%>                <li data-target="#<%=id%>" data-slide-to="<%=i%>" <%if(i==0){%> class="active"<%}%> ></li>            <%}%>        </ol><div class="carousel-inner" role="listbox">',{pagenum:p,id:e});for(var v=0;p>v;v++){s+='<div class="item '+(0==v?"active":"")+' hide-overflow"><ul>';for(var m=0;d>m;m++){var y=v*d+m;if(t[y]){i=t[y];{var h=i.url,f="search";n(i,a)}i.isYY&&(f="yingyin"),s+='<li class="'+("1"===i.isZt?" zt":"")+(m==d-1?" last sub-item":"")+'">',s+='<a href="'+h+'" class="item-a view-box '+c+'" target="_blank"',s+=' static="stp=po&type='+f+"&li="+y+'"';{var g=i.ti.replace(/"|'/g,"&quot;");"vti="+encodeURIComponent(r("#videoTitle").attr("value"))+"&vurl="+h+"&vid="+r("#videoId").attr("value")}s+=' title="'+g+'"><span class="view">',i.pic&&"NULL"!=i.pic.toLocaleUpperCase()||(i.pic="/static/aries_detail_movie/film/img/default.png"),s+='<img class="item-img" alt="'+g+'" src="'+i.pic+'"/>',s+='<span class="info-bg"></span>',i.srcShortUrlExt&&(s+='<span class="site">'+i.srcShortUrlExt+"</span>"),parseInt(i.duration_hour)&&(s+='<span class="info">'+i.duration_hour+"</span>"),s+='<span class="s-mask"></span><span class="s-play"></span>',s+="</span>",s+='<span class="title">'+r.string.widthstr(g||"",11)+"</span></a></li>"}}s+="</ul></div>"}return s+="</div>",p>1&&(s+='<a class="left carousel-control" href="#'+e+'" role="button" data-slide="prev"></a>                <a class="right carousel-control" href="#'+e+'" role="button" data-slide="next"></a>            <div class="carousel-page-info"><i>1</i><b>/'+p+"</b></div>"),s}var d=a||6,p={};p.word=r("#videoTitle").attr("value"),s(d)}function o(){s.trigger("global.playSource",{once:!0}),r("#playSourceVTR")[0].style.visibility=""}var r=$,l=t("common:static/vendor/underscore/underscore.js"),s=t("common:static/ui/eventcenter/eventcenter.js"),n=t("common:static/ui/core/core.js"),c=n.config,u=n.vApp,d=n.BaseView.extend({initialize:function(t){this.constructor.__super__.initialize.call(this,t);var a=this;a.videoId=t.videoId,r.ajax(c.getRemoteUrl("movie")+"?dtype=moviePlaySource&service=json&id="+a.videoId,{dataType:"jsonp",success:function(t){try{var e;if(t&&t.ugc&&t.ugc[0]&&t.ugc[0].link){var o=t.ugc[0].link;return e=o.match(/(youku\.com)|(tudou\.com)|(qq\.com)|(sohu\.com)/)?o:"http://v.baidu.com/kan/movie/?id="+a.videoId+"&site="+t.ugc[0].site+"&url="+o,u.isFromYB()&&(e=t.ugc[0].link),void new d.UGC({el:a.el,data:e,isFromYb:u.isFromYB()})}t&&t.yy&&t.yy.length?r.ajax("http://v.baidu.com/commonapi/iplocation/?type=cityloc&format=json",{dataType:"jsonp",success:function(o){return o=0===o.state?o.data:1,e=[],l.forEach(t.yy,function(t){if(t.title&&t.play_url&&t.smallcover&&"NULL"!=t.smallcover){var a=t;a.ti=t.title,a.pic=t.smallcover,a.url=t.play_url,a.srcShortUrl="其他",a.cityType=o,a.isYY=!0,a.duration_hour=parseInt(t.duration)?u.getPlayDuration(t.duration):0,e.push(a)}}),e.length>0?(d.updatePoster(e[0].url,"yingyin",e[0]),void i(a.videoId,25,e)):void i(a.videoId,25)}}):i(a.videoId,25)}catch(s){u.debug(s)}}})},template:l.template("")});d.updatePoster=function(t,a,e){var i=r("#poster .poster-a")[0];i.title="立即播放",i.href=t,e&&1!=e.cityType&&(i.setAttribute("data-url",e.bdhd_url),i.setAttribute("data-title",e.ti),r(i).addClass("yy_play_link yy_play_replace")),r(i).attr("static","to=play&type="+a)},d.UGC=n.BaseView.extend({initialize:function(t){this.constructor.__super__.initialize.call(this,t);var a=this;a.videoId=t.videoId,a.word=r("#videoTitle").attr("value"),a.isFromYb=u.isFromYB(),a.render(),d.updatePoster(a.data,"ugc"),o()},template:l.template('<a static="stp=lj&to=play&type=ugc" class="play-btn j-play-source-btn play-ugc<% if(this.isFromYb){ %> yy_play_link  yy_play_replace<% } %>"<% if(this.isFromYb){ %> data-title=<%=this.word%> <% } %> target="_blank" href="<%=data%>" title="立即播放"></a>')}),e.exports=d});
;define("detail:widget/videoAdv/videoAdv.js",function(e,a,n){{var r=e("common:static/ui/oo/klass.js");r._}n.exports=function(e){function a(){return window.ActiveXObject||"ActiveXObject"in window?!0:!1}function n(){if(i)r&&r.play(),!r&&(r=new h5brandPlayer({wrap:e.wrap,video:[{play_url:e.videoUrl,link:"javascript:void(0)"}]}));else{if(!($(".ad-link-layer")&&$(".ad-link-layer").length>0)){var a=document.createElement("a");a.className="ad-link-layer",a.href=e.link,a.target="_blank",$("#brandVideoPlayer_container").prepend(a)}h5brandPlayer.swf.embed({wrap:e.wrap,url:e.swfUrl,id:"swfPlayer",allowscriptaccess:"always"})}$(".ad-link-layer").css({height:"325px",top:"30px"}).show(),$("#brandVideoPlayer .ad-link-layer").on("click",function(a){a.preventDefault(),r&&(r.video&&r.video.paused?r.play():(window.open(e.link,"_blank"),r.pause()))})}var r,i=!a()&&!!document.createElement("video").canPlayType;$(".brand_flash_close").on("click",function(e){e.preventDefault(),i&&r?r&&r.pause():$("#brandVideoPlayer").children().remove(),$("#brandVideoPlayer_container").hide()}),$(e.el).on("click",function(e){e.preventDefault();var a=$("#brandVideoPlayer_wrap");if($("#brandVideoPlayer_container").show(),a&&a.length>0&&$("#brandVideoPlayer")&&$("#brandVideoPlayer").children()&&$("#brandVideoPlayer").children().length>0)return void(r&&r.play());if(!(a&&a.length>0)){var i=document.createElement("div");i.id="brandVideoPlayer_wrap",$("body").prepend(i);var d=$("#brandVideoPlayer_container");$("#brandVideoPlayer_wrap").prepend(d)}n()})}});